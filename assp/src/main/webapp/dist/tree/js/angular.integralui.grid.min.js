/*
  filename: angular.integralui.grid.min.js
  version : 3.0.003
  Copyright © 2014-2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUIGridService",["$rootScope",function(c){var e=null;return{addColumn:function(l,p){c.$broadcast(l+"-add-column",p)},clearColumns:function(l){c.$broadcast(l+"-clear-columns")},insertColumnAt:function(l,p,e){c.$broadcast(l+"-insert-column-at",p,e)},insertColumnBefore:function(l,p,e){c.$broadcast(l+"-insert-column-before",p,e)},insertColumnAfter:function(l,p,e){c.$broadcast(l+"-insert-column-after",p,e)},removeColumn:function(l,p){c.$broadcast(l+"-remove-column",
p)},removeColumnAt:function(l,p){c.$broadcast(l+"-remove-column-at",p)},addRow:function(l,p){c.$broadcast(l+"-add-row",p)},clearRows:function(l){c.$broadcast(l+"-clear-rows")},insertRowAt:function(l,p,e){c.$broadcast(l+"-insert-row-at",p,e)},insertRowBefore:function(l,p,e){c.$broadcast(l+"-insert-row-before",p,e)},insertRowAfter:function(l,p,e){c.$broadcast(l+"-insert-row-after",p,e)},removeRow:function(l,p){c.$broadcast(l+"-remove-row",p)},removeRowAt:function(l,p){c.$broadcast(l+"-remove-row-at",
p)},exportToJSON:function(l,p,e,g){c.$broadcast(l+"-export-json",p,e,g);l=this.getTempData();this.clearTempData();return l?l:""},loadData:function(l,p,e){c.$broadcast(l+"-load-data",p,e)},openEditor:function(l,p){c.$broadcast(l+"-open-editor",p)},closeEditor:function(l,p){c.$broadcast(l+"-close-editor",p)},filter:function(l,p,e){c.$broadcast(l+"-filter",p,e)},findRowById:function(l,p){c.$broadcast(l+"-find-row-by-id",p);var e=this.getTempData();this.clearTempData();return e?e:null},findRowByText:function(l,
p){c.$broadcast(l+"-find-row-by-text",p);var e=this.getTempData();this.clearTempData();return e?e:null},getCellAt:function(l,e){c.$broadcast(l+"-get-cell-at",e);var r=this.getTempData();this.clearTempData();return r?r:null},getRowAt:function(l,e){c.$broadcast(l+"-get-row-at",e);var r=this.getTempData();this.clearTempData();return r?r:null},focus:function(l,e){c.$broadcast(l+"-focus",e)},clearTempData:function(){e=null},ensureVisible:function(l,e){c.$broadcast(l+"-ensure-visible",e)},getTempData:function(){return e},
getHoverColumn:function(l,e){c.$broadcast(l+"-get-hover-column",e);var r=this.getTempData();this.clearTempData();return r?r:null},getList:function(l){c.$broadcast(l+"-get-list");l=this.getTempData();this.clearTempData();return l?l:[]},setTempData:function(c){e=c},topRow:function(l,e){if(e)c.$broadcast(l+"-set-top-row",e);else return c.$broadcast(l+"-get-top-row"),e=this.getTempData(),this.clearTempData(),e?e:null},beginLoad:function(l,e){c.$broadcast(l+"-begin-load",e)},endLoad:function(l){c.$broadcast(l+
"-end-load")},moveColumn:function(l,e,r){c.$broadcast(l+"-move-column",e,r)},moveRow:function(l,e,r,g,na){c.$broadcast(l+"-move-row",e,r,g,na)},getScrollPos:function(l){c.$broadcast(l+"-get-scroll-pos");l=this.getTempData();this.clearTempData();return l?l:{x:0,y:0}},getMaxScrollPos:function(l){c.$broadcast(l+"-get-max-scroll-pos");l=this.getTempData();this.clearTempData();return l?l:{x:0,y:0}},setScrollPos:function(l,e){c.$broadcast(l+"-set-scroll-pos",e)},scrollTo:function(l,e,r){c.$broadcast(l+
"-scroll-to",e,r)},currentPage:function(l,e){if(void 0!=e&&null!=e)c.$broadcast(l+"-set-current-page",e);else{c.$broadcast(l+"-get-current-page");var r=this.getTempData();this.clearTempData();return void 0!=r?r:-1}},firstPage:function(e){c.$broadcast(e+"-first-page")},lastPage:function(e){c.$broadcast(e+"-last-page")},nextPage:function(e){c.$broadcast(e+"-next-page")},prevPage:function(e){c.$broadcast(e+"-prev-page")},clearSelection:function(e){c.$broadcast(e+"-clear-selection")},selectedColumn:function(e,
p){if(p)c.$broadcast(e+"-set-selected-column",p);else{c.$broadcast(e+"-get-selected-column");var r=this.getTempData();this.clearTempData();return r?r:null}},selectedRow:function(e,p){if(p)c.$broadcast(e+"-set-selected-row",p);else{c.$broadcast(e+"-get-selected-row");var r=this.getTempData();this.clearTempData();return r?r:null}},selectedRows:function(e,p){if(p)c.$broadcast(e+"-set-selected-rows",p);else{c.$broadcast(e+"-get-selected-rows");var r=this.getTempData();this.clearTempData();return r?r:
null}},sort:function(e,p,r,g){c.$broadcast(e+"-sort",p,r,g)},refresh:function(e,p,r){c.$broadcast(e+"-refresh",p,r)},resumeLayout:function(e){c.$broadcast(e+"-resume-layout")},suspendLayout:function(e){c.$broadcast(e+"-suspend-layout")},updateLayout:function(e){c.$broadcast(e+"-update-layout")},updateView:function(e){c.$broadcast(e+"-update-view")}}}]).controller("IntegralUIGridController",["$scope","$element","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIDataService","IntegralUIGridService",
"IntegralUIDragDrop","IntegralUIFilter",function(c,e,l,p,r,g,na,h,n,$b){var a=this;this.suppressProcess=!1;this.hoverCell=this.hoverRow=this.hoverColumn=null;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-grid",column:{general:{content:"iui-grid-column-cell-content",disabled:"iui-grid-column-disabled",
normal:"iui-grid-column",hovered:"iui-grid-column-hovered",selected:"iui-grid-column-selected"},header:{content:"iui-grid-column-header-cell-content",disabled:"iui-grid-column-header-disabled",normal:"iui-grid-column-header",hovered:"iui-grid-column-header-hovered",selected:"iui-grid-column-header-selected"},body:{content:"iui-grid-column-body-cell-content",disabled:"iui-grid-column-body-disabled",normal:"iui-grid-column-body",hovered:"iui-grid-column-body-hovered",selected:"iui-grid-column-body-selected"},
footer:{content:"iui-grid-column-footer-cell-content",disabled:"iui-grid-column-footer-disabled",normal:"iui-grid-column-footer",hovered:"iui-grid-column-footer-hovered",selected:"iui-grid-column-footer-selected"}},row:{general:{disabled:"iui-grid-row-disabled",focused:"iui-grid-row-focused",normal:"iui-grid-row",hovered:"iui-grid-row-hovered",selected:"iui-grid-row-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},expandBox:{general:"iui-grid-expand-box",animated:"iui-grid-expand-box-load",expanded:"iui-grid-expand-box-open",collapsed:"iui-grid-expand-box-close"},cell:{content:"iui-grid-row-cell-content",general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",selected:"iui-grid-row-cell-selected"}},cell:{content:"iui-grid-row-cell-content",
general:"iui-grid-row-cell",disabled:"iui-grid-row-cell-disabled",focused:"iui-grid-row-cell-focused",normal:"iui-grid-row-cell",hovered:"iui-grid-row-cell-hovered",selected:"iui-grid-row-cell-selected"}};this.updateGrouping=function(b){a.options.grouping=b?{enabled:g.isFieldAvailable(b.enabled,!1),showColumns:g.isFieldAvailable(b.showColumns,!1)}:{enabled:!1,showColumns:!1}};this.updatePaging=function(b){a.options.paging=b?{enabled:g.isFieldAvailable(b.enabled,!1),showControlPanel:g.isFieldAvailable(b.showControlPanel,
!0),pageSize:g.isFieldAvailable(b.pageSize,100)}:{enabled:!1,showControlPanel:!0,pageSize:100}};this.updateOptions=function(b){b?(a.options={allowAnimation:g.isFieldAvailable(b.allowAnimation,!0),allowCellFocus:g.isFieldAvailable(b.allowCellFocus,!0),allowColumnReorder:g.isFieldAvailable(b.allowColumnReorder,!1),allowDrag:g.isFieldAvailable(b.allowDrag,!1),allowDrop:g.isFieldAvailable(b.allowDrop,!0),allowFilter:g.isFieldAvailable(b.allowFilter,!1),allowFocus:g.isFieldAvailable(b.allowFocus,!0),animationSpeed:200,
autoExpand:g.isFieldAvailable(b.autoExpand,!0),controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:g.isFieldAvailable(b.expandColIndex,void 0!=a.options.expandColIndex?a.options.expandColIndex:0),fillSpace:g.isFieldAvailable(b.fillSpace,!1),gridLines:g.isFieldAvailable(b.gridLines,"both"),hoverSelection:g.isFieldAvailable(b.hoverSelection,!1),indent:g.isFieldAvailable(b.indent,15),labelEdit:g.isFieldAvailable(b.labelEdit,!1),loadRows:[],pathSeparator:g.isFieldAvailable(b.pathSeparator,
"\\"),rtl:g.isFieldAvailable(b.rtl,!1),selectedColumn:g.isFieldAvailable(b.selectedColumn,a.options.selectedColumn?a.options.selectedColumn:null),selectedIndex:-1,selectedRow:g.isFieldAvailable(b.selectedRow,a.options.selectedRow?a.options.selectedRow:null),selectedRows:a.options.selectedRows?a.options.selectedRows:[],selectionMode:g.isFieldAvailable(b.selectionMode,"one"),showFooter:g.isFieldAvailable(b.showFooter,!0),showHeader:g.isFieldAvailable(b.showHeader,!0),showIcons:g.isFieldAvailable(b.showIcons,
!0),sorting:g.isFieldAvailable(b.sorting,"none")},a.updateGrouping(b.grouping),a.updatePaging(b.paging),a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle)):(a.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!0,animationSpeed:200,autoExpand:!0,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:0,fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],pathSeparator:"\\",
rtl:!1,selectedColumn:null,selectedIndex:-1,selectedRow:null,selectedRows:[],selectionMode:"one",showFooter:!0,showHeader:!0,showIcons:!0,sorting:"none"},a.updateGrouping(),a.updatePaging(),a.updateDataFields())};a.options={};this.updateColumnFields=function(b){a.options.columnFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFilter:b.allowFilter?b.allowFilter:"allowFilter",allowGrouping:b.allowGrouping?b.allowGrouping:"allowGrouping",cellTemplateUrl:b.cellTemplateUrl?
b.cellTemplateUrl:"cellTemplateUrl",comparer:b.comparer?b.comparer:"comparer",contentAlignment:b.contentAlignment?b.contentAlignment:"contentAlignment",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",editorType:b.editorType?b.editorType:"editorType",editorSettings:b.editorSettings?b.editorSettings:"editorSettings",editorTemplate:b.editorTemplate?b.editorTemplate:"editorTemplate",filterParams:b.filterParams?b.filterParams:"filterParams",filterTemplate:b.filterTemplate?b.filterTemplate:"filterTemplate",
fixed:b.fixed?b.fixed:"fixed",fixedWidth:b.fixedWidth?b.fixedWidth:"fixedWidth",footerAlignment:b.footerAlignment?b.footerAlignment:"footerAlignment",footerContent:b.footerContent?b.footerContent:"footerContent",footerTemplate:b.footerTemplate?b.footerTemplate:"footerTemplate",footerTemplateModel:b.footerTemplateModel?b.footerTemplateModel:"footerTemplateModel",footerText:b.footerText?b.footerText:"footerText",groupText:b.groupText?b.groupText:"groupText",headerAlignment:b.headerAlignment?b.headerAlignment:
"headerAlignment",headerContent:b.headerContent?b.headerContent:"headerContent",headerTemplate:b.headerTemplate?b.headerTemplate:"headerTemplate",headerTemplateModel:b.headerTemplateModel?b.headerTemplateModel:"headerTemplateModel",headerText:b.headerText?b.headerText:"headerText",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",minWidth:b.minWidth?b.minWidth:"minWidth",maxWidth:b.maxWidth?b.maxWidth:"maxWidth",style:b.style?b.style:"style",visible:b.visible?b.visible:"visible",width:b.width?b.width:"width"}:
{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",allowGrouping:"allowGrouping",cellTemplateUrl:"cellTemplateUrl",comparer:"comparer",contentAlignment:"contentAlignment",contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",editorTemplate:"editorTemplate",filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",footerContent:"footerContent",
footerTemplate:"footerTemplate",footerText:"footerText",groupText:"groupText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",headerTemplateModel:"headerTemplateModel",headerText:"headerText",icon:"icon",id:"id",minWidth:"minWidth",maxWidth:"maxWidth",style:"style",visible:"visible",width:"width"};a.columnsObj&&a.columnsObj.updateDataFields(a.options.columnFields)};this.updateRowFields=function(b){a.options.rowFields=b?{allowDrag:b.allowDrag?b.allowDrag:
"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFocus:b.allowFocus?b.allowFocus:"allowFocus",cells:b.cells?b.cells:"cells",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:"expanded",hasChildren:b.hasChildren?b.hasChildren:"hasChildren",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",pid:b.pid?b.pid:"pid",rows:b.rows?b.rows:"rows",statusIcon:b.statusIcon?b.statusIcon:"statusIcon",
style:b.style?b.style:"style",text:b.text?b.text:"text"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFocus:"allowFocus",cells:"cells",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",hasChildren:"hasChildren",icon:"icon",id:"id",pid:"pid",rows:"rows",statusIcon:"statusIcon",style:"style",text:"text"};a.rowsObj&&a.rowsObj.updateDataFields(a.options.rowFields)};this.updateCellFields=function(b){a.options.cellFields=b?{allowEdit:b.allowEdit?b.allowEdit:"allowEdit",
cid:b.cid?b.cid:"cid",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",labelEdit:b.labelEdit?b.labelEdit:"labelEdit",rid:b.rid?b.rid:"rid",style:b.style?b.style:"style",templateObj:b.templateObj?b.templateObj:"templateObj",text:b.text?b.text:"text",value:b.value?b.value:"value"}:{allowEdit:"allowEdit",cid:"cid",content:"content",contextMenu:"contextMenu",enabled:"enabled",labelEdit:"labelEdit",rid:"rid",style:"style",
templateObj:"templateObj",text:"text",value:"value"}};this.updateDataFields=function(b){b?(a.updateColumnFields(b.column),a.updateRowFields(b.row),a.updateCellFields(b.cell)):(a.updateColumnFields(),a.updateRowFields(),a.updateCellFields())};a.updateOptions();c.$on(c.name+"-add-column",function(b,d){a.columnsObj.insertAt(d,-1,null,a.columnIsAdded)});c.$on(c.name+"-clear-columns",function(b){a.columnsObj.clear(null,a.columnsAreCleared)});c.$on(c.name+"-insert-column-at",function(b,d,c){a.columnsObj.insertAt(d,
c,null,a.columnIsAdded)});c.$on(c.name+"-insert-column-after",function(b,d,c){a.columnsObj.insertByRef(d,c,!0,a.columnIsAdded)});c.$on(c.name+"-insert-column-before",function(b,d,c){a.columnsObj.insertByRef(d,c,!1,a.columnIsAdded)});c.$on(c.name+"-remove-column",function(b,d){a.columnsObj.removeAt(d,-1,null,a.columnIsRemoved)});c.$on(c.name+"-remove-column-at",function(b,d){a.columnsObj.removeAt(null,d,null,a.columnIsRemoved)});this.columnsAreCleared=function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=
!1);a.options.selectedColumn=null;a.updateLayout()};a.columnIsAdded=function(){a.updateLayout()};a.columnIsRemoved=function(b,d){a.updateLayout()};c.$on(c.name+"-add-row",function(b,d){a.rowsObj.insertAt(d,-1,null,a.rowIsAdded)});c.$on(c.name+"-clear-rows",function(b){a.rowsObj.clear(null,a.rowsAreCleared)});c.$on(c.name+"-insert-row-at",function(b,d,c){a.rowsObj.insertAt(d,c,null,a.rowIsAdded)});c.$on(c.name+"-insert-row-after",function(b,d,c){a.rowsObj.insertByRef(d,c,!0,a.rowIsAdded)});c.$on(c.name+
"-insert-row-before",function(b,d,c){a.rowsObj.insertByRef(d,c,!1,a.rowIsAdded)});c.$on(c.name+"-remove-row",function(b,d){a.rowsObj.removeAt(d,-1,null,a.rowIsRemoved)});c.$on(c.name+"-remove-row-at",function(b,d){a.rowsObj.removeAt(null,d,null,a.rowIsRemoved)});this.rowsAreCleared=function(b){b||(a.clearPrevSelection(),a.options.selectedRow=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.rowIsAdded=function(){a.updateCurrentLayout()};this.rowIsRemoved=function(b,d){a.updateCurrentLayout()};
this.objIsRemoved=function(b,d){a.updateCurrentLayout()};a.groups=[];a.groupList=[];a.groupLevel=-1;this.updateGroupList=function(){a.groupList.length=0;if(a.options.grouping.enabled&&0<a.groups.length){var b=a.rowsObj.getList();if(b)for(var d=0;d<b.length;d++){var c=b[d],f=c[a.options.rowFields.cells];if(f&&0<f.length){for(var e=-1,g=e=null,l=0;l<a.groups.length;l++){var e=a.groups[l],e=e[a.options.columnFields.id],h=l;e&&(h=a.getCellIndexById(f,l,e));if(0<=h&&h<f.length){(e=f[h][a.options.cellFields.text])&&
""!=e||(e=void 0!=f[h][a.options.cellFields.value]?f[h][a.options.cellFields.value].toString():"undefined");var h=null,n=a.groupList;g&&(n=g[a.options.rowFields.rows]);if(n)for(var p=0;p<n.length;p++)if(n[p][a.options.rowFields.text]==e){h=n[p];break}h||(h={},h[a.options.rowFields.text]=e,h[a.options.rowFields.cells]=[{cid:a.columnList[a.options.expandColIndex][a.options.columnFields.id],text:e}],h.type="group",g?(g[a.options.rowFields.rows]||(g[a.options.rowFields.rows]=[]),g[a.options.rowFields.rows].push(h)):
a.groupList.push(h));g=h}}g&&(g[a.options.rowFields.rows]||(g[a.options.rowFields.rows]=[]),g[a.options.rowFields.rows].push(c))}}}};a.columnList=[];a.columnFilterList=[];a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;this.updateColumnList=function(){a.columnList.length=0;a.columnFilterList.length=0;a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var b=a.columnsObj.getList();if(b)for(var d=0;d<b.length;d++){var c=b[d];c.type="column";c[a.options.columnFields.id]||(c[a.options.columnFields.id]=
g.getUniqueId());if(0!=c[a.options.columnFields.visible]){var f=!0;a.options.grouping.enabled&&(f=0<=a.groups.indexOf(c)?a.options.grouping.showColumns:!0);if(f)switch(f=(f=c[a.options.columnFields.filterParams])?$b.createTree(f.conditions,f.formula):null,a.columnFilterList.push({cid:c[a.options.columnFields.id],tree:f}),a.columnList.push(c),c[a.options.columnFields.fixed]){case "left":a.isThereLeftFixedColumns||(a.isThereLeftFixedColumns=!0);break;case "right":a.isThereRightFixedColumns||(a.isThereRightFixedColumns=
!0)}}}};var xc=function(b){for(var d=null,c=0;c<a.columnFilterList.length;c++)if(a.columnFilterList[c].cid==b){d=a.columnFilterList[c].tree;break}return d},G=function(b,d){if(0==a.options.allowFilter||"group"==b.type)return!0;var c=!0;if(b){for(var f=-1,e=null,g=null,h=0;h<b[a.options.rowFields.cells].length&&(c=!0,g=b[a.options.rowFields.cells][h],f=g[a.options.cellFields.cid],e=a.getColumnById(f),!e&&h<a.columnList.length&&(e=a.columnList[h]),e&&e[a.options.columnFields.filterParams]&&(c=e[a.options.columnFields.filterParams],
e=g[a.options.cellFields.value]?g[a.options.cellFields.value]:g[a.options.cellFields.text],c=c.callback?c.callback(e,g,b):$b.match(e,c.conditions,c.formula,xc(f))),c);h++);if(c&&(d||a.isRowExpanded(b))&&(f=b[a.options.rowFields.rows])&&0<f.length){for(h=g=0;h<f.length;h++)(childPass=G(f[h],d))&&g++;0==g&&(c=!1)}}return c},V=a.options.indent;a.currentPageList=[];a.pageList=[];a.onlyCurrentPage=!1;a.currentList=[];a.fullIndentList=[];a.fullList=[];a.indentList=[];a.longestRow=null;a.isThereChildRows=
!1;a.pageRowCount=0;a.pageNumber=0;a.currentPageNumber=1;this.isThereVisibleChildren=function(b){var d=!1;if(b&&(b=b[a.options.rowFields.rows])&&0<b.length)for(var c=0;c<b.length;c++)if(G(b[c])){d=!0;break}return d};var K=function(b,d,c,f){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=g.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var e=b[a.options.rowFields.cells];if(e&&0<e.length){c=G(b,f);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&
(c=c&&a.isThereVisibleChildren(b));for(var h=-1,l="label",n=null,n=null,p=0;p<a.columnList.length;p++){var n=a.columnList[p],h=n[a.options.columnFields.id],l=n[a.options.columnFields.editorType],n=n[a.options.columnFields.editorSettings],r=p;h&&(r=a.getCellIndexById(e,p,h));0<=r&&r<e.length&&(e[r].type="cell",e[r][a.options.cellFields.rid]=b[a.options.rowFields.id],a.setDefaultCellValue(e[r],l,n))}}c&&(f?(a.fullList.push(b),a.fullIndentList.push(d)):a.options.paging.enabled?a.onlyCurrentPage?a.currentPageList.push({row:b,
indent:d}):(b[a.options.rowFields.pid]||a.pageRowCount++,a.pageRowCount>a.options.paging.pageSize&&(a.pageRowCount=1,a.pageNumber++,a.pageList.push([])),a.pageList[a.pageNumber].push({row:b,indent:d})):(a.currentList.push(b),a.indentList.push(d)));return c},y=function(b,d,c,f){var e=!0;if(!b[a.options.rowFields.rows])return e=K(b,d,c,f);if(e=K(b,d,c,f)){c=0;var g=!0;if("group"==b.type&&(f||a.isRowExpanded(b))){var h=b[a.options.rowFields.rows];if(h){a.applySorting(h);for(var l=0;l<h.length;l++)(g=
y(h[l],d+V,b[a.options.rowFields.id],f))&&c++}}f||a.isThereChildRows||!(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))||(a.isThereChildRows=!0)}return e};this.getFullList=function(){a.fullList.length=0;a.fullIndentList.length=0;for(var b=a.rowsObj.getList(),d=0;d<b.length;d++)y(b[d],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){a.currentList.length=0;a.indentList.length=
0;V=a.options.indent;if(a.options.paging.enabled){if(1<=a.currentPageNumber&&a.currentPageNumber<=a.pageList.length)for(var b=0;b<a.pageList[a.currentPageNumber-1].length;b++)a.currentList.push(a.pageList[a.currentPageNumber-1][b].row),a.indentList.push(a.pageList[a.currentPageNumber-1][b].indent)}else{a.isThereChildRows=!1;var d=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(d=a.groupList);if(d)for(a.applySorting(d),b=0;b<d.length;b++)y(d[b],0,null,!1)}};this.updatePageList=
function(){a.pageList.length=0;a.pageRowCount=0;a.pageNumber=0;a.isThereChildRows=!1;V=a.options.indent;var b=a.rowsObj.getList();a.options.grouping.enabled&&0<a.groups.length&&(b=a.groupList);if(b&&0<b.length){a.applySorting(b);a.pageList.push([]);for(var d=0;d<b.length;d++)y(b[d],0,null,!1);0<a.pageList.length&&0==a.pageList[a.pageList.length-1].length&&a.pageList.splice(a.pageList.length-1,1)}};this.columnEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearColumns?c.events.clearColumns():
c.clearColumns(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.columnAdded?c.events.columnAdded({column:a.e.column}):c.columnAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.columnAdding({column:a.e.column}):c.columnAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.columnRemoved({column:a.e.column}):c.columnRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?
c.events.columnRemoving({column:a.e.column}):c.columnRemoving(a)}};this.rowEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearRows?c.events.clearRows():c.clearRows(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.rowAdded?c.events.rowAdded({row:a.e.row}):c.rowAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.rowAdding({row:a.e.row}):c.rowAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&
c.events.rowRemoved?c.events.rowRemoved({row:a.e.row}):c.rowRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.rowRemoving({row:a.e.row}):c.rowRemoving(a)}};this.getRowFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.rows?a.rows:"rows",subobjects:a.cells?a.cells:"cells",text:a.text?a.text:"text"}};a.columnsObj=new na({objects:c.columns,events:a.columnEvents,
fields:a.options.columnFields});a.rowsObj=new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});c.$on(c.name+"-load-data",function(b,d,c){a.loadData(d,c)});c.$on(c.name+"-export-json",function(b,d,c,f){h.setTempData(a.exportToJSON(d,c,f))});this.exportToJSON=function(b,d,c){var f=c,f=f?f:null,e=a.columnsObj.getList();b=JSON.stringify(e,b?b:[a.options.columnFields.allowDrag,a.options.columnFields.allowDrop,a.options.columnFields.allowFilter,a.options.columnFields.allowGrouping,
a.options.columnFields.cellTemplateUrl,a.options.columnFields.contentAlignment,a.options.columnFields.contextMenu,a.options.columnFields.editorType,a.options.columnFields.editorSettings,a.options.columnFields.editorTemplate,a.options.columnFields.filterParams,a.options.columnFields.filterTemplate,a.options.columnFields.fixed,a.options.columnFields.fixedWidth,a.options.columnFields.footerAlignment,a.options.columnFields.footerContent,a.options.columnFields.footerTemplate,a.options.columnFields.footerText,
a.options.columnFields.groupText,a.options.columnFields.headerAlignment,a.options.columnFields.headerContent,a.options.columnFields.headerTemplate,a.options.columnFields.headerText,a.options.columnFields.icon,a.options.columnFields.id,a.options.columnFields.style,a.options.columnFields.visible,a.options.columnFields.width],f);c=c?c:null;f=a.getFullList();d=d?d:[a.options.rowFields.allowCellFocus,a.options.rowFields.allowDrag,a.options.rowFields.allowDrop,a.options.rowFields.allowFocus,a.options.rowFields.cells,
a.options.rowFields.content,a.options.rowFields.contextMenu,a.options.rowFields.enabled,a.options.rowFields.expanded,a.options.rowFields.hasChildren,a.options.rowFields.icon,a.options.rowFields.id,a.options.rowFields.pid,a.options.rowFields.statusIcon,a.options.rowFields.style,a.options.rowFields.text,a.options.cellFields.rid];0==flat&&d.push(a.options.rowFields.rows);d=JSON.stringify(f,d,c);return'[\n{ "columns": '+b+' },\n{ "rows": '+d+" }\n]"};this.loadData=function(b,d){a.suspendLayout();a.updateDataFields(d);
a.rowsObj.clear(null,a.rowsAreCleared);if(angular.isDefined(c.rows))for(var A=c.rows.length=0;A<b.length;A++)c.rows.push(b[A]);a.rowsObj=new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.resumeLayout()};this.updateData=function(){a.options.rowFields.dataSource&&(a.loadData(a.options.rowFields.dataSource),a.rowsObj=new na({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))};var za=!1;this.dragDropStatus=function(a){if(void 0!=a)za=
a;else return za};this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var Ga=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};angular.element(p).bind("dragenter",function(b){a.dropMark()});
angular.element(p).bind("dragend",function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer();a.dragDropStatus(!1)});a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getGridName=function(){return angular.isDefined(c.name)?c.name:""};e.bind("dragenter",function(b){b.preventDefault();var d=n.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceCtrl:d.sourceCtrl?
d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),targetRow:d.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)});e.bind("dragover",function(b){b.preventDefault();if(!a.isDropInRange(b)||a.options.grouping.enabled&&0<a.groups.length)a.dropMark(),b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none");else{var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&
b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d)if(b.dataTransfer?b.dataTransfer.dropEffect=a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=a.options.allowDrop?"move":"none"),d=n.getData(),d.source||(d.source=a.getDnDSource(b)),n.setData({source:d.source,sourceCtrl:d.sourceCtrl,target:null,dropPos:-1}),d={event:b,sourceCtrl:d.sourceCtrl?d.sourceCtrl.getGridName():"",dragRow:d.source,
targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},0==a.callDragOver(d))b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark();else{d=a.getMousePos(b);b=d.y+16;var d=d.x+20,A=a.getDropMarkWindow();A.empty();A.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"Grid")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),
{top:b,left:d});a.dropMark(!0)}}});e.bind("drop",function(b){b.preventDefault();a.dropMark();if(a.isDropInRange(b)){var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d&&(d=n.getData(),d.source||(d.source=a.getDnDSource(b)),d.source)){var A={event:b,sourceCtrl:d.sourceCtrl?d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,
dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(A)&&(a.drop(d),c.$$phase||c.$apply())}}n.clearData();b.stopPropagation()});e.bind("dragleave",function(b){b.preventDefault();a.dropMark();var d=n.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceCtrl:d.sourceCtrl?d.sourceCtrl.getGridName():"",dragRow:d.source,targetCtrl:a.getGridName(),targetRow:d.target,mousePos:a.getMousePos(b)};a.callDragLeave(b);a.cancelScrollTimer()});e.bind("dragend",function(b){b.preventDefault();a.dropMark();
n.getData().source||n.clearData();a.dragDropStatus(!1)});e.bind("mouseleave",function(b){b.preventDefault();a.dropMark();a.hoverColumn=null;a.hoverRow=null;a.hoverCell=null});this.containsMousePos=function(a,d){return n.hitTest(a,d,{left:0,top:0,right:e[0].clientWidth,bottom:e[0].clientHeight})};this.isPopupActive=function(){return!1};var Aa=function(b,d){var c=a.options.rowFields;if(!b[c.cells]){b[c.cells]=[];var f={};f[a.options.cellFields.text]=b[d.text];b[c.cells].push(f)}b[c.rows]||(b[c.rows]=
[]);b[c.rows].length=0;if(b[d.items]&&0<b[d.items].length)for(f=0;f<b[d.items].length;f++)b[c.rows].push(Aa(b[d.items][f],d));return b},Ba=function(b,d){var c=!1;d.sourceCtrl&&(c=d.sourceCollection.removeAt(b,-1,null,d.sourceCtrl.objIsRemoved));c&&("item"==b.type&&(b=Aa(b,d.sourceCtrl.options.dataFields)),1===d.dropPos||2===d.dropPos?1===d.dropPos?a.rowsObj.insertByRef(b,d.target,!1,a.rowIsAdded):a.rowsObj.insertByRef(b,d.target,!0,a.rowIsAdded):a.rowsObj.insertAt(b,-1,null,a.rowIsAdded))};this.setDropSelection=
function(b,d){var c=b;!c&&0<=d&&d<a.currentList.length&&(c=a.currentList[d]);a.clearPrevSelection(c);a.rowSelection(c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=!0;a.allowUpdate=!1;b.sourceCtrl.allowUpdate=!1;var d=b.source,c=-1;if(Array.isArray(b.source)){0<b.source.length&&(c=b.sourceCtrl.getObjCurrentIndex(b.source[b.source.length-1]));for(var f=[],e=0;e<b.source.length;e++){for(var g=!1,h=b.sourceCollection.getParent(b.source[e]);h;){if(b.sourceCtrl.isObjInSelList(h)){g=
!0;break}h=b.sourceCollection.getParent(h)}g||f.push(b.source[e])}if(0<f.length)if(d=f[f.length-1],e=b.sourceCtrl.getObjCurrentIndex(f[0]),g=b.sourceCtrl.getObjCurrentIndex(d),e<=g)for(e=0;e<f.length;e++)Ba(f[e],b);else for(e=f.length-1;0<=e;e--)Ba(f[e],b)}else c=b.sourceCtrl.getObjCurrentIndex(b.source),Ba(b.source,b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);
var n=l(function(){b.sourceCtrl!==a&&b.sourceCtrl.setDropSelection(null,c);a.setDropSelection(d);a.updateFocus(a.getObjCurrentIndex(d),0);l.cancel(n)},1);b.sourceCtrl.suppressProcess=!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&"row"==b.type&&(b[a.options.rowFields.allowDrag]||void 0===b[a.options.rowFields.allowDrag])?!0:!1:!1};this.isDropAllowed=function(b,d,c){if((c=a.options.allowDrop)&&b&&d&&(c="row"!=d.type||!d[a.options.rowFields.allowDrop]&&void 0!==d[a.options.rowFields.allowDrop]?
!1:!0))if(Array.isArray(b))for(var f=0;f<b.length;f++){if(b[f][a.options.rowFields.pid]&&d[a.options.rowFields.pid]&&!g.isEqual(b[f][a.options.rowFields.pid],d[a.options.rowFields.pid])){c=!1;break}else if(g.isEqual(b[f][a.options.rowFields.id],d[a.options.rowFields.id])){c=!1;break}if(!c)break}else b[a.options.rowFields.pid]&&d[a.options.rowFields.pid]&&!g.isEqual(b[a.options.rowFields.pid],d[a.options.rowFields.pid])?c=!1:g.isEqual(b[a.options.rowFields.id],d[a.options.rowFields.id])&&(c=!1);return c};
this.getDropMarkWindow=function(){for(var a=Ga,d=angular.element(document.body).children(),c=0;c<d.length;c++){var f=angular.element(d[c]);if(f[0].attributes&&f[0].attributes["data-element"]&&"dropmark"===f[0].attributes["data-element"].value){a=f;break}}return a};this.dropMark=function(b,d){d||(d=a.getDropMarkWindow());if(d){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(d).css("display",c)}};this.updateDropMarkElem=function(a,d){a&&d&&(a.css("top",d.top+"px"),a.css("left",
d.left+"px"),a.css("width",d.width+"px"))};c.$on(c.name+"-open-editor",function(b,d){a.openEditor(d)});c.$on(c.name+"-close-editor",function(b,d){a.closeEditor(d)});this.updateEditorSettings=function(b){a.options.editorSettings=b?{activate:g.isFieldAvailable(b.activate,"click")}:{activate:"click"}};this.allowEvents=!0;this.callAfterCollapse=function(a){angular.isDefined(c.events)&&c.events.afterCollapse&&c.events.afterCollapse({row:a});c.afterCollapse({e:{row:a}})};this.callAfterExpand=function(a){angular.isDefined(c.events)&&
c.events.afterExpand&&c.events.afterExpand({row:a});c.afterExpand({e:{row:a}})};this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({cell:a});c.afterEdit({e:{cell:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&c.events.afterLabelEdit&&c.events.afterLabelEdit({cell:a});c.afterLabelEdit({e:{cell:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?c.events.afterSelect({object:a}):c.afterSelect({e:{object:a}});
angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({object:a}):c.selectionChanged({e:{object:a}})};this.callBeforeCollapse=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeCollapse?c.events.beforeCollapse({row:a}):c.beforeCollapse({e:{row:a}})};this.callBeforeExpand=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeExpand?c.events.beforeExpand({row:a}):c.beforeExpand({e:{row:a}})};this.callBeforeEdit=function(a){var d=
!0;return d=angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({cell:a}):c.beforeEdit({e:{cell:a}})};this.callBeforeLabelEdit=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({cell:a}):c.beforeLabelEdit({e:{cell:a}})};this.callCellValueChanging=function(b,d,A){var f=!0;a.allowEvents&&(f=angular.isDefined(c.events)&&c.events.cellvalueChanging?c.events.cellvalueChanging({row:b,cell:d,value:A}):c.cellvalueChanging({e:{row:b,
cell:d,value:A}}));return f};this.callCellValueChanged=function(b,d,A){a.allowEvents&&(angular.isDefined(c.events)&&c.events.cellvalueChanged?c.events.cellvalueChanged({row:b,cell:d,value:A}):c.cellvalueChanged({e:{row:b,cell:d,value:A}}))};this.callChange=function(){angular.isDefined(c.events)&&c.events.change?c.events.change():c.change()};this.callColumnClick=function(a,d){angular.isDefined(c.events)&&c.events.columnClick&&c.events.columnClick({column:a,mousePos:d});c.columnClick({e:{column:a,mousePos:d}})};
this.callColumnDblClick=function(a,d){angular.isDefined(c.events)&&c.events.columnDblclick&&c.events.columnDblclick({column:a,mousePos:d});c.columnDblclick({e:{column:a,mousePos:d}})};this.callColumnHover=function(a){angular.isDefined(c.events)&&c.events.columnHover&&c.events.columnHover({column:a});c.columnHover({e:{column:a}})};this.callColumnPosChanging=function(a,d){var A=!0;return A=angular.isDefined(c.events)&&c.events.columnPoschanging?c.events.columnPoschanging({sourceColumn:a,targetColumn:d}):
c.columnPoschanging({e:{sourceColumn:a,targetColumn:d}})};this.callColumnPosChanged=function(a,d){angular.isDefined(c.events)&&c.events.columnPoschanged&&c.events.columnPoschanged({sourceColumn:a,targetColumn:d});c.columnPoschanged({e:{sourceColumn:a,targetColumn:d}})};this.callColumnRightClick=function(a,d){angular.isDefined(c.events)&&c.events.columnRightclick&&c.events.columnRightclick({column:a,mousePos:d});c.columnRightclick({e:{column:a,mousePos:d}})};this.callColumnSizeChanged=function(a,d){angular.isDefined(c.events)&&
c.events.columnSizechanged&&c.events.columnSizechanged({column:a});c.columnSizechanged({e:{column:a}})};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callDragOver=function(b){var d=
!0,d=a.getCellAt(b.mousePos.x,b.mousePos.y);return d=angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):c.dragOver({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};
this.callDragDrop=function(b){var d=!0,d=a.getCellAt(b.mousePos.x,b.mousePos.y);return d=angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):c.dragDrop({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,
mousePos:b.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceCtrl:a.sourceCtrl,dragRow:a.dragRow,targetCtrl:a.targetCtrl,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callCellClick=function(a,d,A,f){angular.isDefined(c.events)&&c.events.cellClick&&c.events.cellClick({event:a,
row:d,cell:A,mousePos:f});c.cellClick({e:{event:a,row:d,cell:A,mousePos:f}})};this.callCellHover=function(a,d){angular.isDefined(c.events)&&c.events.cellHover?c.events.cellHover({event:a,cell:d}):c.cellHover({e:{event:a,cell:d}})};this.callRowClick=function(a,d,A){angular.isDefined(c.events)&&c.events.rowClick?c.events.rowClick({event:a,row:d,mousePos:A}):c.rowClick({e:{event:a,row:d,mousePos:A}})};this.callRowDblClick=function(a,d){var A=!0;return A=angular.isDefined(c.events)&&c.events.rowDblClick?
c.events.rowDblClick({row:a,mousePos:d}):c.rowDblclick({e:{row:a,mousePos:d}})};this.callRowHover=function(a,d){angular.isDefined(c.events)&&c.events.rowHover?c.events.rowHover({event:a,row:d}):c.rowHover({e:{event:a,row:d}})};this.callRowRightClick=function(a,d){angular.isDefined(c.events)&&c.events.rowRightClick&&c.events.rowRightClick({row:a,mousePos:d});c.rowRightclick({e:{row:a,mousePos:d}})};this.callKeyDown=function(a,d){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,
row:d}):c.keyDown({e:{event:a,row:d}})};this.callKeyPress=function(a,d){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,row:d}):c.keyPress({e:{event:a,row:d}})};this.callKeyUp=function(a,d){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,row:d}):c.keyUp({e:{event:a,row:d}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):c.scrollposChanged({e:{scrollPos:a.scrollPos}})};
e.bind("click",function(b){1===b.which&&a.callRowClick(b,null,a.getMousePos(b))});e.bind("dblclick",function(b){b.preventDefault();1===b.which&&a.callRowDblClick(null,a.getMousePos(b));b.stopPropagation()});e.bind("mousedown",function(b){3===b.which&&a.callRowRightClick(null,a.getMousePos(b));a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b.stopPropagation()});this.expandList=[];this.expandIndentList=[];var rb=function(b,d,c){b.type||(b.type="row");b[a.options.rowFields.id]||(b[a.options.rowFields.id]=
g.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var f=b[a.options.rowFields.cells];if(f&&0<f.length){c=G(b);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&(c=c&&a.isThereVisibleChildren(b));for(var e=-1,h="label",l=null,l=null,n=0;n<a.columnList.length;n++){var l=a.columnList[n],e=l[a.options.columnFields.id],h=l[a.options.columnFields.editorType],l=l[a.options.columnFields.editorSettings],p=n;e&&(p=a.getCellIndexById(f,n,e));0<=p&&p<f.length&&(f[p].type=
"cell",a.setDefaultCellValue(f[p],h,l))}}c&&(a.expandList.push(b),a.expandIndentList.push(d));return c},B=function(b,d,c){var f=!0;if(!b[a.options.rowFields.rows])return f=rb(b,d+V,c);if(f=rb(b,d+V,c)){c=0;var e=!0;if("group"==b.type&&a.isRowExpanded(b)){var g=b[a.options.rowFields.rows];if(g){a.applySorting(g);for(var h=0;h<g.length;h++)(e=B(g[h],d+V,b[a.options.rowFields.id]))&&c++}}!a.isThereChildRows&&(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&
a.isThereVisibleChildren(b))&&(a.isThereChildRows=!0)}return f};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!a.isRowExpanded(b)){var d=a.getRowCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)B(b[c],a.indentList[d],null)}if(0<a.expandList.length){a.allowEvents=!1;d++;Array.prototype.splice.apply(a.currentList,[d,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,[d,0].concat(a.expandIndentList));a.getRowScope()?a.updateView():
a.updateLayout();var f=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();l.cancel(f);a.allowEvents=!0},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(a.isRowExpanded(b)){var d=null,c=!1,f=b,e=-1,g=a.getRowCurrentIndex(b);for(b=a.getParent(b);b&&!c;){d=a.getList(b);for(e=d.indexOf(f)+1;!c&&e<d.length;)f=d[e],0<a.getRowCurrentIndex(f)&&(c=!0),e++;c||(f=b);b=a.getParent(b)}if(!c&&f)for(d=a.getList(),a.options.grouping.enabled&&0<a.groups.length&&
(d=a.groupList),e=d.indexOf(f)+1;e<d.length;)if(f=d[e],0<a.getRowCurrentIndex(f)){c=!0;break}else e++;g++;d=a.currentList.length-g;c&&(d=a.getRowCurrentIndex(f)-g);if(0<d){a.currentList.splice(g,d);a.indentList.splice(g,d);a.getRowScope()?a.updateView():a.updateLayout();var h=l(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();l.cancel(h);a.allowEvents=!0},1)}}};this.toggle=function(b,d){if(b){if(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0!=b[a.options.rowFields.rows].length)if(!d||
0==b[a.options.rowFields.expanded])if(!1!==d||0!=b[a.options.rowFields.expanded]){a.updateType="view";var c=void 0!==d?d:!1!==b[a.options.rowFields.expanded]?!0:!1,f=!0,f=void 0!==d?d?a.callBeforeExpand(b):a.callBeforeCollapse(b):c?a.callBeforeCollapse(b):a.callBeforeExpand(b);!1!==f&&(c=void 0!=d?d:!c,c!=b[a.options.rowFields.expanded]&&(0!=c?a.expand(b):a.collapse(b),b[a.options.rowFields.expanded]=c),a.isRowExpanded(b)?a.callAfterExpand(b):a.callAfterCollapse(b))}}else{c=a.getFullList();for(f=
0;f<c.length;f++)c[f][a.options.rowFields.expanded]=d;a.updateCurrentLayout()}};this.isFilteringAllowed=function(b){return b&&b[a.options.columnFields.allowFilter]};c.$on(c.name+"-filter",function(b,d,c){a.filter(d,c)});this.filter=function(b,d){if(b)b[a.options.columnFields.filterParams]=d;else for(var c=0;c<a.columnList.length;c++)b[a.options.columnFields.filterParams]=null;a.closeFilterWindow();a.updateCurrentLayout();a.callChange()};this.callGotFocus=function(a,d,e,f,g){angular.isDefined(c.events)&&
c.events.gotFocus?c.events.gotFocus({event:a,row:d,cell:e,edit:void 0!=f?!0:!1,editValue:g}):c.gotFocus({e:{event:a,row:d,cell:e,edit:void 0!=f?!0:!1,editValue:g}})};this.callLostFocus=function(a,d,e,f,g){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,row:d,cell:e,edit:void 0!=f?!0:!1,editValue:g}):c.lostFocus({e:{event:a,row:d,cell:e,edit:void 0!=f?!0:!1,editValue:g}})};this.getTabIndex=function(){return e[0].attributes&&e[0].attributes.tabindex?e[0].attributes.tabindex.value:
""};this.updateFocus=function(b,d){if(1==a.options.allowFocus)var c=l(function(){if(a.isRowIndexInRange(b)){var f="none";0<=d&&d<a.columnList.length&&(f=a.columnList[d][a.options.columnFields.fixed]);var g=a.getElemFromRow(a.currentList[b],f);g&&(1==a.options.allowCellFocus&&0<=d&&d<a.columnList.length?(f=a.getElemFromCell(b,d,f))&&f[0].focus():g[0].focus())}else e[0].focus();l.cancel(c)},5)};c.$on(c.name+"-focus",function(b,d){if(d){var c=-1,f=-1;switch(d.type){case "group":c=a.getRowCurrentIndex(d);
a.updateFocus(c);break;case "row":c=a.getRowCurrentIndex(d);a.updateFocus(c);break;case "cell":c=a.getCellRowIndex(d),f=a.getCellColumnIndex(d),a.updateFocus(c,f)}}else a.updateFocus()});var ab=!1;this.getCell=function(b,d){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],f=a.getColumnRealIndex(d);0<=d&&d<a.columnList.length&&(f=a.getCellIndexById(c[a.options.rowFields.cells],d,a.columnList[d].id));if(c[a.options.rowFields.cells]&&0<=f&&f<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][f]}return null};
this.getCellObject=function(b,c){if(0<=b&&b<a.currentList.length){var e=a.currentList[b],f=a.getColumnRealIndex(c);0<=c&&c<a.columnList.length&&(f=a.getCellIndexById(e[a.options.rowFields.cells],c,a.columnList[c].id));if(e[a.options.rowFields.cells]&&0<=f&&f<e[a.options.rowFields.cells].length)return e[a.options.rowFields.cells][f]}return null};this.getCellIndexById=function(b,c,e){var f=-1;if(b){c=a.getColumnRealIndex(c);for(var g=0;g<b.length;g++)if(void 0==b[g][a.options.cellFields.cid]){f=c;break}else if(b[g][a.options.cellFields.cid]==
e){f=g;break}}return f};this.getCellIndexFromRow=function(b,c){var e=-1;if(b&&c&&c[a.options.rowFields.cells])for(var f=0;f<c[a.options.rowFields.cells].length;f++)if(c[a.options.rowFields.cells][f]==b){e=f;break}return e};this.getCellColumnIndex=function(b){if(b)if(b[a.options.cellFields.cid]){if(b=a.getColumnById(b[a.options.cellFields.cid]))return a.getColumnCurrentIndex(b)}else return a.getCellColumnIndexFromRow(b);return-1};this.getCellColumnIndexFromRow=function(b){if(b&&b[a.options.cellFields.rid]){var c=
a.findRowById(b[a.options.cellFields.rid]);if(c&&(c=c[a.options.rowFields.cells])&&0<c.length)return c.indexOf(b)}return-1};this.getCellRowIndex=function(b){return b&&b[a.options.cellFields.rid]&&(b=a.findRowById(b[a.options.cellFields.rid]))?a.getRowCurrentIndex(b):-1};this.getColumnById=function(b){for(var c=null,e=0;e<a.columnList.length;e++)if(a.columnList[e][a.options.columnFields.id]==b){c=a.columnList[e];break}return c};this.getColumnObject=function(b){return 0<=b&&b<a.columnList.length?a.columnList[b]:
null};this.getRowObject=function(b){return 0<=b&&b<a.currentList.length?a.currentList[b]:null};this.isRowExpanded=function(b){return b?b[a.options.rowFields.expanded]||void 0===b[a.options.rowFields.expanded]?!0:!1:!0};this.getContentElement=function(a,c){var e=null;c||(c="cell-content");if(a&&0<a.children().length)for(var f=a.children(),g=0;g<f.length;g++){var h=angular.element(f.eq(g));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==c){e=h;break}}return e};
this.getElement=function(a,c){var e=null;c||(c="cell-content");if(a&&0<a.children().length){a=a.children().eq(0);for(var f=a.children(),g=0;g<f.length;g++){var h=angular.element(f.eq(g));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==c){e=h;break}}}return e};this.getChildElement=function(a,c){var e=null;c||(c="content");if(a&&0<a.children().length)for(var f=a.children(),g=0;g<f.length;g++){var h=angular.element(f.eq(g));if(h[0].attributes&&h[0].attributes["data-element"]&&
h[0].attributes["data-element"].value==c){e=h;break}}return e};this.getElemFromColumn=function(b,c,e){var f=null;if(b){b=a.getColumnCurrentIndex(b);var g=a.getHeaderElem(c);"footer"==e&&(g=a.getFooterElem(c));if(g&&(c=g.find("td"))&&0<c.length)for(e=0;e<c.length;e++)if(g=angular.element(c[e]),g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===b.toString()){f=g;break}}return f};this.getElemFromRow=function(b,c){var e=null;if(b){var f=a.getRowCurrentIndex(b),g=a.getRowElems(c);
if(g&&0<g.length)for(var h=0;h<g.length;h++){var l=angular.element(g[h]);if(l[0].attributes["data-index"]&&l[0].attributes["data-index"].value.toString()===f.toString()){e=l;break}}}return e};this.getElemFromCell=function(b,c,e){var f=null;if(0<=b&&b<a.currentList.length&&(b=a.getElemFromRow(a.currentList[b],e))&&(b=b.find("td"))&&0<b.length)for(e=0;e<b.length;e++){var g=angular.element(b[e]);if(g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===c.toString()){f=g;break}}return f};
this.getElemFromColumnCell=function(b,c,e){var f=null,g=null;if((g=e?a.getFooterElem(c):a.getHeaderElem(c))&&(c=g.find("td"))&&0<c.length)for(e=0;e<c.length;e++)if(g=angular.element(c[e]),g[0].attributes["data-index"]&&g[0].attributes["data-index"].value.toString()===b.toString()){f=g;break}return f};this.getIndent=function(b){var c=0;if(b)for(parent=a.rowsObj.getParent(b);parent;)c+=a.options.indent,parent=a.rowsObj.getParent(parent);return c};this.getObjState=function(b){if(b)switch(b.type){case "column":if(1==
b.selected)return"selected";if(b==a.hoverColumn)return"hovered";break;case "group":if(0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "row":if(0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "cell":if(0==b[a.options.cellFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverCell)return"hovered"}return"normal"};this.getColumnAt=
function(b,c){if(void 0==b||void 0==c)return a.hoverColumn;for(var e=null,f=null,h=null,e="left",l=0;!h&&3>l;){if(e=a.getHeaderElem(e)){var n=e.find("td");if(n&&0<n.length)for(var p=0;p<n.length;p++)if(e=angular.element(n[p]),f=g.getPageRect(e),g.checkHit(b,c,f)){h=a.getColumnFromElem(e);break}}l++;e=1==l?"right":"none"}return h};this.getCellAt=function(b,c){var e=null,f=a.getRowAt(b,c);if(f){var h=null,l=null,n=a.getElemFromRow(f).find("td");if(n&&0<n.length)for(var p=0;p<n.length&&!(h=angular.element(n[p]),
l=g.getPageRect(h),g.checkHit(b,c,l)&&(e=a.getRowCurrentIndex(f),h=a.getIndexFromElem(h),e=a.getCellObject(e,h)));p++);}return e};this.getRowAt=function(b,c){for(var e=null,f=null,h=null,e="none",l=0;!h&&3>l;){var n=a.getRowElems(e);if(n&&0<n.length)for(var p=0;p<n.length;p++)if(e=angular.element(n[p]),f=g.getPageRect(e),g.checkHit(b,c,f)){h=a.getRowFromElem(e);break}l++;e=1==l?"left":"right"}return h};this.getRowCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):-1};this.getObjCurrentIndex=
function(b){return a.getRowCurrentIndex(b)};this.getRowFromChildElem=function(b){if(b&&(b=angular.element(b))){for(b=b.parent();b&&b[0].tagName&&"tr"!==b[0].tagName.toLowerCase();)b=b.parent();return b?a.getRowFromElem(b):null}return null};this.getColumnCurrentIndex=function(b){return b&&a.columnList?a.columnList.indexOf(b):-1};this.getColumnRealIndex=function(b){var c=a.columnsObj.getList();return 0<=b&&b<c.length&&b<a.columnList.length?c.indexOf(a.columnList[b]):-1};this.getColumnFromChildElem=
function(b){return b?a.getColumnFromElem(b):null};this.getColumnFromElem=function(b){return b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,0<=b&&b<a.columnList.length)?a.columnList[b]:null};this.getIndexFromElem=function(a){return a&&(a=angular.element(a))&&a[0].attributes["data-index"]?a[0].attributes["data-index"].value:-1};this.getRowFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,
a.isRowIndexInRange(b)))return a.currentList[b]};this.isRowIndexInRange=function(b){return 0<=b&&b<a.currentList.length};this.isColIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowEnabled=function(b){return b&&g.isEnabled(b[a.options.rowFields.enabled])};this.mouseButtonStatus=function(a){ab=a};c.$on(c.name+"-ensure-visible",function(b,c){a.ensureVisible(c)});c.$on(c.name+"-find-row-by-id",function(b,c){h.setTempData(a.findRowById(c))});c.$on(c.name+"-find-row-by-text",function(b,
c){h.setTempData(a.findRowByText(c))});c.$on(c.name+"-get-list",function(b,c){h.setTempData(a.getList(c))});c.$on(c.name+"-get-top-row",function(b){h.setTempData(a.getTopRow())});c.$on(c.name+"-set-top-row",function(b,c){a.ensureVisible(c)});this.ensureVisible=function(b,c){if(b){for(var e=[],f=a.getParent(b);f;)e.push(f),f=a.getParent(f);for(f=e.length-1;0<=f;f--)e[f][a.options.rowFields.expanded]=!0;a.updateCurrentLayout();var g=l(function(){c=void 0!=c?c:"center";a.scrollTo(b,c);l.cancel(g)},100)}};
this.findRowById=function(b){return a.rowsObj.findObjectById(b)};this.findRowByText=function(b){return a.rowsObj.findObjectByText(b)};this.getLevel=function(a){var c=0;for(a=this.getParent(a);a;)c++,a=this.getParent(a);return c};this.findParent=function(b,c){var e=null;if(b&&c)for(var f=0;!e&&f<c.length;)e=c[f][a.options.rowFields.id]&&b[a.options.rowFields.pid]&&c[f][a.options.rowFields.id].toString()===b[a.options.rowFields.pid].toString()?c[f]:a.findParent(b,c[f][a.options.rowFields.rows]),f++;
return e};this.getParent=function(b){return b?a.findParent(b,a.groupList):null};this.getList=function(b){return a.rowsObj.getList(b)};this.getFirstRow=function(){for(var b=null,c=0;c<a.currentList.length;c++)if(g.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.getPrevRow=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(g.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getNextRow=
function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(g.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getLastRow=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(g.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);
break;default:a.multiSelection(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};e.bind("keydown",function(b){switch(b.keyCode){case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}});this.allowUpdate=!0;this.updateType=
"all";this.suspendLayout=function(){a.allowUpdate=!1};this.resumeLayout=function(){a.allowUpdate=!0;a.updateLayout()};c.$on(c.name+"-refresh",function(b,c,e){a.refresh(c,e)});c.$on(c.name+"-resume-layout",function(b){a.resumeLayout()});c.$on(c.name+"-suspend-layout",function(b){a.suspendLayout()});c.$on(c.name+"-update-layout",function(b){a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",function(b,c){a.beginLoad(c)});c.$on(c.name+"-end-load",function(b){a.endLoad()});
this.callLoadComplete=function(){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-current-page",function(b){h.setTempData(a.currentPageNumber)});c.$on(c.name+"-set-current-page",function(b,c){a.setCurrentPage(c)});c.$on(c.name+"-first-page",function(b){a.firstPage()});c.$on(c.name+"-last-page",function(b){a.lastPage()});
c.$on(c.name+"-next-page",function(b){a.nextPage()});c.$on(c.name+"-prev-page",function(b){a.prevPage()});this.setCurrentPage=function(b){a.currentPageNumber!=b&&1<=b&&b<=a.pageList.length&&(a.currentPageNumber=b,a.updateCurrentLayout())};this.firstPage=function(){1!=a.currentPageNumber&&(a.currentPageNumber=1,a.updateCurrentLayout())};this.lastPage=function(){a.currentPageNumber!=a.pageList.length&&(a.currentPageNumber=a.pageList.length,a.updateCurrentLayout())};this.nextPage=function(){a.currentPageNumber<
a.pageList.length&&(a.currentPageNumber++,a.updateCurrentLayout())};this.prevPage=function(){1<a.currentPageNumber&&(a.currentPageNumber--,a.updateCurrentLayout())};c.$on(c.name+"-get-max-scroll-pos",function(b){h.setTempData(a.getMaxScrollPos())});c.$on(c.name+"-get-scroll-pos",function(b){h.setTempData(a.getScrollPos())});c.$on(c.name+"-set-scroll-pos",function(b,c){a.setScrollPos(c)});c.$on(c.name+"-scroll-to",function(b,c,e){a.scrollTo(c,e)});var ua=!1;this.multiSelection=function(a){if(void 0!=
a)ua=a;else return ua};this.columnSelection=function(b,d){if(b){var e=!0;a.options.selectedColumn&&(e=!g.isEqual(a.options.selectedColumn[a.options.columnFields.id],b[a.options.columnFields.id]));var f=!0,f=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});e&&!1!==f&&(a.options.selectedColumn&&(a.options.selectedColumn.selected=!1,a.refresh(a.options.selectedColumn)),a.options.selectedColumn=b,b.selected=!0,angular.isDefined(c.selectedColumn)&&
(c.selectedColumn=b),a.refresh(a.options.selectedColumn),a.callAfterSelect(b))}else return a.options.selectedColumn};this.isRowSelected=function(a){return g.isSelected(a)};this.clearPrevSelection=function(b){for(var c=0;c<a.options.selectedRows.length;c++)b&&!g.isEqual(a.options.selectedRows[c][a.options.rowFields.id],b[a.options.rowFields.id])?a.options.selectedRows[c].selected=!1:b||(a.options.selectedRows[c].selected=!1);a.options.selectedRows.length=0;b&&0!=b[a.options.rowFields.enabled]&&a.options.selectedRows.push(b);
a.refreshRows()};this.markSelColumn=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b])};this.rowSelection=function(b,d,e,f){if(b){if("none"!=a.options.selectionMode)if(a.isRowEnabled(b)){e=a.rowSelection();var h=!0;e&&(h=!g.isEqual(e[a.options.rowFields.id],b[a.options.rowFields.id]));var l=!0,l=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(!1!==l)if(h){var n=event&&(event.shiftKey||event.ctrlKey||event.metaKey)?
!0:!1,h=!0;"multi-extended"==a.options.selectionMode&&(h=!a.isObjInSelList(b));h&&(ab&&d?a.clearPrevSelection():ua||n||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedRow=b;if(ab&&d&&"one"!=a.options.selectionMode){if(d=a.getRowCurrentIndex(e),f=a.getRowCurrentIndex(b),d>f&&(n=d,d=f,f=n),a.isRowIndexInRange(d)&&a.isRowIndexInRange(f))for(;d<=f;d++)a.currentList[d].selected=!0,a.options.selectedRows.push(a.currentList[d])}else ab&&(ua||n||"multi-simple"===a.options.selectionMode)?
(d=null===b.selected||"undefined"===b.selected?!1:b.selected,b.selected=!d,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b})):(b.selected=!0,a.isObjInSelList(b)||a.options.selectedRows.push(b));angular.isDefined(c.selectedRow)&&(c.selectedRow=b);a.callAfterSelect(b);a.refresh(null,null,!0)}else if(ua||n||"multi-simple"===a.options.selectionMode)d=null===b.selected||"undefined"===b.selected?!1:b.selected,f&&
"undefined"!==f&&(d=f),b.selected=!d,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b}),a.callAfterSelect(b),a.refresh(null,null,!0)}else a.clearPrevSelection()}else return a.options.selectedRow};this.updateSelection=function(b,c,e){b=b&&(b.shiftKey||b.ctrlKey||b.metaKey)?!0:!1;"multi-extended"==a.options.selectionMode&&0<a.options.selectedRows.length&&!e&&!ua&&!b&&(a.clearPrevSelection(c),a.refresh(null,null,
!0))};this.isObjInSelList=function(b){var c=!1,e=a.options.selectedRows;if(b&&e)for(var f=0;f<e.length;f++)if(g.isEqual(e[f][a.options.rowFields.id],b[a.options.rowFields.id])){c=!0;break}return c};c.$on(c.name+"-clear-selection",function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=null;a.clearPrevSelection();a.options.selectedRow=null});c.$on(c.name+"-get-hover-column",function(b,c){a.hoverColumn?h.setTempData(a.hoverColumn):c&&h.setTempData(a.getColumnAt({x:c.x,
y:c.y}))});c.$on(c.name+"-get-selected-column",function(b){h.setTempData(a.columnSelection())});c.$on(c.name+"-set-selected-column",function(b,c){a.columnSelection(c)});c.$on(c.name+"-get-selected-row",function(b){h.setTempData(a.rowSelection())});c.$on(c.name+"-set-selected-row",function(b,c){var e=l(function(){a.rowSelection(c);l.cancel(e)},1)});c.$on(c.name+"-get-selected-rows",function(b){h.setTempData(a.options.selectedRows)});c.$on(c.name+"-set-selected-rows",function(b,c){c&&Array.isArray(c)&&
l(function(){for(var b=a.options.selectedRows.length=0;b<c.length;b++)c[b].selected=!0,a.options.selectedRows.push(c[b]);0<c.length?(a.options.selectedRow=c[c.length-1],a.callAfterSelect(a.options.selectedRow)):a.options.selectedRow=null;a.refresh(null,null,!0)},1)});c.$on(c.name+"-move-column",function(b,c,e){a.moveColumn(c,e)});c.$on(c.name+"-move-row",function(b,c,e,f,g){a.moveRow(c,e,f,g)});c.$watch("options",function(b,c){b!==c&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowCellFocus",
function(b,c){b!==c&&(a.options.allowCellFocus=b)});c.$watch("allowColumnReorder",function(b,c){b!==c&&(a.options.allowColumnReorder=b)});c.$watch("allowFilter",function(b,c){b!==c&&(a.options.allowFilter=b)});c.$watch("allowFocus",function(b,c){b!==c&&(a.options.allowFocus=b)});c.$watch("allowDrag",function(b,c){b!==c&&(a.options.allowDrag=b,a.updateView())});c.$watch("allowDrop",function(b,c){b!==c&&(a.options.allowDrop=b,a.updateView())});c.$watch("autoExpand",function(b,c){b!==c&&(a.options.autoExpand=
b)});c.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});c.$watch("editorSettings",function(b,c){b!==c&&a.updateEditorSettings(b)});c.$watch("expandingColumnIndex",function(b,c){b!==c&&(a.options.expandColIndex=b)});c.$watch("fields",function(b,c){b!==c&&(a.updateDataFields(b),a.UpdateData())});c.$watch("fillSpace",function(b,c){b!==c&&(a.options.fillSpace=b)});c.$watch("gridLines",function(b,c){b!==c&&(a.options.gridLines=b,a.updateView())});c.$watch("grouping",function(b,c){b!==
c&&(a.updateGrouping(b),a.updateLayout())},!0);c.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,c){b!==c&&(a.options.indent=b,a.updateLayout())});c.$watch("rowIcon",function(b,c){b!==c&&(a.options.rowIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,c){b!==c&&(a.options.labelEdit=b)});c.$watch("paging",function(b,c){b!==c&&(a.updatePaging(b),a.resetPageNumber(),a.updateCurrentLayout())},!0);c.$watch("pathSeparator",function(b,c){b!==
c&&(a.options.pathSeparator=b)});c.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});a.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.rowSelection())}};c.$watch("selectionMode",function(b,c){b!==c&&(a.options.selectionMode=b,a.resetSelection())});c.$watch("showFooter",function(b,c){b!==c&&(a.options.showFooter=b,a.updateLayout())});c.$watch("showHeader",function(b,c){b!==c&&(a.options.showHeader=
b,a.updateLayout())});c.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});c.$watch("selectedRow",function(b,c){b!==c&&(c&&(c.selected=!1),a.options.selectedRow=b,a.callAfterSelect(b))});this.sortComparer=this.sortColumn=null;c.$watch("sorting",function(b,c){b!==c&&(a.options.sorting=b)});c.$on(c.name+"-sort",function(b,c,e,f){a.sort(c,e,f)});this.sort=function(b,c,e){a.sortColumn=b;a.sortComparer=e;if("ascending"==c||"descending"==c||"none"==c)a.options.sorting=c;
a.updateCurrentLayout();a.callChange()};this.getCellIndexInCollection=function(b,c,e){var f=-1;if(b)for(var g=0;g<b.length;g++)if(void 0==b[g][a.options.cellFields.cid]){f=c;break}else if(b[g][a.options.cellFields.cid]==e){f=g;break}return f};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||"descending"==a.options.sorting};this.applySorting=function(b){if(b&&(!a.sortColumn||0!=a.sortColumn[a.options.columnFields.visible])){var c=a.getColumnCurrentIndex(a.sortColumn),e=0<=c?c:
a.options.expandColIndex;if(e<a.columnList.length){var f=a.columnList[e][a.options.columnFields.id];a.sortColumn&&a.sortColumn[a.options.columnFields.comparer]?b.sort(a.sortColumn[a.options.columnFields.comparer]):a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var d=null,h=null;if(b[a.options.rowFields.cells]){var l=a.getCellIndexInCollection(b[a.options.rowFields.cells],e,f);0<=l&&((d=b[a.options.rowFields.cells][l][a.options.cellFields.value])||(d=b[a.options.rowFields.cells][l][a.options.cellFields.text]),
g.isObject(d)&&(d=d.value?d.value:d.text))}c[a.options.rowFields.cells]&&(l=a.getCellIndexInCollection(c[a.options.rowFields.cells],e,f),0<=l&&((h=c[a.options.rowFields.cells][l][a.options.cellFields.value])||(h=c[a.options.rowFields.cells][l][a.options.cellFields.text]),g.isObject(h)&&(h=h.value?h.value:h.text)));d=void 0!=d?d:null;h=void 0!=h?h:null;switch(a.options.sorting){case "ascending":if(d<h)return-1;if(d>h)return 1;break;case "descending":if(d>h)return-1;if(d<h)return 1;break;default:return 0}})}}};
var D=function(b){if(b){var c=g.isFieldAvailable(b.general,"iui-grid-column"),e;e=(e=b.header)?{content:g.isFieldAvailable(e.content,"iui-grid-column-header-cell-content"),disabled:g.isFieldAvailable(e.disabled,"iui-grid-column-header-disabled"),normal:g.isFieldAvailable(e.normal,"iui-grid-column-header"),hovered:g.isFieldAvailable(e.hovered,"iui-grid-column-header-hovered"),selected:g.isFieldAvailable(e.selected,"iui-grid-column-header-selected")}:a.options.controlStyle.column.header;b=(b=b.footer)?
{content:g.isFieldAvailable(b.content,"iui-grid-column-footer-cell-content"),disabled:g.isFieldAvailable(b.disabled,"iui-grid-column-footer-disabled"),normal:g.isFieldAvailable(b.normal,"iui-grid-column-footer"),hovered:g.isFieldAvailable(b.hovered,"iui-grid-column-footer-hovered"),selected:g.isFieldAvailable(b.selected,"iui-grid-column-footer-selected")}:a.options.controlStyle.column.footer;return{general:c,header:e,footer:b}}return a.options.controlStyle.column};this.getExpandBoxStyle=function(b){return b?
{general:g.isFieldAvailable(b.general,"iui-grid-expand-box"),animated:g.isFieldAvailable(b.animated,"iui-grid-expand-box-load"),expanded:g.isFieldAvailable(b.expanded,"iui-grid-expand-box-open"),collapsed:g.isFieldAvailable(b.collapsed,"iui-grid-expand-box-close")}:a.options.controlStyle.row.expandBox};var sb=function(b){if(b){var c;c=(c=b.general)?{disabled:g.isFieldAvailable(c.disabled,"iui-grid-row-disabled"),focused:g.isFieldAvailable(c.focused,"iui-grid-row-focused"),normal:g.isFieldAvailable(c.normal,
"iui-grid-row"),hovered:g.isFieldAvailable(c.hovered,"iui-grid-row-hovered"),selected:g.isFieldAvailable(c.selected,"iui-grid-row-selected")}:a.options.controlStyle.row.general;var e;var f=b.checkBox;f?(e=g.isFieldAvailable(f.general,"iui-checkbox"),f=(f=f.box)?{general:g.isFieldAvailable(f.general,"iui-checkbox-box"),disabled:g.isFieldAvailable(f.disabled,"iui-checkbox-disabled"),checked:g.isFieldAvailable(f.checked,"iui-checkbox-checked"),indeterminate:g.isFieldAvailable(f.indeterminate,"iui-checkbox-indeterminate"),
unchecked:g.isFieldAvailable(f.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.row.checkBox.box,e={general:e,box:f}):e=a.options.controlStyle.row.checkBox;f=a.getExpandBoxStyle(b.expandBox);b=(b=b.cell)?{content:g.isFieldAvailable(b.content,"iui-grid-row-cell-content"),general:g.isFieldAvailable(b.general,"iui-grid-row-cell"),disabled:g.isFieldAvailable(b.disabled,"iui-grid-row-cell-disabled"),focused:g.isFieldAvailable(b.focused,"iui-grid-row-cell-focused"),normal:g.isFieldAvailable(b.normal,
"iui-grid-row-cell"),hovered:g.isFieldAvailable(b.hovered,"iui-grid-row-cell-hovered"),selected:g.isFieldAvailable(b.selected,"iui-grid-row-cell-selected")}:a.options.controlStyle.row.cell;return{general:c,checkBox:e,expandBox:f,cell:b}}return a.options.controlStyle.row},z=function(b){return b?{content:g.isFieldAvailable(b.content,"iui-grid-row-cell-content"),general:g.isFieldAvailable(b.general,"iui-grid-row-cell"),disabled:g.isFieldAvailable(b.disabled,"iui-grid-row-cell-disabled"),focused:g.isFieldAvailable(b.focused,
"iui-grid-row-cell-focused"),normal:g.isFieldAvailable(b.normal,"iui-grid-row-cell"),hovered:g.isFieldAvailable(b.hovered,"iui-grid-row-cell-hovered"),selected:g.isFieldAvailable(b.selected,"iui-grid-row-cell-selected")}:a.options.controlStyle.cell};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:g.isFieldAvailable(b.general,"iui-grid"),column:D(b.column),row:sb(b.row),cell:z(b.cell)}:{general:g.isFieldAvailable(a.defaultStyle.general,"iui-grid"),column:D(a.defaultStyle.column),
row:sb(a.defaultStyle.row),cell:z(a.defaultStyle.cell)}};this.getCurrentColumnStyle=function(b,c,e){var f=a.options.controlStyle.column;b&&b.style&&(f=b.style);b=a.options.controlStyle.column.body;var g=f.body;switch(c){case "header":b=a.options.controlStyle.column.header;g=f.header;break;case "footer":b=a.options.controlStyle.column.footer,g=f.footer}if(e)switch(e){case "content":return g&&g.content?g.content:b.content;case "disabled":return g&&g.disabled?g.disabled:b.disabled;case "hovered":return g&&
g.hovered?g.hovered:b.hovered;case "selected":return g&&g.selected?g.selected:b.selected;default:return g&&g.normal?g.normal:b.normal}else return c?g?g:b:f?f:a.options.controlStyle.column};this.getCurrentRowStyle=function(b,c){var e=a.options.controlStyle.row;if(b)switch(b[a.options.rowFields.style]){case "initial":break;case "parent":return a.getCurrentRowStyle(a.getParent(b),c);default:null!=b.style&&(e=b.style)}if(c){if(g.isString(e.general))return e.general;switch(c){case "disabled":return e.general&&
e.general.disabled?e.general.disabled:a.options.controlStyle.row.general.disabled;case "focused":return e.general&&e.general.focused?e.general.focused:a.options.controlStyle.row.general.focused;case "hovered":return e.general&&e.general.hovered?e.general.hovered:a.options.controlStyle.row.general.hovered;case "selected":return e.general&&e.general.selected?e.general.selected:a.options.controlStyle.row.general.selected;default:return e.general&&e.general.normal?e.general.normal:a.options.controlStyle.row.general.normal}}else return e?
e:a.options.controlStyle.row};this.getDefaultCellContentClass=function(){return"iui-grid-row-cell-content"};this.getDefaultCellLabelClass=function(){return"iui-grid-row-cell-label"};this.getDefaultCellBorderClass=function(){return"iui-grid-lines-both"};this.getCurrentCellStyle=function(b,c,e){var f=a.options.controlStyle.row.cell;if(c)switch(c[a.options.cellFields.style]){case "initial":break;case "parent":b&&(f=z(a.getCurrentRowStyle(b)));break;default:c.style&&(f=c.style)}if(e)switch(e){case "content":return f.content?
f.content:a.options.controlStyle.cell.content;case "disabled":return f.disabled?f.disabled:a.options.controlStyle.cell.disabled;case "focused":return f.focused?f.focused:a.options.controlStyle.cell.focused;case "hovered":return f.hovered?f.hovered:a.options.controlStyle.cell.hovered;case "selected":return f.selected?f.selected:a.options.controlStyle.cell.selected;default:return f.normal?f.normal:a.options.controlStyle.cell.normal}else return f?f:a.options.controlStyle.row.cell}}]).directive("iuiGrid",
["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window","IntegralUIListCtrlService",function(c,e,l,p,r,g,na){return{restrict:"EA",controller:"IntegralUIGridController",transclude:!0,replace:!0,template:'<div class="iui-grid" data-element="grid"><div class="iui-grid-block"></div></div>',scope:{allowAnimation:"=",allowCellFocus:"=",allowColumnReorder:"=",allowFilter:"=",allowFocus:"=",allowDrag:"=",allowDrop:"=",animationSpeed:"=",autoExpand:"=",columns:"=",controlStyle:"=",
editorSettings:"=",expandingColumnIndex:"=",fields:"=",fillSpace:"=",gridLines:"=",grouping:"=",hoverSelection:"=",indent:"=",labelEdit:"=",name:"@",options:"=?",paging:"=?",pathSeparator:"@",rowIcon:"=",rows:"=",selectedIndex:"=",selectedRow:"=",selectionMode:"@",showFooter:"=",showHeader:"=",showIcons:"=",sorting:"@",afterCollapse:"&",afterEdit:"&",afterExpand:"&",afterLabelEdit:"&",afterSelect:"&",beforeCollapse:"&",beforeEdit:"&",beforeExpand:"&",beforeLabelEdit:"&",beforeSelect:"&",cellClick:"&",
cellHover:"&",cellvalueChanged:"&",cellvalueChanging:"&",change:"&",clearColumns:"&",clearRows:"&",columnAdded:"&",columnAdding:"&",columnClick:"&",columnDblclick:"&",columnHover:"&",columnPoschanging:"&",columnPoschanged:"&",columnRemoved:"&",columnRemoving:"&",columnRightclick:"&",columnSizechanged:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",events:"=?",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",loadComplete:"&",lostFocus:"&",rowAdded:"&",rowAdding:"&",rowClick:"&",rowDblclick:"&",
rowHover:"&",rowRemoved:"&",rowRemoving:"&",rowRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(h,n,$b,a,xc){var G=this,V=n.children().eq(0),K=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),y=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),za=angular.element('<div class="iui-scrollbar-corner"></div>'),Ga=null,Aa=null,Ba=
null,rb=!1,B=angular.element('<input type="text" class="iui-label-editor" draggable="false" />');a.labelEditStatus=function(a){if(void 0!=a)rb=a;else return rb};var ab=function(){var b="iui-grid-block";a.options.showStatusIcons&&(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};h.$on("$destroy",function(a){G.s2t();w&&(w.unbind("mouseenter mouseleave mousemove mouseup"),yc());oa&&oa.unbind("mousedown");n.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");
angular.element(g).unbind("dragenter dragover dragend mousemove mousedown mouseup");B&&B.unbind("blur focus keydown mousedown");zc();C&&C.$destroy();v&&v.$destroy()});a.dragIcon=document.createElement("img");a.dragIcon.width=1;n.append(a.getDropMarkWindow());a.dropMark();var ua=function(){Ga&&(e.cancel(Ga),Ga=null)};a.addDropMark=function(){var b;b=n[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),
a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};a.isDropInRange=function(b){b=a.getMousePos(b);var c=n[0].getBoundingClientRect();b.x-=angular.element(g)[0].pageXOffset;b.y-=angular.element(g)[0].pageYOffset;var k=c.top+E,c=c.bottom-O;L&&y&&(c-=y[0].offsetHeight);return b.y<k||b.y>c?!1:!0};var D=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),sb=function(){D&&(D.remove(),D.css("top","-9999999px"),D.css("left","-9999999px"))};a.getCellElemFromRow=
function(b){return b&&(b=a.getElemFromRow(b))?a.getChildElement(b,"cell"):null};a.openEditor=function(b,c){if(b)switch(b.type){case "cell":c||(c=a.getColumnById(b[a.options.cellFields.cid]));if(!c){var k=a.getCellColumnIndex(b),u=a.columnsObj.getList();u&&0<=k&&k<u.length&&(c=u[k])}if(c){var k=a.getCellType(b,a.getColumnRealIndex(c)),u=a.getCellRowIndex(b),t=a.getCellColumnIndex(b);if(u=a.getElemFromCell(u,t,c[a.options.columnFields.fixed]))switch(k){case "checkbox":break;case "combobox":break;case "incell":a.openInCellEditor(u,
b,c);break;case "dropdown":a.openDropDownEditor(u,b,c);break;default:0!=b[a.options.cellFields.allowEdit]&&tb(null,u,0)}}}};a.closeEditor=function(b,c){if(b)switch(b.type){case "cell":if(c||(c=a.getColumnById(b[a.options.cellFields.cid])),c)switch(a.getCellType(b,a.getColumnRealIndex(c))){case "incell":a.closeActiveEditor(b);break;case "dropdown":a.closeActiveEditor(b)}else a.closeActiveEditor()}else a.closeActiveEditor();d=null};var z=null,b=!1,d=null,A=null,f=angular.element('<span class="iui-edit-mark"></span>');
a.openInCellEditor=function(m,q,k){b&&a.closeActiveEditor(q,!0);Eb();if(q&&k&&(d=q,k='<div ng-include="'+k[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-incell-editor"></div>'),z.append(c(k)(h.$parent)),0!=a.callBeforeEdit(q))){m.children().eq(0).append(z);b=!0;A="incell";qb();z.bind("mousedown",function(a){a.stopPropagation()});z.bind("mouseup",function(a){a.stopPropagation()});z.bind("click",function(a){a.stopPropagation()});z.bind("keydown",function(b){switch(b.keyCode){case 27:a.closeActiveEditor(d)}b.stopPropagation()});
z.bind("keypress",function(a){a.stopPropagation()});z.bind("keyup",function(a){a.stopPropagation()});var u=e(function(){var a=p.getPadding(m[0]),b=parseInt(getComputedStyle(m[0]).width,10)-(a.left+a.right),a=parseInt(getComputedStyle(m[0]).height,10)+2;z.css("width",b+"px");z.css("height",a+"px");z.css("top",m[0].offsetTop+"px");h.$apply();z.children&&1==z.children().length&&(b=z.children().eq(0),b.children&&1==b.children().length&&b.children().eq(0).css("height",a+"px"));e.cancel(u)},1)}};a.openDropDownEditor=
function(m,q,k){b&&a.closeActiveEditor(q,!0);Eb();if(q&&k&&(d=q,k='<div ng-include="'+k[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-dropdown-editor"></div>'),z.append(c(k)(h.$parent)),0!=a.callBeforeEdit(q)))var u=e(function(){angular.element(Ra).append(z);z.bind("mousedown",function(a){a.stopPropagation()});z.bind("mouseup",function(a){a.stopPropagation()});z.bind("click",function(a){a.stopPropagation()});b=!0;A="dropdown";var a=m[0].getBoundingClientRect(),
c=angular.element(g)[0].pageXOffset,k=angular.element(g)[0].pageYOffset,q=e(function(){var b=p.getPadding(m[0]),b=parseInt(getComputedStyle(m[0]).width,10)+(b.left+b.right),u=p.getPadding(z[0]),b=b-(u.left+u.right),u=parseInt(getComputedStyle(z[0]).width,10);b<u&&(b=u);u=a.right-(b+3)+c;z.css("top",a.bottom+k+"px");z.css("left",u+"px");z.css("width",b+"px");h.$apply();e.cancel(q)},1);e.cancel(u)},1)};a.closeActiveEditor=function(c,q){b=!1;Eb();z&&z.remove();A=d=null;q||a.callAfterEdit(c)};var Eb=
function(){z&&z.unbind("click keydown keypress keyup mousedown mouseup")},Fb=function(a,b){a&&(f.addClass("iui-edit-mark iui-edit-mark-"+b),a.append(f),f.css("left",a[0].offsetLeft+a[0].offsetWidth-f[0].offsetWidth-2+"px"),f.css("top",a[0].offsetTop+(a[0].offsetHeight-f[0].offsetHeight)/2+"px"))},qb=function(){f&&("dropdown"!=A||"dropdown"==A&&!b)&&(f.removeAttr("class"),f.remove())},ac=null,Fa=angular.element('<div class="iui-dropdown-mark"><span></span></div>'),bc=function(a,b){!a||bb&&!b||(a.append(Fa),
Fa.css("top",a[0].offsetTop+"px"),Fa.css("left",a[0].offsetLeft+a[0].offsetWidth-Fa[0].offsetWidth+"px"),Fa.css("height",getComputedStyle(a[0]).height))},Ha=function(a){!Fa||bb&&!a||Fa.remove()};a.getCellType=function(b,c){var k=null,u="label";b&&(k=a.getColumnById(b[a.options.cellFields.cid]));!k&&0<=c&&c<a.columnList.length&&(k=a.columnList[c]);k&&(u=k[a.options.columnFields.editorType]);return u};var Ra=p.getBodyElem(n[0]),ub=p.getUniqueId(4),fa=null,bb=!1,vb=0,cd=function(b,q,k){if(Ra&&b.items&&
0<b.items.length){b=p.getUniqueId(4);var u=c('<iui-list name="'+b+'" style="position:absolute;top:-99px;height:100px" items="data['+q+"].column."+a.options.columnFields.editorSettings+'.items"></iui-list>')(C);angular.element(Ra).append(u);na.updateLayout(b);var t=e(function(){if(0<u.children().length){var a=u.children().eq(0);0<a.children().length&&(vb=angular.element(a.children().eq(0))[0].offsetHeight,k&&(k.avgItemHeight=vb))}u.remove();e.cancel(t)},1)}},Sa=null,Gb=function(b,q,k,u){var t=a.getCell(k,
u);if(t!=ac&&(ac=t,fa&&fa.remove(),Sa&&Sa.$destroy(),Ra)){Sa=h.$new();Sa.data=a.columnList[u];d=t;var ma='<iui-list name="'+ub+'" style="position:absolute;"',ma=ma+(' items="data.'+a.options.columnFields.editorSettings+'.items"'),ma=ma+(' item-icon="data.'+a.options.columnFields.editorSettings+'.itemIcon"'),ma=ma+(' show-icons="data.'+a.options.columnFields.editorSettings+'.showIcons"'),ma=ma+(' checkbox-settings="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings"'),ma=ma+(' show-check-boxes="data.'+
a.options.columnFields.editorSettings+'.checkBoxSettings.showCheckBoxes"');fa=c(ma+(' nav-selection="false" before-select="onCellValueChanging(e, '+k+", "+u+')" after-select="onCellValueChanged(e, '+k+", "+u+')"></iui-list>'))(Sa);vb=0;cb&&u<cb.length&&(vb=cb[u].avgItemHeight);var f=e(function(){angular.element(Ra).append(fa);var c=b[0].getBoundingClientRect(),u=angular.element(g)[0].pageXOffset,k=angular.element(g)[0].pageYOffset,k=c.bottom+k-1,c=c.left+u,u=b.children().eq(0),d=p.getPadding(u[0]),
u=parseInt(getComputedStyle(u[0]).width,10)+(d.left+d.right),d=p.getPadding(fa[0]),u=u-(d.left+d.right);void 0!=q.dropDownWidth&&u<q.dropDownWidth&&(u=q.dropDownWidth);d=void 0!=q.dropDownHeight?q.dropDownHeight:100;void 0!=q.maxDropDownItems&&(d=vb*q.maxDropDownItems);fa.css("top",k+"px");fa.css("left",c+"px");fa.css("width",u+"px");fa.css("height",d+"px");fa.css("z-index","999");t&&t[a.options.cellFields.value]&&na.selectedItem(ub,t[a.options.cellFields.value]);na.updateLayout(ub);var ma=e(function(){if(t&&
t[a.options.cellFields.value]){na.ensureVisible(ub,t[a.options.cellFields.value]);var b=e(function(){na.focus(ub,t[a.options.cellFields.value]);e.cancel(b)},1)}e.cancel(ma)},10);Fa&&(Ha(!0),bc(b,!0));bb=!0;dd();e.cancel(f)},1)}};a.removeDropDownList=function(a){fa&&(ac=null,fa.remove(),bb=!1,a||Ha(),fa.unbind("keydown"));Sa&&Sa.$destroy();d=null};var dd=function(){fa.bind("keydown",function(b){switch(b.keyCode){case 27:a.removeDropDownList(),Ha()}})},tb=function(b,c,k){a.options.labelEdit&&(void 0===
k&&(k=500),Aa=e(function(){if(Aa)var a=e(function(){Hb(b,c,!0);e.cancel(a)},k);e.cancel(Aa)},k/3))},Ib=function(){Aa&&(e.cancel(Aa),Aa=null)},db=null,eb=null,Hb=function(b,c,k){if(a.dragDropStatus())g=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown mousedown"),B.remove(),eb=db=null;else{var u=a.getRowFromChildElem(c);if(u){var t=a.getRowCurrentIndex(u),d=a.getIndexFromElem(c),f=a.getCellObject(t,d),g="",g=c.children().eq(0);if(f)if(k){if(0!=a.callBeforeLabelEdit(f)){db=u;eb=f;a.labelEditStatus(!0);
B.unbind("blur focus keydown mousedown");b=parseInt(getComputedStyle(c[0]).width,10)-4;k=parseInt(getComputedStyle(c[0]).height,10)-3;B.css("top",c[0].offsetTop+"px");B.css("left",c[0].offsetLeft+"px");B.css("width",b+"px");B.css("height",k+"px");g.append(B);B[0].value=f[a.options.cellFields.text];B.bind("keydown",function(b){switch(b.keyCode){case 13:f[a.options.cellFields.text]=B[0].value?B[0].value:"null";Hb(b,c,!1);break;case 27:Hb(b,c,!1)}b.stopPropagation()});B.bind("focus",function(b){var c=
angular.element(this);a.callGotFocus(b,db,eb,!0,c[0].value)});B.bind("blur",function(a){Hb(a)});B.bind("mousedown",function(a){a.stopPropagation()});var h=e(function(){B[0].focus();B[0].select();e.cancel(h)},10)}}else g=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown"),B.remove(),a.updateView(),a.updateFocus(t,d),a.callAfterLabelEdit(f),a.callLostFocus(b,u,f,!0,g),eb=db=null}else g=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown mousedown"),B.remove(),a.callAfterLabelEdit(),
a.updateView(),a.callLostFocus(b,db,eb,!0,g),eb=db=null}};n.bind("mousemove",function(b){if(0===b.button&&ba&&x){a.getColumnCurrentIndex(x);var c=a.getMousePos(b),k=c.y+16,c=c.x+20;W.empty();W.append("<span>"+x[a.options.columnFields.headerText]+"</span>");W.css("top",k+"px");W.css("left",c+"px");W.css("display","block");Bc();b.stopPropagation()}});var Ec=function(){for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var k=0;k<c.length;k++){var u=angular.element(c[k]);Cc(u);for(var u=
u.find("td"),t=0;t<u.length;t++){var e=angular.element(u[t]),d=a.getElement(e,"expandbox");d&&d.unbind("click touchend");Dc(e)}}b++;c=1==b?"left":"right"}},zc=function(){Eb();for(var b=0,c="none";3>b;){var k=a.getRowElems(c);if(k&&0<k.length)for(var u=0;u<k.length;u++){var t=angular.element(k[u]);Cc(t);for(var t=t.find("td"),e=0;e<t.length;e++){var d=angular.element(t[e]),f=a.getElement(d,"expandbox");f&&f.unbind("click touchend");Dc(d)}}if((k=a.getHeaderElem(c))&&0<k.length)for(u=0;u<k.length;u++)for(t=
angular.element(k[u]),t=t.find("td"),e=0;e<t.length;e++)(d=angular.element(t[e]))&&(c=a.getChildElement(d,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&c.unbind("mousedown");b++;c=1==b?"left":"right"}},hd=function(){Ec();for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var k=null,u=c.length-1,t=0;t<=u;t++){k=angular.element(c[t]);ed(k);for(var e=k.find("td"),d=0;d<e.length;d++){var f=angular.element(e[d]);fd(a.getElement(f,"expandbox"));gd(f,a.getRowFromElem(k),
d)}}b++;c=1==b?"left":"right"}},ba=!1,x=null,Ta=-1,Jb=function(b,c){if(b){var k=a.getColumnCurrentIndex(b),u=a.getColumnWidth(b);return a.isColumnWithFixedWidth(k)||10<c.x&&c.x<u-10}return!1},ec=function(b){b=b.find("td");for(var c=0;c<b.length;c++)currentElem=angular.element(b[c]),currentElem.bind("click",function(b){if(1===b.which){var c=p.getClientMousePos(b,this),m=a.getColumnFromElem(this);m&&Jb(m,c)&&a.callColumnClick(m,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("dblclick",function(b){b.preventDefault();
if(1===b.which){var c=p.getClientMousePos(b,this),m=a.getColumnFromElem(this);m&&Jb(m,c)&&a.callColumnDblClick(m,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("mouseenter",function(b){if(!Q&&!ra){var c=a.getColumnFromElem(this);c&&(a.hoverColumn=c,a.refresh(c),a.callColumnHover(c));if(1===b.which&&ba&&x&&a.hoverColumn&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&ga&&(ga.remove(),a.hoverColumn!=x)){var m=angular.element(this);m.append(ga);b=parseInt(getComputedStyle(m[0]).height,
10);c=parseInt(getComputedStyle(ga[0]).height,10);m=p.getPadding(m[0]);ga.css("top",(b+m.top+m.bottom-c)/2+"px")}}}),currentElem.bind("mouseleave",function(b){Q||ra||(a.hoverColumn=null,(b=a.getColumnFromElem(this))&&a.refresh(b),ga&&ga.remove(),Q||n.css("cursor","default"))}),currentElem.bind("mousemove",function(b){var c=angular.element(this);if(1===b.which&&ba&&x&&a.hoverColumn&&a.hoverColumn!=x&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&x[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed])c=
parseInt(getComputedStyle(c[0]).width,10),ga.empty(),Ta=-1,b.offsetX>c/2?(Ta=2,ga.append('<span class="iui-grid-column-reorder-mark-right"></span>'),ga.css("left","auto"),ga.css("right","0")):(Ta=1,ga.append('<span class="iui-grid-column-reorder-mark-left"></span>'),ga.css("left","0"),ga.css("right","auto"));else{b=p.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10),m=a.getColumnWidth(a.columnList[c]),q=10;a.isFilteringAllowed(a.columnList[c])&&(q=0);10>b.x&&!a.isColumnWithFixedWidth(c-
1)&&Fc(c,"left")?(n.css("cursor","ew-resize"),Ca="left"):b.x>m-q&&!a.isColumnWithFixedWidth(c)&&Fc(c,"right")?(n.css("cursor","ew-resize"),Ca="right"):Q||(n.css("cursor","default"),Ca="none")}}),currentElem.bind("mouseup",function(b){if(1===b.which&&ba&&x&&a.hoverColumn&&a.hoverColumn!=x&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&x[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]&&0!=a.callColumnPosChanging(x,a.hoverColumn)){b=a.columnList[0];0<=a.options.expandColIndex&&
a.options.expandColIndex<a.columnList.length&&(b=a.columnList[a.options.expandColIndex]);var c=a.getColumnCurrentIndex(x),c=a.getColumnRealIndex(c),m=a.getColumnCurrentIndex(a.hoverColumn),m=a.getColumnRealIndex(m);c!=m&&(c<m?1==Ta&&m--:c>m&&2==Ta&&m++,a.columnsObj.moveObject(c,m),a.updateColumnList(),b=a.getColumnCurrentIndex(b),b!=a.options.expandColIndex?(a.options.expandColIndex=b,a.updateLayout()):a.updateView(),a.callColumnPosChanged(x,a.hoverColumn))}x=null;Ta=-1;Q=ba=!1;n.css("cursor","default")}),
currentElem.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();p.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10);if(0===b.button&&!Q){var m=c,q="none";0<=c&&c<a.columnList.length&&(q=a.columnList[c][a.options.columnFields.fixed]);switch(Ca){case "left":"right"==q?m=c:(c=cc(m-1,q))?(m=a.getColumnCurrentIndex(c),0<=m&&m<a.columnList.length&&(a.columnList[m][a.options.columnFields.fixed]!=q?(m=-1,Q=!1):Q=!0)):Q=!1;0<=m&&(Q=!0);break;case "right":"right"==
q?(c=dc(m+1,q))?(m=a.getColumnCurrentIndex(c),0<=m&&m<a.columnList.length&&(a.columnList[m][a.options.columnFields.fixed]!=q?(m=-1,Q=!1):Q=!0)):Q=!1:(m=c,Q=!0)}!a.isColumnWithFixedWidth(m)&&Q?a.setColumnResizingParams(m,Ca,a.getMousePos(b).x):Q=!1}if(!Q&&(m=a.getColumnFromChildElem(this)))switch(q=p.getClientMousePos(b,this),Jb(m,q)&&a.columnSelection(m),b.which){case 1:a.options.allowColumnReorder&&0!=m[a.options.columnFields.allowDrag]&&0==ba&&0!=m[a.options.columnFields.allowGrouping]&&(x=m,a.getMousePos(b),
ba=!0,(m=p.getBodyElem(n[0]))&&angular.element(m).append(W));break;case 3:Jb(m,q)&&a.callColumnRightClick(m,a.getMousePos(b))}b.stopPropagation()}),function(b){b&&(b=a.getChildElement(b,"column-header-cell"))&&(b=a.getContentElement(b,"filter-button"))&&b.bind("mousedown",function(a){1==a.which&&id(this);a.stopPropagation()})}(currentElem)},oa=null,id=function(b){a.closeFilterWindow();var q=a.getColumnFromChildElem(b);if(q){var k=angular.element(b),u=k.parent().parent();if(Ra){b='<div ng-include="'+
q[a.options.columnFields.filterTemplate]+'"></div>';oa=angular.element('<div class="iui-filter-window"></div>');oa.append(c(b)(h.$parent));var t=e(function(){angular.element(Ra).append(oa);oa.bind("mousedown",function(a){a.stopPropagation()});k[0].getBoundingClientRect();var a=u[0].getBoundingClientRect(),b=angular.element(g)[0].pageXOffset,c=angular.element(g)[0].pageYOffset,m=e(function(){var u=a.bottom+c,t=a.right-(parseInt(getComputedStyle(oa[0]).width,10)+3)+b;oa.css("top",u+"px");oa.css("left",
t+"px");e.cancel(m)},1);e.cancel(t)},1)}}};a.closeFilterWindow=function(){oa&&(oa.unbind("mousedown"),oa.remove())};var Cc=function(a){a&&a.unbind("blur dragover dragend focus keydown keyup keypress mousedown mouseenter mouseleave")},ed=function(b){b&&(b.bind("dragover",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),m=n[0].getBoundingClientRect();c.x-=angular.element(g)[0].pageXOffset;c.y-=angular.element(g)[0].pageYOffset;
var t=m.top+E+25,m=m.bottom-O-25;L&&y&&(m-=y[0].offsetHeight);c.y<t?Kb(!1):c.y>m?Kb(!0):fb()}else fb();b.stopPropagation()}}),b.bind("dragend",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),a.dropMark(),r.getData().source||r.clearData())}),b.bind("mouseenter",function(b){if(!ra){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&!ba&&(a.hoverRow=c,a.refresh(c),a.callRowHover(b,c),a.options.hoverSelection&&(Ba=e(function(){Ba&&a.rowSelection(c,
b.shiftKey,b.ctrlKey)},500)))}}),b.bind("mouseleave",function(b){ra||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&a.refresh(b),Ba&&(e.cancel(Ba),Ba=null))}),b.bind("keydown",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){var m=!0;a.callKeyDown(b,c);var t=a.getRowCurrentIndex(c);switch(b.keyCode){case 9:Gc(b,c,t);break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:m=!1;break;case 33:Hc(b,t);break;case 34:Ic(b,
t);break;case 35:Jc(b,t);break;case 36:Kc(b,t);break;case 37:Lc(b,c,t);break;case 32:b.preventDefault();fc(void 0,void 0);a.rowSelection(c,b.shiftKey,b.ctrlKey,c.selected);h.$apply();break;case 38:gc(b,t);break;case 39:Mc(b,c,t);break;case 40:hc(b,t);break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}m&&b.stopPropagation()}}),b.bind("keyup",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);
break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c)}}),b.bind("keypress",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callKeyPress(b,c)}),b.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor()}),b.bind("focus",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)?a.callGotFocus(b,c):a.updateFocus()}),b.bind("blur",function(b){var c=a.getRowFromElem(this);
c&&a.isRowEnabled(c)&&a.callLostFocus(b,c)}))},fd=function(b){b&&(b.bind("click",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}))},Lb={x:0,y:0},gb={x:0,y:0},hb=!1,ic=!1,Da=null,
Nc=function(){return{x:angular.element(g)[0].pageXOffset,y:angular.element(g)[0].pageYOffset}},ib=function(a){var b=Nc();return{x:a.x-b.x,y:a.y-b.y}},gd=function(c,q,k){c&&(c.bind("dragstart",function(b){if(a.labelEditStatus())b.preventDefault();else{r.clearData();var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c))if(Ib(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():
"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():""));b={source:c,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":b.source=a.options.selectedRows;break;case "multi-extended":b.source=a.options.selectedRows}r.setData(b)}else b.dataTransfer?b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&
(b.originalEvent.dataTransfer.effectAllowed="none")}}),c.bind("dragover",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var m=angular.element(this);b.preventDefault();var k=!0;b.dataTransfer?k="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(k="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(k&&(c=a.getRowFromChildElem(m))){var k=m[0].getBoundingClientRect(),e=angular.element(g)[0].pageXOffset,q=angular.element(g)[0].pageYOffset,
d=a.getMousePos(b);d.x-=k.left+e;d.y-=k.top+q;m=r.getDropPos(d,{x:0,y:0,width:m[0].offsetWidth,height:m[0].offsetHeight},!0);e=r.getData();k=a.isDropAllowed(e.source,c,m);q={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),targetRow:c,isDropAllowed:k,dropPos:m,mousePos:a.getMousePos(b)};q=a.callDragOver(q);if(k&&!1!==q){q=a.getMousePos(b);b=q.y+16;q=q.x+20;d=a.getDropMarkWindow();d.empty();var f="";switch(m){case 1:f="iui-drop-marker-move-up";
break;case 2:f="iui-drop-marker-move-down"}d.append("<span class='"+f+"'></span><span class='iui-drop-marker-title'>"+c[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:q});a.dropMark(k);r.setData({source:e.source,sourceList:e.sourceList,target:c,dropPos:m})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark()}}}),c.bind("drop",function(b){var c=a.getRowFromChildElem(this);
if(c&&a.isRowEnabled(c)){var m=angular.element(this);b.preventDefault();ua();a.dropMark();c=!0;b.dataTransfer?c="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(c="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(c){var k=a.getRowFromChildElem(m);if(k){var m=r.getData(),e=m.source;e||(e=a.getDnDSource(b));if(c=a.isDropAllowed(e,k,m.dropPos))a.toggle(k,!0),e&&(c={event:b,sourceCtrl:m.sourceCtrl?m.sourceCtrl.getGridName():"",dragRow:e,targetCtrl:a.getGridName(),
targetRow:k,isDropAllowed:c,dropPos:m.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(c)&&(a.drop(m),h.$$phase||h.$apply()))}}r.clearData();b.stopPropagation()}}),c.bind("dragenter",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){b.preventDefault();if(a.options.autoExpand)var m=e(function(){Ga||(Ga=e(function(){Ga&&a.toggle(c,!0)},750));e.cancel(m)},1);var k=r.getData();k.source||(k.source=a.getDnDSource(b));k={event:b,sourceCtrl:k.sourceCtrl?k.sourceCtrl.getGridName():
"",dragRow:k.source,targetCtrl:a.getGridName(),targetRow:k.target,mousePos:a.getMousePos(b)};a.callDragEnter(k);b.stopPropagation()}}),c.bind("dragleave",function(b){a.hoverRow=null;var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),ua(),c=r.getData(),c.source||(c.source=a.getDnDSource(b)),c={event:b,sourceCtrl:c.sourceCtrl?c.sourceCtrl.getGridName():"",dragRow:c.source,targetCtrl:a.getGridName(),targetRow:c.target,mousePos:a.getMousePos(b)},a.callDragLeave(c),b.stopPropagation())}),
c.bind("touchstart",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)&&(c.preventDefault(),(m=a.getTouchData(c))&&0<m.length)){ic=!0;var k=e(function(){ic=!1;e.cancel(k)},750);Lb=ib({x:m[0].pageX,y:m[0].pageY});a.closeFilterWindow();m=Lb;if((m=a.getRowAt(m.x,m.y))&&a.isRowEnabled(m)){var q=angular.element(this);a.mouseButtonStatus(!0);Da=m;var f=a.getRowCurrentIndex(m),g=parseInt(a.getIndexFromElem(this),10),h=a.getCell(f,g),l=a.getCellType(h,g),n=null,p=a.options.editorSettings;
q[0].focus();a.updateFocus(f,g);h&&(n=a.getColumnById(h[a.options.cellFields.cid]));!n&&0<=g&&g<a.columnList.length&&(n=a.columnList[g]);var r="click"==a.options.editorSettings.activate;n&&n[a.options.columnFields.editorSettings]&&(p=n[a.options.columnFields.editorSettings],r=void 0!=p.activate?"click"==p.activate:r);h&&h!=d?a.closeEditor(d):a.closeEditor();switch(l){case "checkbox":break;case "combobox":a.rowSelection(m,c.shiftKey,c.ctrlKey);h&&0!=h[a.options.cellFields.allowEdit]&&n&&r?Gb(angular.element(this),
p,f,g):a.removeDropDownList();break;case "incell":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openInCellEditor(q,h,n);break;case "dropdown":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openDropDownEditor(q,h,n);break;default:a.rowSelection(m,c.shiftKey,c.ctrlKey),a.removeDropDownList(),h&&0!=h[a.options.cellFields.allowEdit]&&r&&tb(c,angular.element(this))}}}}),c.bind("touchmove",function(b){var c,m,k=a.getRowFromChildElem(this);
if(k&&a.isRowEnabled(k)&&(k=a.getTouchData(b))&&0<k.length){gb=ib({x:k[0].pageX,y:k[0].pageY});var k=Math.abs(gb.x-Lb.x),e=Math.abs(gb.y-Lb.y),q=n[0].getBoundingClientRect();if(r.hitTest(gb.x,gb.y,q)){if(b.preventDefault(),D&&D.css("display","block"),!ic)if(!hb&&(2<k||2<e)&&Da&&a.isRowEnabled(Da))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{hb=!0;r.clearData();if((k=a.getTouchData(b))&&0<k.length&&(ib({x:k[0].pageX,y:k[0].pageY}),Da&&a.isRowEnabled(Da)&&(Ib(),a.isDragAllowed(Da)))){a.dragDropStatus(!0);
a.addDropMark();k={source:Da,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":k.source=a.options.selectedRows;break;case "multi-extended":k.source=a.options.selectedRows}r.setData(k);if(k=a.getCellElemFromRow(Da))if(k=a.getContentElement(k))D.empty(),D.append(k.clone()),D.css("display","none"),n.append(D)}b.stopPropagation()}else if(hb&&(angular.element(this),b.preventDefault(),(e=a.getTouchData(b))&&0<e.length)){var k=Nc(),d=ib({x:e[0].pageX,y:e[0].pageY});
if(e=a.getRowAt(d.x,d.y)){var f=a.getCellElemFromRow(e);if(f){var q=f[0].getBoundingClientRect(),f=r.getDropPos({x:d.x-q.left,y:d.y-q.top},{x:0,y:0,width:f[0].offsetWidth,height:f[0].offsetHeight},!0),q=r.getData(),g=a.isDropAllowed(q.source,e,f);b={event:b,sourceCtrl:q.sourceCtrl?q.sourceCtrl.getGridName():"",dragRow:q.source,targetCtrl:a.getGridName(),targetRow:e,isDropAllowed:g,dropPos:f,mousePos:d};m=n[0].getBoundingClientRect();c=d.x-m.left;m=d.y-m.top;D.css("top",m-16+"px");D.css("left",c+"px");
D.css("display","block");b=a.callDragOver(b);if(g&&0!=b){b=d.y+k.y+16;k=d.x+k.x+20;d=a.getDropMarkWindow();d.empty();c="iui-drop-marker-move-in";switch(f){case 1:c="iui-drop-marker-move-up";break;case 2:c="iui-drop-marker-move-down"}d.append("<span class='"+c+"'></span><span class='iui-drop-marker-title'>"+e[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:k});a.dropMark(g);r.setData({source:q.source,sourceList:q.sourceList,target:e,dropPos:f})}else a.dropMark(),
D&&D.css("display","none")}}else q=n[0].getBoundingClientRect(),e=q.top+E,q=q.bottom-O,L&&y&&(q-=y[0].offsetHeight),!a.options.allowDrop||d.y<e||d.y>q?(a.dropMark(),D&&D.css("display","none")):(m=n[0].getBoundingClientRect(),c=d.x-m.left,m=d.y-m.top,D.css("top",m-16+"px"),D.css("left",c+"px"),D.css("display","block"),e=r.getData(),q={source:e.source,sourceCtrl:e.sourceCtrl,target:null,dropPos:-1},r.setData(q),b={event:b,sourceCtrl:e.sourceCtrl?e.sourceCtrl.getGridName():"",dragRow:e.source,targetCtrl:a.getGridName(),
targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:d},b=a.callDragOver(b),0==b?a.dropMark():(b=d.y+k.y+16,k=d.x+k.x+20,d=a.getDropMarkWindow(),d.empty(),d.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(h.name?h.name:"Grid")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:k}),a.dropMark(!0)))}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),D&&D.css("display","none")}}),c.bind("touchend",function(b){var c=
a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){c=!1;if((c=a.getTouchData(b))&&0<c.length){var c=ib({x:c[0].pageX,y:c[0].pageY}),m=n[0].getBoundingClientRect();if(r.hitTest(c.x,c.y,m))if(hb){angular.element(this);b.preventDefault();ua();a.dropMark();sb();if((c=a.getTouchData(b))&&0<c.length){var c=ib({x:c[0].pageX,y:c[0].pageY}),k=a.getRowAt(c.x,c.y);if(k){var m=r.getData(),e=m.source,q=a.isDropAllowed(e,k,m.dropPos);q&&(a.toggle(k,!0),e&&(c={event:b,sourceCtrl:m.sourceCtrl?m.sourceCtrl.getGridName():
"",dragRow:e,targetCtrl:a.getGridName(),targetRow:k,isDropAllowed:q,dropPos:m.dropPos,mousePos:c},c=a.callDragDrop(c),!1!==c&&(a.drop(m),h.$$phase||h.$apply())))}else a.dropMark(),k=n[0].getBoundingClientRect(),m=k.top+E,k=k.bottom-O,L&&y&&(k-=y[0].offsetHeight),c.y>=m&&c.y<=k&&(m=r.getData(),m.source&&(c={event:b,sourceCtrl:m.sourceCtrl?m.sourceCtrl.getGridName():"",dragRow:m.source,targetCtrl:a.getGridName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:c},c=a.callDragDrop(c),
!1!==c&&(a.drop(m),h.$$phase||h.$apply())))}r.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(c=a.getRowFromChildElem(this))&&a.isRowEnabled(c)&&a.updateSelection(b,c,b.shiftKey),Ib()}c=hb;a.removeDropMark();sb();gb={x:0,y:0};hb=!1;Da=null;c&&b.stopPropagation()}}),c.bind("dblclick",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var k=angular.element(this);c.preventDefault();if(1===c.which){var e=a.getRowCurrentIndex(m),q=parseInt(a.getIndexFromElem(this),
10),d=a.getCell(e,q),f=a.getCellType(d,q),g=null,h=a.options.editorSettings;d&&(g=a.getColumnById(d[a.options.cellFields.cid]));!g&&0<=q&&q<a.columnList.length&&(g=a.columnList[q]);var l="dblclick"==a.options.editorSettings.activate;g&&g[a.options.columnFields.editorSettings]&&(h=g[a.options.columnFields.editorSettings],l=void 0!=h.activate?"dblclick"==h.activate:l);switch(f){case "checkbox":break;case "combobox":d&&0!=d[a.options.cellFields.allowEdit]&&g&&l?Gb(angular.element(this),h,e,q):a.removeDropDownList();
break;case "incell":!b&&d&&0!=d[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(k,d,g);break;case "dropdown":!b&&d&&0!=d[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(k,d,g);break;default:a.removeDropDownList(),d&&0!=d[a.options.cellFields.allowEdit]&&l&&tb(c,angular.element(this),0)}0!=a.callRowDblClick(m,a.getMousePos(c))&&"checkbox"!=f&&"checkbox"!=f&&d&&!l&&(a.toggle(m),a.updateFocus(e,q))}c.stopPropagation()}}),c.bind("mouseenter",function(c){if(!ra){var m=a.getRowFromChildElem(this);
if(m&&a.isRowEnabled(m)&&!ba){var k=a.getRowCurrentIndex(m),e=parseInt(a.getIndexFromElem(this),10);if(k=a.getCell(k,e))if(a.hoverCell=k,a.refresh(m),a.callCellHover(c,k),c=angular.element(this),k&&0!=k[a.options.cellFields.allowEdit])switch(e=a.getCellType(k,e),e){case "combobox":bb||bc(c);break;case "incell":b&&k==d||Fb(c,e);break;case "dropdown":b&&k!=d||Fb(c,e);break;default:Ha(),qb()}else Ha()}}}),c.bind("mouseleave",function(b){if(!ra&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&a.isRowEnabled(b))){b=
a.getRowCurrentIndex(b);var c=parseInt(a.getIndexFromElem(this),10);a.getCell(b,c)&&(Ha(),qb())}}),c.bind("keydown",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var k=!0,e=angular.element(this);a.callKeyDown(c,m);var q=a.getRowCurrentIndex(m),d=parseInt(a.getIndexFromElem(this),10),f=a.getCell(q,d),g=a.getCellType(f,d),l=a.getColumnById(f[a.options.cellFields.cid]);!l&&0<=d&&d<a.columnList.length&&(l=a.columnList[d]);switch(c.keyCode){case 9:Gc(c,m,q,d);break;case 13:switch(g){case "checkbox":fc(f,
d);break;case "combobox":f&&0!=f[a.options.cellFields.allowEdit]?l&&Gb(angular.element(this),l[a.options.columnFields.editorSettings],q,d):a.removeDropDownList();break;case "incell":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openInCellEditor(e,f,l);break;case "dropdown":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openDropDownEditor(e,f,l);break;default:f&&0!=f[a.options.cellFields.allowEdit]&&tb(c,angular.element(this),0)}break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");
break;case 27:k=!1;break;case 33:Hc(c,q,d);break;case 34:Ic(c,q,d);break;case 35:Jc(c,q,d);break;case 36:Kc(c,q,d);break;case 37:Lc(c,m,q,d);break;case 32:c.preventDefault();fc(f,d);a.rowSelection(m,c.shiftKey,c.ctrlKey,m.selected);h.$apply();break;case 38:gc(c,q,d);break;case 39:Mc(c,m,q,d);break;case 40:hc(c,q,d);break;default:(c.ctrlKey||c.metaKey)&&a.updateSelectionStatus("ctrl"),c.shiftKey&&a.updateSelectionStatus("shift")}k&&c.stopPropagation()}}),c.bind("keyup",function(b){var c=a.getRowFromChildElem(this);
if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c);b.stopPropagation()}}),c.bind("keypress",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.callKeyPress(b,c),b.stopPropagation())}),c.bind("click",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){if(1===b.which){var m=a.getRowCurrentIndex(c),k=
parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,k);a.callCellClick(b,c,m,a.getMousePos(b));a.callRowClick(b,c,a.getMousePos(b))}b.stopPropagation()}}),c.bind("mousedown",function(c){a.closeFilterWindow();var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var k=angular.element(this);a.mouseButtonStatus(!0);switch(c.which){case 1:var e=a.getRowCurrentIndex(m),q=parseInt(a.getIndexFromElem(this),10),f=a.getCell(e,q),g=a.getCellType(f,q),h=null,l=a.options.editorSettings;f&&(h=a.getColumnById(f[a.options.cellFields.cid]));
!h&&0<=q&&q<a.columnList.length&&(h=a.columnList[q]);var n="click"==a.options.editorSettings.activate;h&&h[a.options.columnFields.editorSettings]&&(l=h[a.options.columnFields.editorSettings],n=void 0!=l.activate?"click"==l.activate:n);f&&f!=d?a.closeEditor(d):a.closeEditor();switch(g){case "checkbox":break;case "combobox":a.rowSelection(m,c.shiftKey,c.ctrlKey);f&&0!=f[a.options.cellFields.allowEdit]&&h&&n?Gb(angular.element(this),l,e,q):a.removeDropDownList();break;case "dropdown":a.rowSelection(m,
c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openDropDownEditor(k,f,h);break;case "incell":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openInCellEditor(k,f,h);break;default:if("image"==g?0!=l.allowSelection:1)a.rowSelection(m,c.shiftKey,c.ctrlKey),a.removeDropDownList(),f&&0!=f[a.options.cellFields.allowEdit]&&n&&tb(c,angular.element(this))}break;case 3:a.rowSelection(m,c.shiftKey,c.ctrlKey),a.callRowRightClick(m,a.getMousePos(c))}c.stopPropagation()}}),
c.bind("mouseup",function(b){a.mouseButtonStatus(!1);if(1==b.which){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var m=a.getRowCurrentIndex(c),k=parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,k),e=a.getCellType(m,k),q=null,d=a.options.editorSettings;m&&(q=a.getColumnById(m[a.options.cellFields.cid]));!q&&0<=k&&k<a.columnList.length&&(q=a.columnList[k]);q&&q[a.options.columnFields.editorSettings]&&(d=q[a.options.columnFields.editorSettings]);("image"==e?0!=d.allowSelection:1)&&a.updateSelection(b,
c,b.shiftKey)}Ib()}}),c.bind("focus",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var k=a.getRowCurrentIndex(m),q=parseInt(a.getIndexFromElem(this),10),k=a.getCell(k,q);a.callGotFocus(c,m,k);if(k&&0!=k[a.options.cellFields.allowEdit])switch(c=angular.element(this),q=a.getCellType(k,q),q){case "combobox":bb||bc(c);break;case "incell":b||Fb(c,q);break;case "dropdown":b||Fb(c,q);break;default:Ha()}else Ha()}}),c.bind("blur",function(b){var c=a.getRowFromChildElem(this);if(c&&
a.isRowEnabled(c)){var m=a.getRowCurrentIndex(c),k=parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,k);a.callLostFocus(b,c,m)}}))},Dc=function(a){a&&a.unbind("blur click dragstart dragover drop dragenter dragleave dblclick focus keydown keypress keyup mouseenter mouseleave mousemove mousedown mouseup touchstart touchmove touchend")};a.getTopRow=function(){return a.isRowIndexInRange(H-1)?a.currentList[H]:0<a.currentList.length?a.currentList[0]:null};a.getFooterElem=function(a){switch(a){case "left":return pa;
case "right":return ca}return va};a.getHeaderElem=function(a){switch(a){case "left":return da;case "right":return R}return ha};a.getRowElems=function(a){switch(a){case "left":return Ia?Ia.find("tr"):null;case "right":return Ja?Ja.find("tr"):null}return ia?ia.find("tr"):null};var Gc=function(b,c,k,e){var d=a.currentList.length;0<d&&(b.shiftKey?p.isEqual(c[a.options.rowFields.id],a.currentList[0][a.options.rowFields.id])||gc(b,k,e):p.isEqual(c[a.options.rowFields.id],a.currentList[d-1][a.options.rowFields.id])||
hc(b,k,e))},hc=function(b,c,k){b.preventDefault();focusDelayTime=0;var d=c,t=H+ja-2,t=t<a.currentList.length-1?t:a.currentList.length-1;d>=t&&M&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(n[0].clientHeight/4)}),focusDelayTime=1);if(d=a.getNextRow(d)){c=a.getRowCurrentIndex(d);c>t&&M&&(a.ensureVisible(d,"bottom"),focusDelayTime=100);a.rowSelection(d,b.shiftKey,b.ctrlKey);var f=e(function(){a.updateFocus(c,k);e.cancel(f)},focusDelayTime)}},gc=function(b,c,k){b.preventDefault();focusDelayTime=
0;var d=H,d=0<d?d:0;c==d&&M&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(n[0].clientHeight/4)}),focusDelayTime=1);var t=a.getPrevRow(c);if(t){c=a.getRowCurrentIndex(t);c<d&&M&&(a.ensureVisible(t,"bottom"),focusDelayTime=100);a.rowSelection(t,b.shiftKey,b.ctrlKey);var f=e(function(){a.updateFocus(c,k);e.cancel(f)},focusDelayTime)}},Mc=function(b,c,k,d){b.preventDefault();if((void 0===d||0<=d&&d==a.options.expandColIndex)&&!a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,
!0),a.updateFocus(k,d);else if(0<=d){focusDelayTime=0;var t=d+1;b=a.columnList.length-1;t===b&&(focusDelayTime=1);if(0<=t&&t<=b)var f=e(function(){a.updateFocus(k,t);e.cancel(f)},focusDelayTime)}},Lc=function(b,c,k,d){b.preventDefault();if((void 0===d||0<=d&&d==a.options.expandColIndex)&&a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!1),a.updateFocus(k,d);else if(0<=d){focusDelayTime=0;var t=1<d?d-1:0;if(0<=t)var f=e(function(){a.updateFocus(k,t);
e.cancel(f)},focusDelayTime)}},Hc=function(b,c,k){b.preventDefault();var d=c-ja,d=0<d?d:0;if(d!==c){focusDelayTime=1;var t=a.getPrevRow(d+1);if(t){a.scrollTo(t);a.rowSelection(t,b.shiftKey,b.ctrlKey);h.$apply();var f=e(function(){a.updateFocus(a.getRowCurrentIndex(t),k);e.cancel(f)},focusDelayTime)}}},Ic=function(b,c,k){b.preventDefault();var d=c+ja;a.options.showHeader&&d--;a.options.showFooter&&d--;d=d<a.currentList.length-1?d:a.currentList.length-1;if(d!==c){focusDelayTime=1;var t=a.getNextRow(d-
1);if(t){a.scrollTo(t,"bottom");a.rowSelection(t,b.shiftKey,b.ctrlKey);h.$apply();var f=e(function(){a.updateFocus(a.getRowCurrentIndex(t),k);e.cancel(f)},focusDelayTime)}}},Jc=function(b,c,k){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:S.y});var d=a.getLastRow();if(d){a.rowSelection(d,b.shiftKey,b.ctrlKey);var t=e(function(){a.updateFocus(a.getRowCurrentIndex(d),k);e.cancel(t)},1)}},Kc=function(b,c,k){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var d=a.getFirstRow();if(d){a.rowSelection(d,
b.shiftKey,b.ctrlKey);var t=e(function(){a.updateFocus(a.getRowCurrentIndex(d),k);e.cancel(t)},1)}},fc=function(b,c){if(b&&0!=b[a.options.cellFields.allowEdit]){var k=a.getColumnById(b[a.options.cellFields.cid]);!k&&0<=c&&c<a.columnList.length&&(k=a.columnList[c]);if(k){var d=b[a.options.cellFields.value];if((k=k[a.options.columnFields.editorSettings])&&1==k.threeState)switch(p.isString(d)||(d="unchecked"),d){case "checked":d="unchecked";break;case "indeterminate":d="checked";break;default:d="indeterminate"}else d=
p.isBoolean(d)?!d:!0;b[a.options.cellFields.value]=d;h.$apply()}}},ia=null,X=angular.element('<div class="iui-grid-block iui-grid-block-top"></div>'),ha=null,wa=angular.element('<div class="iui-grid-block iui-grid-block-left"></div>'),P=0,Ua=0,da=null,pa=null,Ia=null,sa=angular.element('<div class="iui-grid-block iui-grid-block-right"></div>'),xa=0,Va=0,R=null,ca=null,Ja=null,ka=angular.element('<div class="iui-grid-block iui-grid-block-bottom"></div>'),va=null,H=0,C=null,v=null,I=100,Y=0,ja=0,Ka=
0,wb=0,E=0,O=0,Wa=0,Mb=!1,ra=!1,xb=9,yb=9,Nb=0,La=0,Xa=0,zb=1,Ob=0,Pb=0,Ma=0,jb=0,Qb=1,T=null,U=null,L=!1,M=!1;this.scrollMousePos=null;var S={x:0,y:0},cb=[];h.verScrollVisibility=!1;h.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.getColumnWidth=function(b){var c=100;b&&b[a.options.columnFields.width]&&(c=b[a.options.columnFields.width],p.isPercent(c)?(b=n[0].clientWidth-2*a.columnList.length,M&&K&&(b-=K[0].offsetWidth),c=Math.floor(parseInt(c,10)/100*b)):p.isString&&
(c=parseInt(c,10)));return c};var Ab=function(b){var c=0;if((b=a.getRowElems(b))&&0<b.length&&(b=angular.element(b[0]))&&(b=b.find("td"))&&0<b.length)for(var k=0;k<b.length;k++)var d=angular.element(b[k]),c=c+d[0].offsetWidth;return c},jd=function(){var b=0;if(a.options.showHeader||a.options.showFooter){var c=a.options.showHeader?a.getHeaderElem():a.getFooterElem();if(c&&(c=c.find("td"))&&0<c.length)for(var k=0;k<c.length;k++)var d=angular.element(c[k]),b=b+d[0].offsetWidth;a.isThereLeftFixedColumns&&
(da?P=da[0].offsetWidth:pa&&(P=pa[0].offsetWidth),b+=P);a.isThereRightFixedColumns&&(R?xa=R[0].offsetWidth:ca&&(xa=ca[0].offsetWidth),b+=xa)}else 0<a.currentList.length&&(ia&&(b+=Ab()),a.isThereLeftFixedColumns&&(b+=Ab("left")),a.isThereRightFixedColumns&&(b+=Ab("right")));return b};a.updateViewSize=function(){var b=e(function(){var c=0;a.options.grouping.enabled&&w&&(c=w[0].offsetHeight);Wa=0;var k=n[0].clientWidth;M&&K&&(k-=K[0].offsetWidth);L=!1;0<a.columnList.length&&(Wa+=jd(),Wa>k&&(y.unbind("mousedown"),
n.append(y),y.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=p.getClientMousePos(b,this);var c=Math.floor(n[0].clientWidth);T&&(b.x<T[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>T[0].offsetLeft+T[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}),T=angular.element(y.children().eq(0)),L=!0,T.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(G.scrollMousePos=
a.getMousePos(b),Mb=!0);b.stopPropagation()})));M=!1;h.verScrollVisibility=!1;0<a.currentList.length&&(k=0,a.options.paging.enabled&&Z&&(k=Z[0].offsetHeight),c=n[0].clientHeight-c-k-(E+O),L&&y&&(c-=y[0].offsetHeight),I=0<Y?Math.floor(c/Y)+1:0<E?Math.floor(c/E):100,I<a.currentList.length+1&&(K.unbind("mousedown"),n.append(K),K.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=p.getClientMousePos(b,this);var c=Math.floor(n[0].clientHeight);U&&(b.y<U[0].offsetTop?
(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-c}),Kb(!1,c)):b.y>U[0].offsetTop+U[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+c}),Kb(!0,c)))}),U=angular.element(K.children().eq(0)),M=!0,h.verScrollVisibility=!0,U.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(G.scrollMousePos=a.getMousePos(b),ra=!0);b.stopPropagation()})));L||(y.unbind("mousedown"),y.remove(),S.x=0);M||(K.unbind("mousedown"),K.remove(),S.y=0);L&&M?n.append(za):
za.remove();e.cancel(b);!L&&0<a.scrollPos.x&&a.setScrollPos({x:0,y:a.scrollPos.y});!M&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0})},1)};a.updateScrollView=function(){jc()};var jc=function(){var b=e(function(){var c=0;a.options.grouping.enabled&&w&&(c=w[0].offsetHeight);var k=0;a.options.paging.enabled&&Z&&(k=Z[0].offsetHeight);Ka=n[0].offsetWidth-2;wb=n[0].offsetHeight-2-c-k;L&&(wb-=y[0].offsetHeight);M&&(Ka-=K[0].offsetWidth);V.css("margin-top",c+"px");V.css("width",Ka+"px");V.css("height",
wb+"px");L&&(y.css("left","0px"),y.css("bottom",k+"px"),y.css("width",Ka-2+"px"));var d=2;a.options.paging.enabled&&Z&&(d=4);M&&(K.css("top",c+"px"),K.css("right","0px"),K.css("height",wb-d+"px"));L&&M&&(za.css("left","auto"),za.css("right","0px"));var t=e(function(){L&&Ka<Wa&&(La=2,Xa=y[0].clientWidth-4,Nb=0,Xa>La&&(Nb=Xa-La),xb=Math.floor(Nb*Ka/Wa),9>xb&&(xb=9),T.css("width",xb+"px"),S.x=Wa-Ka,zb=S.x/(Nb-xb-2));var b=a.currentList.length+1;M&&0<a.currentList.length&&I<b&&(Ma=2,jb=K[0].clientHeight-
4,Ob=0,jb>Ma&&(Ob=jb-Ma),yb=Math.floor(Ob*I/b),9>yb&&(yb=9),U.css("height",yb+"px"),Qb=(b-I+1)/(Ob-yb-2),S.y=Math.floor((b-I+1)*Y),0>S.y&&(S.y=0),0==H?U.css("top",Ma+"px"):H+I-1==a.currentList.length&&U.css("top",jb-U[0].offsetHeight+"px"));a.isThereLeftFixedColumns&&(da?P=da[0].offsetWidth:pa?P=pa[0].offsetWidth:0<a.currentList.length&&(P=Ab("left")),Ua=n[0].clientHeight-c-k-E-O,L&&(Ua-=y[0].offsetHeight),wa.css("top",c+E+"px"),wa.css("width",P+"px"),wa.css("height",Ua+"px"),ha&&ha.css("left",P+
"px"),ia&&ia.css("left",P+"px"),va&&va.css("left",P+"px"));a.isThereRightFixedColumns&&(R?xa=R[0].offsetWidth:ca?xa=ca[0].offsetWidth:0<a.currentList.length&&(xa=Ab("right")),Va=n[0].clientHeight-c-k-E-O,L&&(Va-=y[0].offsetHeight),b=0,M&&(b=K[0].offsetWidth),R&&R.css("right",b+"px"),sa.css("top",c+E+"px"),sa.css("right",b+"px"),sa.css("width",xa+"px"),sa.css("height",Va+"px"),ca&&ca.css("right",b+"px"));b=k;L&&y&&(b+=y[0].offsetHeight);ka.css("bottom",b+"px");e.cancel(t)},1);e.cancel(b)},5)};a.updateColumnWidth=
function(){if(a.options.fillSpace){for(var b=0,c=0;c<a.columnList.length;c++)b+=a.getColumnWidth(a.columnList[c])+4;if(b<n[0].clientWidth){for(var b=(n[0].clientWidth-b)/a.columnList.length,k=0,c=0;c<a.columnList.length;c++)k=a.getColumnWidth(a.columnList[c])+b,a.columnList[c][a.options.columnFields.width]=k;return!0}}return!1};h.onCellValueChanging=function(b,c,k){var d=c+H,e=a.getCell(d,k);if(e&&0==e[a.options.cellFields.allowEdit])return!1;var e=!0,f=a.getColumnObject(k),g="label",h=null;f&&(g=
f[a.options.columnFields.editorType],h=f[a.options.columnFields.editorSettings]);f=null;switch(g){case "checkbox":f=h&&1==h.threeState?b.checkState:b.checked;e=a.callCellValueChanging(a.getRowObject(d),a.getCellObject(d,k),f);break;case "combobox":e=a.callCellValueChanging(a.getRowObject(c),a.getCellObject(c,k),b.item)}return e};h.onCellValueChanged=function(b,c,k){var d=c+H,e=a.getColumnObject(k),f="label",g=null;e&&(f=e[a.options.columnFields.editorType],g=e[a.options.columnFields.editorSettings]);
e=null;switch(f){case "checkbox":e=g&&1==g.threeState?b.checkState:b.checked;a.callCellValueChanged(a.getRowObject(d),a.getCellObject(d,k),e);break;case "combobox":if(d=a.getCell(c,k))d[a.options.cellFields.value]=b.item,h.$apply();a.removeDropDownList(!0);a.updateFocus(c,k);a.callCellValueChanged(a.getRowObject(c),a.getCellObject(c,k),b.item)}};h.onEditorClick=function(b,c,k){c+=H;var d=a.getColumnObject(k),e="label";d&&(e=d[a.options.columnFields.editorType]);switch(e){case "checkbox":a.callCellClick(b,
a.getRowObject(c),a.getCellObject(c,k),a.getMousePos(b))}};a.setDefaultCellValue=function(b,c,k){if(void 0==b[a.options.cellFields.value]){var d=void 0;switch(c){case "checkbox":d=k&&1==k.threeState?"unchecked":!1;break;case "image":d=""}void 0!=d&&(b[a.options.cellFields.value]=d)}};var kb=function(b,c){c=void 0==c?"none":c;for(var k='<table cellpadding="0" cellspacing="0" style="position:absolute;',k=(b?k+'bottom:0;">':k+'top:0;">')+"<tr>",d="none",e=0;e<a.columnList.length;e++)d=a.columnList[e][a.options.columnFields.fixed],
d=void 0==d?"none":d,d==c&&(b?(k+='<td iui-class="{{data['+e+'].style.footer.general}}" data-index="'+e+'" data-element="column-footer">',k+='<div iui-class="{{data['+e+'].style.footer.cell}}" data-element="column-footer-cell"'):(k+='<td iui-class="{{data['+e+'].style.header.general}}" data-index="'+e+'" data-element="column-header">',k+='<div iui-class="{{data['+e+'].style.header.cell}}" data-element="column-header-cell"'),k+=' iui-contextmenu menu-items="data['+e+"].column."+a.options.columnFields.contextMenu+
'"',b?(k+=' iui-style="overflow:hidden;width:{{data['+e+"].width}}px;text-align:{{data["+e+"].footerAlignment}};",k=e==a.options.expandColIndex?k+("padding-left:{{data["+e+'].indent}}px;">'):k+'">',a.columnList[e][a.options.columnFields.footerContent]?k+=a.columnList[e][a.options.columnFields.footerContent]:a.columnList[e][a.options.columnFields.footerTemplate]?k+='<div ng-include="'+a.columnList[e][a.options.columnFields.footerTemplate]+'" style="margin:0;padding:0"></div>':(k+='<span iui-class="{{data['+
e+'].style.footer.content}}" data-element="cell-content">',k+="{{data["+e+"].column."+a.options.columnFields.footerText+"}}</span>")):(k+=' iui-style="overflow:hidden;width:{{data['+e+"].width}}px;text-align:{{data["+e+"].headerAlignment}};",k=e==a.options.expandColIndex?k+("padding-left:{{data["+e+'].indent}}px;">'):k+'">',k+='<span iui-class="{{data['+e+'].style.header.content}}" data-element="cell-content">',k+="{{data["+e+"].column."+a.options.columnFields.headerText+"}}</span>",k+='<span iui-class="{{data['+
e+'].style.filtering}}" data-index="'+e+'" data-element="filter-button" ng-show="data['+e+'].showFiltering"></span>',k+='<span iui-class="{{data['+e+'].style.sorting}}" data-index="'+e+'" data-element="sort-button" ng-show="data['+e+'].showSorting"></span>'),k+="</div>",k+="</td>");return k+="</tr></table>"},Rb=function(b,c,d){c=void 0==c?"none":c;var e="none",f='<tr iui-class="{{data['+b+'].style}}" data-index="{{data['+b+'].index}}" tabindex="{{data['+b+'].tabindex}}"';d&&(f+=' style="position:absolute;top:-9999px"');
f+=">";for(d=0;d<a.columnList.length;d++)if(e=a.columnList[d][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c){var f=f+('<td iui-class="{{data['+b+"].cells["+d+'].style.cell}}" data-element="cell" data-index="'+d+'" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+"].cells["+d+'].tabindex}}">'),f=f+('<div ng-show="data['+b+'].visible"'),f=f+(' iui-class="{{data['+b+"].cells["+d+'].style.content}}" data-element="cell-content"'),f=f+(' iui-contextmenu menu-items="data['+b+"].row."+
a.options.rowFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"'),f=f+(' iui-style="width:{{data['+b+"].cells["+d+"].width}}px;text-align:{{data["+b+"].cells["+d+"].alignment}};"),e=f=d==a.options.expandColIndex?f+("padding-left:{{data["+b+"].cells["+d+'].indent}}px;">'):f+'">',f=b,g=d,h="";g===a.options.expandColIndex&&(h+='<span iui-class="{{data['+f+'].expandBox}}" data-element="expandbox"></span>',h+='<span iui-class="{{data['+f+'].icon}}" data-element="icon" ng-show="data['+
f+'].iconVisible"></span>');var l=a.columnList[g][a.options.columnFields.editorSettings],n=kc(g);switch(a.columnList[g][a.options.columnFields.editorType]){case "checkbox":h+='<iui-checkbox name="cb-'+p.getUniqueId(4)+'"';l&&1==l.threeState?(h+=' check-state="data['+f+"].cells["+g+"].related."+a.options.cellFields.value+'"',h+=' checkstate-changing="onCellValueChanging(e, '+f+", "+g+')"',h+=' checkstate-changed="onCellValueChanged(e, '+f+", "+g+')"',h+=' three-state="true"'):(h+=' checked="data['+
f+"].cells["+g+"].related."+a.options.cellFields.value+'"',h+=' checked-changing="onCellValueChanging(e, '+f+", "+g+')"',h+=' checked-changed="onCellValueChanged(e, '+f+", "+g+')"');h+=' click="onEditorClick(e, '+f+", "+g+')"';l&&l.style&&(h+=' control-style="data['+f+"].cells["+g+'].editorStyle"');h+=' enabled="data['+f+"].cells["+g+"].related."+a.options.cellFields.enabled+'"';h+=' style="vertical-align:middle;" iui-show="{{data['+f+"].cells["+g+'].visible}}"></iui-checkbox>';break;case "combobox":h+=
'<span iui-class="{{data['+f+"].cells["+g+'].style.label}}" data-element="content">';h+="{{data["+f+"].cells["+g+"].related."+a.options.cellFields.value+".text}}";h+="</span>";break;case "image":h+='<img data-element="image" style="vertical-align:middle" ng-src="{{data['+f+"].cells["+g+"].related."+a.options.cellFields.value+'}}"  iui-show="{{data['+f+"].cells["+g+'].visible}}" show-default="true" />';break;default:n&&""!=n?h+='<iui-item-content obj="data['+f+"].cells["+g+"].related."+a.options.cellFields.templateObj+
'" template-url="{{data['+f+"].cells["+g+'].templateUrl}}" iui-show="{{data['+f+"].cells["+g+'].templateVisible}}" data-element="template-content"></iui-item-content>':(h+='<span iui-class="{{data['+f+"].cells["+g+'].style.label}}" data-element="content">',h+="{{data["+f+"].cells["+g+"].related."+a.options.cellFields.text+"}}",h+="</span>")}f=e+h;f+="</div>";f+="</td>"}return f+"</tr>"},w=angular.element('<div class="iui-grid-grouping-panel"></div>'),aa=null,Bb=null,Ya=-1,Na=!1,N=angular.element('<div style="opacity:0.75;position:absolute;top:-9999px;z-index:999;pointer-events:none;"></div>'),
lc=0,qa=angular.element('<div style="display:inline-block;"></div>'),lb=[],mc=function(b){var c=b[a.options.columnFields.groupText];c&&""!=c||(c=b[a.options.columnFields.headerText]);return c},ld=function(){yc();w.unbind("mouseenter mouseleave mousemove mouseup");w.empty();w.remove();lb.length=0;if(a.options.grouping.enabled){var b="",c=0;if(0<a.groups.length)for(var d=0;d<a.groups.length;d++){var e="iui-grid-grouping-panel-item";d<a.groups.length-1&&(e+=" iui-grid-grouping-marker");var f=mc(a.groups[d]),
b=b+('<div class="'+e+'" data-index="'+d+'">'),b=b+('<p class="iui-grid-grouping-panel-item-label">'+f+"</p>"),b=b+'<span class="iui-grid-grouping-panel-item-button"></span></div>'}else d=angular.element('<span class="iui-grid-grouping-panel-item" style="position:absolute;top:-999px;">Temp</span>'),n.append(d),c=d[0].offsetHeight,d.remove();if(""!=b){var h=angular.element(b);w.append(h)}ea&&w.css("opacity",la.opacity);n.append(w);e=0;f=w.find("div");for(d=0;d<f.length;d++){var l=angular.element(f[d]),
Ac=p.getMargin(l[0]);lb.push({x:e,width:l[0].offsetWidth});e+=l[0].offsetWidth+Ac.left+Ac.right}d=p.getPadding(w[0]);w.bind("mouseenter",function(b){1==b.which&&ba&&x&&(N.empty(),N.append('<div class="iui-grid-grouping-panel-item">'+x[a.options.columnFields.headerText]+"</div>"),w.append(N),lc=N[0].offsetWidth,N.css("display","none"),Na=!0,aa=null);b.stopPropagation()});w.bind("mousemove",function(b){if(1==b.which&&(ba&&x||Na&&aa)){var c=w[0].getBoundingClientRect(),m=angular.element(g)[0].pageXOffset,
d=angular.element(g)[0].pageYOffset,e=a.getMousePos(b);e.x-=c.left+m;e.y-=c.top+d;c="";x?c=mc(x):aa&&(c=mc(aa));Oc(b,c);W&&W.css("display","none");n.css("cursor","default");document.body.style.cursor="default";Bb=null;c=-1;aa&&(c=a.groups.indexOf(aa));for(m=lb.length-1;0<=m;m--)if(e.x>=lb[m].x){e.x<=lb[m].x+lb[m].width&&(Bb=a.groups[m]);if(e=a.getElemFromGroup(a.groups[m]))if(qa.css("display","inline-block"),x&&qa.css("width","0"),Ya=m,0==m)w.prepend(qa);else if(c>m){a:{if(Bb&&(e=a.groups.indexOf(Bb)-
1,a.isGroupIndexinRange(e,a.groups))){e=a.groups[e];break a}e=null}e&&(e=a.getElemFromGroup(e))&&e.after(qa)}else e.after(qa);Ya=0>Ya?0:Ya>a.groups.length-1?a.groups.length-1:Ya;break}}b.stopPropagation()});w.bind("mouseup",function(b){if(1==b.which&&(ba&&x||Na&&aa)){if(Na&&aa){var c=a.groups.indexOf(aa),m=Ya;c!=m?(a.moveObject(c,m,a.groups),a.updateLayout()):(c=a.getElemFromGroup(aa))&&c.css("display","inline-block")}else Bb?(m=Ya,0>a.groups.indexOf(x)&&(a.groups.splice(m,0,x),a.updateLayout())):
0>a.groups.indexOf(x)&&(a.groups.push(x),a.updateLayout());N&&N.remove();qa&&qa.remove();x=null;Ta=-1;Na=ba=!1;aa=null;W&&W.remove();n.css("cursor","default");document.body.style.cursor="default";b.stopPropagation()}});w.bind("mouseleave",function(a){qa&&qa.remove();N&&N.css("display","none")});w.css("width",n[0].clientWidth+"px");""==b?w.css("height",c+(d.top+d.bottom)-2+"px"):h&&w.css("height",h[0].offsetHeight+(d.top+d.bottom)-2+"px");kd()}},Oc=function(b,c){N.empty();N.append('<div class="iui-grid-grouping-panel-item"><p class="iui-grid-grouping-panel-item-label">'+
c+"</p></div>");w.append(N);var d=p.getPadding(w[0]),e=w[0].getBoundingClientRect(),f=angular.element(g)[0].pageXOffset,h=angular.element(g)[0].pageYOffset,l=a.getMousePos(b);l.x-=e.left+f;l.y-=e.top+h;lc=N[0].offsetWidth;e=l.x-lc/2;N.css("top",d.top+"px");N.css("left",e+"px");N.css("display","block")};a.getGroupFromElem=function(b){return b&&(b=angular.element(b))&&(b=b.parent(),b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isGroupIndexinRange(b,a.groups)))?a.groups[b]:
null};a.getElemFromGroup=function(b){var c=null;if(b){b=a.groups.indexOf(b);for(var d=w.find("div"),e=0;e<d.length;e++){var f=angular.element(d[e]);if(f[0].attributes&&f[0].attributes["data-index"]&&f[0].attributes["data-index"].value==b){c=f;break}}}return c};var yc=function(){for(var a=w.find("p"),b=0;b<a.length;b++){var c=angular.element(a[b]);c.unbind("mousedown")}a=w.find("span");for(b=0;b<a.length;b++)c=angular.element(a[b]),c.unbind("mousedown")},kd=function(){for(var b=w.find("p"),c=0;c<b.length;c++){var d=
angular.element(b[c]);d.bind("mousedown",function(b){if(1==b.which){var c=angular.element(this),m=c.parent();Na=!0;aa=a.getGroupFromElem(c);qa.css("width",m[0].offsetWidth+6+"px");qa.css("display","inline-block");m.after(qa);m.css("display","none");Oc(b,aa[a.options.columnFields.headerText])}b.stopPropagation()})}b=w.find("span");for(c=0;c<b.length;c++)d=angular.element(b[c]),d.bind("mousedown",function(b){var c=a.getGroupFromElem(this);c&&(c=a.groups.indexOf(c),0<=c&&(a.groups.splice(c,1),a.updateLayout()));
b.stopPropagation()})};a.isGroupIndexinRange=function(a,b){return 0<=a&&a<b.length?!0:!1};a.moveObject=function(b,c,d){a.isGroupIndexinRange(b,d)&&a.isGroupIndexinRange(c,d)&&d.splice(c,0,d.splice(b,1)[0])};var md=function(){Y=0;if(0<a.currentList.length&&v){var b="none";a.isThereLeftFixedColumns&&(b="left");a.isThereRightFixedColumns&&(b="right");for(var d=[],k=[],f=0,g=0;g<a.currentList.length&&10>g;g++)d.push(Rb(g,b,!0)),k.push(c(d[g])(v)),n.append(k[g]),f++;if(0<f)var h=e(function(){for(var a=
0,b=0;b<f;b++)a+=k[b][0].offsetHeight,k[b].remove();Y=Math.floor(a/f);e.cancel(h)},1)}},F=null,nc=0,oc=0,Z=angular.element('<div class="iui-pagination-panel"></div>'),nd=function(){F&&F.$destroy();Z.empty();Z.remove();oc=nc=0;if(a.options.paging.showControlPanel){F=h.$new();F.currentPage=0;F.numPages=a.pageList.length;0<F.numPages&&0==F.currentPage&&(F.currentPage=1);F.onFirstPage=function(){a.firstPage();F.currentPage=a.currentPageNumber};F.onLastPage=function(){a.lastPage();F.currentPage=a.currentPageNumber};
F.onNextPage=function(){a.nextPage();F.currentPage=a.currentPageNumber};F.onPrevPage=function(){a.prevPage();F.currentPage=a.currentPageNumber};F.$watch("currentPage",function(b,c){b!=c&&1<=b&&b<=a.pageList.length&&a.setCurrentPage(b)});nc=n[0].clientWidth;for(var b="",d=0;6>d;d++)switch(d){case 0:b+='<span class="iui-pagination-panel-button iui-pagination-first" ng-click="onFirstPage()"></span>';break;case 1:b+='<span class="iui-pagination-panel-button iui-pagination-prev" ng-click="onPrevPage()"></span>';
break;case 2:b+='<input class="iui-pagination-panel-input" ng-model="currentPage" type="number" iui-min="1" iui-max="{{numPages}}" />';break;case 3:b+='<span class="iui-pagination-panel-label"> / {{numPages}}</span>';break;case 4:b+='<span class="iui-pagination-panel-button iui-pagination-next" ng-click="onNextPage()"></span>';break;case 5:b+='<span class="iui-pagination-panel-button iui-pagination-last" ng-click="onLastPage()"></span>'}b=c(b)(F);Z.append(b);n.append(Z);Z.css("width",nc+"px");b&&
(p.getMargin(b[0]),d=p.getPadding(Z[0]),oc=b[0].offsetHeight+(d.top+d.bottom)-2,Z.css("height",oc+"px"))}};a.resetPageNumber=function(){a.currentPageNumber=1;F&&(F.currentPage=0<F.numPages?1:0)};a.updatePageNumber=function(){a.currentPageNumber>a.pageList.length&&(0==a.pageList.length?a.resetPageNumber():(a.currentPageNumber=a.pageList.length,F&&(F.currentPage=a.currentPageNumber)))};var od=function(){if(1<a.updateStatus)J("end");else var b=e(function(){if(0<a.columnList.length&&1==a.updateStatus){var d=
0;a.options.grouping.enabled&&w&&(d=w[0].offsetHeight);C=h.$new();C.data=Pc();a.refreshColumns();C.$apply();for(var k="",k=O=E=0;k<a.columnList.length;k++){var f={columnID:void 0!=a.columnList[k][a.options.columnFields.id]?a.columnList[k][a.options.columnFields.id]:k,avgItemHeight:0};switch(a.columnList[k][a.options.columnFields.editorType]){case "combobox":cd(a.columnList[k].editorSettings,k,f);cb.push(f);break;default:cb.push(f)}}a.options.showHeader&&(n.append(X),ea&&X.css("opacity",la.opacity),
X.css("top",d+"px"),k=kb(),ha=angular.element(c(k)(C)),X.append(ha),a.isThereLeftFixedColumns&&(k=kb(!1,"left"),da=c(k)(C),X.append(da),da.css("z-index","2"),da.addClass("iui-grid-column-header-left")),a.isThereRightFixedColumns&&(k=kb(!1,"right"),R=c(k)(C),X.append(R),R.css("right","0"),R.css("z-index","1"),R.addClass("iui-grid-column-header-right")));a.options.showFooter&&(n.append(ka),ea&&ka.css("opacity",la.opacity),k=kb(!0),va=c(k)(C),ka.append(va),a.isThereLeftFixedColumns&&(k=kb(!0,"left"),
pa=c(k)(C),ka.append(pa),pa.css("z-index","2"),pa.addClass("iui-grid-column-footer-left")),a.isThereRightFixedColumns&&(k=kb(!0,"right"),ca=c(k)(C),ka.append(ca),ca.css("right","0"),ca.css("z-index","1"),ca.addClass("iui-grid-column-footer-right")));for(var g=null,d=null,f=k=-1,l=0;l<a.columnList.length;l++)if(d=g=null,a.columnList[l][a.options.columnFields.headerContent]?(g=a.columnList[l][a.options.columnFields.headerContent],k=1):a.columnList[l][a.options.columnFields.headerTemplate]&&(g=a.columnList[l][a.options.columnFields.headerTemplate],
k=2),a.columnList[l][a.options.columnFields.footerContent]?(d=a.columnList[l][a.options.columnFields.footerContent],f=1):a.columnList[l][a.options.columnFields.footerTemplate]&&(d=a.columnList[l][a.options.columnFields.footerTemplate],f=2),g||d){var p=a.getElemFromColumn(a.columnList[l],a.columnList[l][a.options.columnFields.fixed]);if(p){if(g){var r=a.getChildElement(p,"column-header-cell");if(r)switch(r.empty(),k){case 1:r.append(c(g)(h.$parent));break;case 2:g='<div ng-include="'+g+'"',a.columnList[l][a.options.columnFields.headerTemplateModel]&&
(g+=' onload="'+a.columnList[l][a.options.columnFields.headerTemplateModel]+'"'),g+=' style="margin:0;padding:0"></div>',r.append(c(g)(h.$parent))}}if(d&&(r=a.getChildElement(p,"column-footer-cell")))switch(r.empty(),f){case 1:r.append(c(d)(h.$parent));break;case 2:g='<div ng-include="'+d+'"',a.columnList[l][a.options.columnFields.footerTemplateModel]&&(g+=' onload="'+a.columnList[l][a.options.columnFields.footerTemplateModel]+'"'),g+=' style="margin:0;padding:0"></div>',r.append(c(g)(h.$parent))}}}ta(40);
J("rows")}else ta(70),J("scroll");e.cancel(b)},1)},pd=function(){if(1<a.updateStatus)J("end");else var b=e(function(){if(0<a.columnList.length){var d=0;a.options.grouping.enabled&&w&&(d=w[0].offsetHeight);var k=0;a.options.paging.enabled&&Z&&(k=Z[0].offsetHeight);var f=0;if(a.options.showHeader&&ha){E=ha[0].offsetHeight;a.isThereLeftFixedColumns&&da?E=da[0].offsetHeight:a.isThereRightFixedColumns&&R&&(E=R[0].offsetHeight);var g=0,l=ha.find("td");if(l&&0<l.length)for(var p=0;p<l.length;p++)var r=angular.element(l[p]),
g=g+r[0].offsetWidth;g>n[0].clientWidth&&(g=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),g.css("bottom","-9999px"),n.append(g),f=g[0].offsetHeight,g.remove());X.css("width",n[0].clientWidth+"px");X.css("height",E+"px");a.isThereLeftFixedColumns&&(P=da[0].offsetWidth,Ua=n[0].clientHeight-E-O,ha.css("left",P+"px"));a.isThereRightFixedColumns&&(xa=R[0].offsetWidth,Va=n[0].clientHeight-E-O)}a.options.showFooter&&(O=va[0].offsetHeight,
a.isThereLeftFixedColumns&&pa?O=pa[0].offsetHeight:a.isThereRightFixedColumns&&ca&&(O=ca[0].offsetHeight),ka.css("width",n[0].clientWidth+"px"),ka.css("height",O+"px"),a.isThereLeftFixedColumns&&(P=pa[0].offsetWidth,Ua=n[0].clientHeight-E-O,va.css("left",P+"px")),a.isThereRightFixedColumns&&(xa=ca[0].offsetWidth,Va=n[0].clientHeight-E-O));Qc();if(0<a.currentList.length){v=h.$new();v.data=Rc();a.refreshRows();v.$apply();md();var z=e(function(){Ec();ia&&ia.remove();Ia&&Ia.remove();Ja&&Ja.remove();var b=
n[0].clientHeight-d-k-(E+O)-f;I=0<Y?Math.floor(b/Y)+1:0<E?Math.floor(b/E)+1:100;ja=0;for(var b="",m=0;m<I;m++)b+=Rb(m),ja++;if(0<ja){ia=angular.element('<table cellpadding="0" cellspacing="0" style="position:absolute;top:'+E+'px;"></table>');ia.append(c(b)(v));V.append(ia);if(a.isThereLeftFixedColumns){ia.css("left",P+"px");b="";for(m=ja=0;m<I;m++)b+=Rb(m,"left"),ja++;0<ja&&(Ia=angular.element('<table class="iui-grid-rows-left" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),
Ia.append(c(b)(v)),wa.append(Ia),n.append(wa),ea&&wa.css("opacity",la.opacity))}if(a.isThereRightFixedColumns){b="";for(m=ja=0;m<I;m++)b+=Rb(m,"right"),ja++;0<ja&&(Ja=angular.element('<table class="iui-grid-rows-right" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),Ja.append(c(b)(v)),sa.append(Ja),n.append(sa),ea&&sa.css("opacity",la.opacity))}}ta(70);J("scroll");e.cancel(z)},1)}else ta(70),J("scroll")}else ta(70),J("scroll");e.cancel(b)},1)},J=function(b){if(mb&&!Za)switch(b){case "start":1<
a.updateStatus?J("end"):(a.updateColumnList(),a.updateGroupList(),a.options.paging.enabled&&a.updatePageList(),a.updateCurrentList(),ta(10),J("init"));break;case "init":1<a.updateStatus?J("end"):(cb.length=0,zc(),a.options.grouping.enabled&&ld(),Mb||ra||jc(),V.empty(),ia=null,X.empty(),X.remove(),ha=null,ka.empty(),ka.remove(),va=null,wa.empty(),wa.remove(),Ua=P=0,Ia=da=null,sa.empty(),sa.remove(),Va=xa=0,Ja=R=null,C&&C.$destroy(),v&&v.$destroy(),a.options.paging.enabled&&nd(),ta(20),J("columns"));
break;case "columns":od();break;case "rows":X?a.options.showHeader&&X.find("td").length<a.columnList.length?e(function(){J(b)},1):pd():e(function(){J(b)},1);break;case "scroll":1<a.updateStatus?J("end"):(a.updateViewSize(),a.updateViewSize(),a.updateScrollView(),ta(80,"complete"),J("complete"));break;case "complete":1<a.updateStatus?J("end"):(ta(90),J("events"));break;case "events":1<a.updateStatus||(a.allowEvents=!0,a.options.showHeader&&(ha&&ec(ha),a.isThereLeftFixedColumns&&da&&ec(da),a.isThereRightFixedColumns&&
R&&ec(R)),0<a.currentList.length&&hd(),ta(100));J("end");break;case "end":switch(la.type){case "circular":Sc();nb=0;Oa=!0;1==a.updateStatus&&a.callLoadComplete();break;case "linear":Tc(!1);break;default:nb=0,Oa=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;0<a.updateStatus?(mb=a.updateActive=!0,1==a.updateStatus?J("start"):J("end")):a.callUpdateComplete()}else e(function(){J(b)},1)},Uc=5,Sb=0,$a=0,Tb=0,Vc=0,Za=!1,Ub=!1,la={type:"none",speed:"normal",opacity:0},pc=null,
ea=!1,Oa=!1,Tc=function(b){var c=l(function(){b?$a++:$a--;Tb=(n[0].clientHeight-$a)/2+2;Cb.css("height",$a+"px");Ea.css("top",Tb+"px");b&&$a>=Uc?(ea=!0,ta(0),Oa=Za=!1,l.cancel(c)):!b&&0>=$a&&(Ea&&Ea.remove(),nb=0,Oa=!0,a.callLoadComplete(),l.cancel(c))},20)},Sc=function(){pc&&l.cancel(pc);ya&&ya.remove()};a.beginLoad=function(a){if(!Za)switch(Za=!0,la=a?{type:void 0!=a.type?a.type:"none",speed:void 0!=a.speed?a.speed:"normal",opacity:void 0!=a.opacity?a.opacity:0}:{type:"none",speed:"normal",opacity:0},
qc(la.opacity),la.type){case "circular":Sc();n.append(ya);ya.css("top",(n[0].clientHeight-ya[0].offsetHeight)/2+"px");ya.css("left",(n[0].clientWidth-ya[0].offsetWidth)/2+"px");ea=!0;Oa=Za=!1;var b=0,c=3;switch(la.speed){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}pc=l(function(){b+=c;360<b&&(b=0);var a="rotate("+b+"deg)";ya.css("-ms-transform",a);ya.css("-webkit-transform",a);ya.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');
n.append(a);Uc=parseInt(getComputedStyle(a[0]).height,10);a.remove();Cb.css("width","0px");Cb.css("height","0px");n.append(Ea);nb=0;Sb=Math.floor(.5*n[0].clientWidth);$a=0;Tb=n[0].clientHeight/2+2;Vc=(n[0].clientWidth-Sb)/2;Ea.css("width",Sb+"px");Ea.css("top",Tb+"px");Ea.css("left",Vc+"px");Ea.css("opacity","1");Tc(!0);break;default:ea=!0,Oa=Za=!1}};a.endLoad=function(){if(!Ub)if(Ub=!0,ea){ea=!1;var a=3,b=la.opacity,c=l(function(){Oa&&(10<a||1<=b?(qc(1),Ub=Za=Oa=!1,la={type:"none",speed:"normal"},
l.cancel(c)):(b+=a/10,qc(b),a+=3))},1)}else Ub=!1};var qc=function(a){w&&w.css("opacity",a);X&&X.css("opacity",a);wa&&wa.css("opacity",a);V&&V.css("opacity",a);sa&&sa.css("opacity",a);ka&&ka.css("opacity",a);Z&&Z.css("opacity",a);y&&y.css("opacity",a);K&&K.css("opacity",a);za&&za.css("opacity",a)},Cb=angular.element('<div class="iui-load-block-progress"></div>'),Ea=angular.element('<div class="iui-load-block"></div>');Ea.append(Cb);var nb=0,mb=!1,ya=angular.element('<div class="iui-load-circular"></div>'),
ta=function(a){if(ea&&"linear"==la.type){mb=!1;var b=Math.floor(Sb*a/100),c=nb;a=10;switch(la.speed){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,e=l(function(){c+=d;Cb.css("width",c+"px");c>=b&&(nb=b,mb=!0,l.cancel(e))},1)}else mb=!0};a.updateStatus=0;a.updateActive=!1;a.updateLayout=function(b){b=!0;for(var c=n.parent();"body"!=c[0].tagName.toLowerCase();){if("none"==getComputedStyle(c[0]).display){b=!1;break}c=
c.parent()}b&&a.allowUpdate&&(a.updateStatus++,a.updateActive||(a.updateActive=!0,a.allowEvents=!1,n.removeClass("iui-grid-block-rtl"),a.options.rtl&&n.addClass("iui-grid-block-rtl"),V.removeClass("iui-grid-block-shift-left iui-grid-block-rtl"),V.addClass(ab()),Y=0,I=100,O=E=0,mb=!0,J("start")))};a.updateCurrentLayout=function(){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.updateGroupList();a.options.paging.enabled&&(a.updatePageList(),F&&(F.numPages=a.pageList.length),a.updatePageNumber());
a.updateCurrentList();a.updateView();var b=e(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();e.cancel(b)},1)}};var Wc=function(b,c){var d="left";return d=c?b[a.options.columnFields.footerAlignment]:b[a.options.columnFields.headerAlignment]},qd=function(b,c){var d=Wc(b),e=Wc(b,!0),f=a.isFilteringAllowed(b),g=a.isSortingAllowed()&&b==a.sortColumn,h=a.getColumnWidth(b),h=0<=h?h:0,l=rc(b);h<l.min&&(h=l.min);h>l.max&&(h=l.max);return{headerAlignment:d,footerAlignment:e,index:c,indent:0,
column:b,showFiltering:f,showSorting:g,style:{header:{},footer:{}},width:h}},Xc=function(b,c){if(0<=c){var d=a.currentList[b][a.options.rowFields.cells];if(c<d.length)return d[c]}return{}},kc=function(b){return a.columnList[b][a.options.columnFields.cellTemplateUrl]?a.columnList[b][a.options.columnFields.cellTemplateUrl]:""},rd=function(b,c,d){for(var e=[],f=0;f<a.columnList.length;f++){var g,h=f;if(d){var l=a.columnList[f][a.options.columnFields.id];l&&(h=a.getCellIndexById(a.currentList[c][a.options.rowFields.cells],
f,l))}g=h;var h=d?Xc(c,g):{},l=a.columnList[f][a.options.columnFields.contentAlignment]?a.columnList[f][a.options.columnFields.contentAlignment]:"left",n;n=(n=a.columnList[f][a.options.columnFields.editorSettings])&&n.style?n.style:null;var r;if(d){if(r=0,f==a.options.expandColIndex){r=c;var v=0,w=a.columnList[a.options.expandColIndex],z=a.getColumnWidth(w),y=z-a.indentList[r],y=0<=y?y:0,v={top:0,right:0,bottom:0,left:0};(w=a.getElemFromColumn(w,w[a.options.columnFields.fixed]))&&(w=a.getChildElement(w,
"column-header-cell"))&&(v=p.getPadding(w[0]));v=v.left+a.indentList[r];0==y&&(v=z);r=v}}else r=0;z=g;d?(y=c,v=f,y=1==a.options.allowFocus&&1==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[y])&&0<=v?a.getTabIndex().toString()+(y+1).toString()+v.toString():""):y="";v=kc(f);if(d)var x=c,w=g,A=kc(f),x=Xc(x,w),w=0<=w&&A&&""!=A&&x&&void 0!=x[a.options.cellFields.templateObj]&&null!=x[a.options.cellFields.templateObj]?!0:!1;else w=!1;if(d)a:{if(0<=g&&(A=a.currentList[c][a.options.rowFields.cells],
g<A.length)){A=A[g][a.options.cellFields.text];break a}A=""}else A="";if(d)a:{if(0<=g&&(x=a.currentList[c][a.options.rowFields.cells],g<x.length)){x=x[g][a.options.cellFields.value];break a}x=null}else x=null;g=d?0<=g?!0:!1:!1;var B;if(d){B=c;var E=f,D=a.columnList[E],C=a.getColumnWidth(D),D=rc(D);C<D.min&&(C=D.min);C>D.max&&(C=D.max);E==a.options.expandColIndex&&(C-=a.indentList[B]);B=C=0<=C?C:0}else B=0;e.push({related:h,alignment:l,editorStyle:n,indent:r,index:z,style:{},tabindex:y,templateUrl:v,
templateVisible:w,text:A,value:x,visible:g,width:B})}if(d){f="";h=a.defaultStyle.row.expandBox.general;b[a.options.rowFields.style]&&b[a.options.rowFields.style].expandBox&&b[a.options.rowFields.style].expandBox.general!=h?h+=" "+b[a.options.rowFields.style].expandBox.general:a.options.controlStyle.row.expandBox.general!=h&&(h+=" "+a.options.controlStyle.row.expandBox.general);l=a.getCurrentRowStyle(b);l=a.getExpandBoxStyle(l.expandBox);if(a.isThereChildRows||b&&b[a.options.rowFields.hasChildren])f=
h;b&&(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(f=b[a.options.rowFields.hasChildren]&&void 0===b[a.options.rowFields.expanded]?f+(" "+l.expanded):!1!==b[a.options.rowFields.expanded]?f+(" "+l.collapsed):f+(" "+l.expanded),!0===a.options.rtl&&(f+="-rtl"),a.isRowEnabled(b)||(f+="-disabled"))}else f="";h=d?a.isRowEnabled(b)&&a.isDragAllowed(b):!1;d?(l="",b.icon?l=b.icon:a.options.rowIcon&&(l=a.options.rowIcon)):
l="";n=d?0!=a.options.showIcons&&(b.icon||a.options.rowIcon):!1;g=d?1==a.options.allowFocus&&0==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[c])?a.getTabIndex().toString()+(c+1).toString():"":"";return{cells:e,expandBox:f,draggable:h,icon:l,iconVisible:n,index:c,row:d?b:{},style:{},tabindex:g,updateContextMenu:d?null!=b[a.options.rowFields.contextMenu]:!1,visible:d}},Pc=function(){for(var b=[],c=0;c<a.columnList.length;c++)b.push(qd(a.columnList[c],c));return b},Rc=function(){for(var b=
[],c=H;c<H+I;c++)b.push(rd(a.currentList[c],c,c<a.currentList.length));return b},Qc=function(){for(var b=0;b<a.columnList.length;b++)if(a.isFilteringAllowed(a.columnList[b])){var c=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);c&&(c=a.getChildElement(c,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&(c.css("top",(E-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),c.css("right","2px"))}a.isSortingAllowed()&&a.sortColumn&&(b=a.getElemFromColumn(a.sortColumn,
a.sortColumn[a.options.columnFields.fixed]))&&(c=a.getChildElement(b,"column-header-cell"))&&(c=a.getContentElement(c,"sort-button"))&&(c.css("top",(E-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),a.isFilteringAllowed(a.sortColumn)?c.css("right","22px"):c.css("right","2px"))};a.getRowScope=function(){return v};var Zc=function(){C&&v&&(a.allowEvents=!1,Yc(!1),0<a.columnList.length&&(C.data=Pc(),v.data=Rc(),a.options.selectedRow&&!a.isRowEnabled(a.options.selectedRow)&&(a.options.selectedRow[a.options.rowFields.selected]=
!1,a.options.selectedRow=null,a.updateSelectionList()),a.refresh(null,null,!1),C.$apply(),v.$apply(),Qc(),a.allowEvents=!0))};a.updateView=function(a){if(a)Zc();else var b=e(function(){Zc();e.cancel(b)},1)};var sc=function(b,c,d){var e={cell:"",content:"",general:"",label:""},f="";switch(c){case "column":d?(f=a.defaultStyle.column.footer.normal,a.options.controlStyle.column.footer.normal!=f&&(f+=" "+a.options.controlStyle.column.footer.normal),e.general=f,e.cell="iui-grid-column-footer-cell",f=a.defaultStyle.column.footer.content,
a.options.controlStyle.column.footer.content!=f&&(f+=" "+a.options.controlStyle.column.footer.content)):(f=a.defaultStyle.column.header.normal,a.options.controlStyle.column.header.normal!=f&&(f+=" "+a.options.controlStyle.column.header.normal),e.general=f,e.cell="iui-grid-column-header-cell",f=a.defaultStyle.column.header.content,a.options.controlStyle.column.header.content!=f&&(f+=" "+a.options.controlStyle.column.header.content));e.content=f;break;case "row":f=a.defaultStyle.row.general.normal;
a.options.controlStyle.row.general.normal!=f&&(f+=" "+a.options.controlStyle.row.general.normal);e.general=f;break;case "cell":f=a.defaultStyle.row.cell.normal;a.options.controlStyle.row.cell.normal!=f&&(f+=" "+a.options.controlStyle.row.cell.normal);switch(a.options.gridLines){case "none":f=b==H+I-1||b==a.currentList.length-1?f+" iui-grid-lines-horizontal":f+" iui-grid-lines-none";break;case "horizontal":f+=" iui-grid-lines-horizontal";break;case "vertical":f=b==H+I-1||b==a.currentList.length-1?
f+" iui-grid-lines-both":f+" iui-grid-lines-vertical";break;default:f+=" iui-grid-lines-both"}e.general=f;f=a.defaultStyle.row.cell.content;a.options.controlStyle.row.cell.content!=f&&(f+=" "+a.options.controlStyle.row.cell.content);e.content=f;e.label=a.getDefaultCellLabelClass()}return e},ob=function(b,c,d,e){var f=a.getObjState(b);d=sc(d,b.type,e);switch(b.type){case "column":e?(c=a.getCurrentColumnStyle(b,"footer",f),c!=a.options.controlStyle.column.footer.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,
"footer","content"),b!=a.options.controlStyle.column.footer.content&&(d.content+=" "+b)):(c=a.getCurrentColumnStyle(b,"header",f),c!=a.options.controlStyle.column.header.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"header","content"),b!=a.options.controlStyle.column.header.content&&(d.content+=" "+b));break;case "group":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&(d.general+=" "+b);break;case "row":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&
(d.general+=" "+b);break;case "cell":e=a.getCurrentCellStyle(c,b,f),e!=a.options.controlStyle.row.cell.normal&&(d.general+=" "+e),b=a.getCurrentCellStyle(c,b,"content"),b!=a.options.controlStyle.row.cell.content&&(d.content+=" "+b)}return d},pb=function(a,b,c){v.data[a].cells[b].style.cell=c.general;v.data[a].cells[b].style.content=c.content;v.data[a].cells[b].style.label=c.label},$c=function(b){if(v&&(b-=H,0<=b&&b<v.data.length&&v.data[b].visible)){v.data[b].style=a.defaultStyle.row.general.normal;
for(var c=0;c<a.columnList.length;c++)v.data[b].cells[c].style.cell=a.defaultStyle.row.cell.normal+" iui-grid-cell-empty"}};a.refreshColumns=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b],null,!1)};a.refreshRows=function(){for(var b=H;b<H+I;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):$c(b)};a.refresh=function(b,c,d){if(b)switch(b.type){case "column":if(C&&(c=a.getColumnCurrentIndex(b),0<=c&&c<C.data.length)){1==a.options.showHeader&&(C.data[c].style.header=
ob(b));1==a.options.showFooter&&(C.data[c].style.footer=ob(b,null,-1,!0));var e=C.data[c].style,f="";if(a.isFilteringAllowed(b)){var g=a.getObjState(b),f="iui-filtering";"selected"==g?f+=" iui-filtering-selected":"hovered"==g&&(f+=" iui-filtering-hovered")}e.filtering=f;c=C.data[c].style;e="";a.isSortingAllowed()&&b==a.sortColumn&&(b=a.getObjState(b),"ascending"==a.options.sorting?(e="iui-sort-ascending","selected"==b?e+=" iui-sort-ascending-selected":"hovered"==b&&(e+=" iui-sort-ascending-hovered")):
(e="iui-sort-descending","selected"==b?e+=" iui-sort-descending-selected":"hovered"==b&&(e+=" iui-sort-descending-hovered")));c.sorting=e;void 0==d&&C&&C.$apply()}break;case "group":if(v&&(c=a.getRowCurrentIndex(b),e=c-H,0<=e&&e<v.data.length&&v.data[e].visible)){v.data[e].style=ob(b).general;f=sc(c,"cell");for(g=0;g<a.columnList.length&&g<v.data[e].cells.length;g++){var h=v.data[e].cells[g].index;if(0<=h){var l=b[a.options.rowFields.cells];h<l.length?(h=ob(l[h],b,c),pb(e,g,h)):pb(e,g,f)}else pb(e,
g,f)}void 0==d&&v&&v.$apply()}break;case "row":if(v&&(c=a.getRowCurrentIndex(b),e=c-H,0<=e&&e<v.data.length&&v.data[e].visible)){v.data[e].style=ob(b).general;f=sc(c,"cell");for(g=0;g<a.columnList.length&&g<v.data[e].cells.length;g++)h=v.data[e].cells[g].index,0<=h?(l=b[a.options.rowFields.cells],h<l.length?(h=ob(l[h],b,c),pb(e,g,h)):pb(e,g,f)):pb(e,g,f);void 0==d&&v&&v.$apply()}}else{for(g=0;g<a.columnList.length;g++)a.refresh(a.columnList[g],null,!1);for(b=H;b<H+I;b++)b<a.currentList.length?a.refresh(a.currentList[b],
null,!1):$c(b);1==d&&v&&v.$apply()}};a.moveColumn=function(b,c){if(b&&0!=a.callColumnPosChanging(b)){var d=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(d=a.columnList[a.options.expandColIndex]);var e=a.getColumnCurrentIndex(b),f=a.getColumnRealIndex(e),g=-1,h=a.getFullColumnList();switch(c){case "first":g=0;break;case "left":(e=cc(e-1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "right":(e=dc(e+
1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "last":g=h.length-1}0<=g&&g<h.length&&f!=g&&(f<g?"first"!=c&&"left"!=c||g--:f>g&&("last"!=c&&"right"!=c||g++),a.columnsObj.moveObject(f,g),a.updateColumnList(),d=a.getColumnCurrentIndex(d),d!=a.options.expandColIndex?(a.options.expandColIndex=d,a.updateLayout()):a.updateView(),a.callColumnPosChanged(x,a.hoverColumn))}};a.moveRow=function(b,c,d,e){if(b){a.allowUpdate=!1;var f=-1;switch(d){case "first":f=
0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var h=!1,l=a.getParent(b[g]);l;){if(0<=b.indexOf(l)){h=!0;break}l=a.getParent(l)}h||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)tc(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)tc(e[g],c,f,d)}else tc(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var tc=function(b,c,d,e){a.rowsObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==
e||"last"==e||"at"==e?a.rowsObj.insertAt(b,d,c,a.rowIsAdded):"before"==e?a.rowsObj.insertByRef(b,c,!1,a.rowIsAdded):"after"==e&&a.rowsObj.insertByRef(b,c,!0,a.rowIsAdded))},Ca="none",Q=!1,Vb=-1,Ca="none",Wb=0,Xb=0;h.$watch(function(){return n[0].offsetWidth},function(b,c){100==I?a.updateLayout():b!=c&&(X&&X.css("width",n[0].clientWidth+"px"),ka&&ka.css("width",n[0].clientWidth+"px"),a.updateCurrentLayout())});var Yb=null;h.$watch(function(){return n[0].offsetHeight},function(b,c){b!=c&&(Yb=e(function(){Yb&&
(a.updateLayout(),e.cancel(Yb),Yb=null)},1E3))});a.isColumnWithFixedWidth=function(b){var c=a.columnList;return c&&0<=b&&b<c.length?c[b][a.options.columnFields.fixedWidth]?c[b][a.options.columnFields.fixedWidth]:!1:!1};a.setColumnResizingParams=function(b,c,d){0<=b&&b<a.columnList.length&&(Vb=b,Ca=c,Xb=d,Wb=a.getColumnWidth(a.columnList[b]))};var ad=function(b){return b&&0!=b[a.options.columnFields.visible]?!0:!1},cc=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";0<=b;b--)if(!d||
d&&ad(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":f,f==c){e=a.columnList[b];break}return e},dc=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";b<a.columnList.length;b++)if(!d||d&&ad(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":f,f==c){e=a.columnList[b];break}return e},Fc=function(b,c){if(0<=b&&b<a.columnList.length){var d=a.columnList[b];if(d)switch(columnFixedType=d[a.options.columnFields.fixed],
c){case "left":if("right"!=columnFixedType){if(!cc(b-1,d[a.options.columnFields.fixed]))return!1}else if(!columnFixedType||"none"==columnFixedType)return 0<b;break;case "right":if("right"==columnFixedType&&!dc(b+1,d[a.options.columnFields.fixed]))return!1}}return!0};a.resizeColumn=function(b,c,d){0>c&&(c=0);var e=null;if(e=a.getHeaderElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,1,d);if(e=a.getRowElems(d)){var f={top:0,right:0,bottom:0,left:0},g=a.getElemFromColumn(a.columnList[b],
a.columnList[b][a.options.columnFields.fixed]);g&&(g=a.getChildElement(g,"column-header-cell"))&&(f=p.getPadding(g[0]));for(g=0;g<e.length;g++)angular.element(e[g]),a.resizeColumnCells(angular.element(e[g]),b,c,0,d,!0,f)}if(e=a.getFooterElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,2,d);0<=b&&b<a.columnList.length&&a.callColumnSizeChanged(a.columnList[b])};a.resizeColumnCells=function(b,c,d,e,f,g,h){if(b){var l=-1;g&&(l=a.getRowCurrentIndex(a.getRowFromElem(b)));b=b=0;0<=l&&(b=
a.indentList[l]);g=null;switch(e){case 1:g=a.getElemFromColumnCell(c,f);break;case 2:g=a.getElemFromColumnCell(c,f,!0);break;default:g=a.getElemFromCell(l,c,f)}g&&0<g.children().length&&(e=g.children().eq(0))&&(b=h?h.left+b:b,h=d,0<=l&&c==a.options.expandColIndex&&(h-=b),h=0<=h?h:0,e.css("width",h+"px"),c==a.options.expandColIndex&&(0==h?e.css("padding-left",d+"px"):e.css("padding-left",b+"px")))}};angular.element(g).bind("dragover",function(a){fb()});var ga=angular.element('<div class="iui-grid-column-reorder-mark"><span></span></div>'),
W=angular.element('<div class="iui-grid-column-reorder-tooltip"><span></span></div>'),Bc=function(b){var c="initial";ba&&x&&(!a.hoverColumn||x==a.hoverColumn||a.hoverColumn&&0==a.hoverColumn.allowDrop||a.hoverColumn&&x[a.options.columnFields.fixed]!=a.hoverColumn[a.options.columnFields.fixed])&&(c="not-allowed",b&&W&&W.css("display","none"));n.css("cursor",c);document.body.style.cursor=c},rc=function(b){return b?{min:p.isFieldAvailable(b[a.options.columnFields.minWidth],0),max:p.isFieldAvailable(b[a.options.columnFields.maxWidth],
9999999)}:{min:0,max:9999999}};angular.element(g).bind("mousemove",function(b){if(0===b.button&&0<=Vb&&"none"!=Ca){var c=a.getMousePos(b),d=Vb,e=a.columnList;if(0<=d&&d<e.length){var f=Wb+c.x-Xb;"right"==e[d][a.options.columnFields.fixed]&&(f=Wb-(c.x-Xb));f=0<=f?f:0;c=rc(e[d]);f>=c.min&&f<=c.max&&(e[d][a.options.columnFields.width]=f,a.resizeColumn(d,f,e[d][a.options.columnFields.fixed]),a.updateViewSize(),jc())}}N&&N.css("display","none");W&&W.css("display","none");Mb?ea||1!==b.which||(T[0].getBoundingClientRect(),
b=a.getMousePos(b),G.scrollMousePos||(G.scrollMousePos=b),d=T[0].offsetLeft+(b.x-G.scrollMousePos.x),d<La?d=La:d+T[0].offsetWidth>Xa&&(d=Xa-T[0].offsetWidth),T.css("left",d+"px"),G.scrollMousePos=b,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.x=!1!==a.options.rtl?parseInt((Xa-T[0].offsetLeft-T[0].offsetWidth)*zb,10):parseInt((T[0].offsetLeft-La)*zb,10),bd(),(uc(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()):ra&&(ea||1!==b.which||(U[0].getBoundingClientRect(),
b=a.getMousePos(b),G.scrollMousePos||(G.scrollMousePos=b),d=U[0].offsetTop+(b.y-G.scrollMousePos.y),d<Ma?d=Ma:d+U[0].offsetHeight>jb&&(d=jb-U[0].offsetHeight),U.css("top",d+"px"),G.scrollMousePos=b,Pb=d-Ma,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Pb*Qb*Y),(uc(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<Y?Math.floor(a.scrollPos.y/Y):0,newIndex+I-1>a.currentList.length&&(newIndex=a.currentList.length-I+1,newIndex+=5),0>newIndex&&
(newIndex=0),newIndex!==H&&(H=newIndex,a.updateView(!0))))});angular.element(g).bind("mousedown",function(b){a.removeDropDownList();a.closeEditor(d);a.closeFilterWindow();qb()});angular.element(g).bind("mouseup",function(b){Bc(!0);N&&N.remove();1==b.which&&Na&&aa&&(b=a.getElemFromGroup(aa))&&b.css("display","inline-block");W&&W.remove();Na=ba=!1;aa=null;Vb=-1;Ca="none";Xb=Wb=0;Q=!1;n.css("cursor","default");a.dropMark();ra&&a.updateView();fb();G.scrollMousePos=null;ra=Mb=!1;n.css("cursor","default");
document.body.style.cursor="default"});var vc=!1,Pa=0,Zb=null,wc=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return L;case "vertical":return M}return L&&M};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getMaxScrollPos=function(){return S};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!ea&&b){var d=!0;0>b.x&&(b.x=0,d=!1);b.x>S.x&&(b.x=S.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>S.y&&(b.y=S.y,d=!1);a.scrollPos=b;Pb=Math.floor(a.scrollPos.y/(Y*Qb));var e=
0,f=Ma+Pb,e=!1!==a.options.rtl?Math.floor(a.scrollPos.x/zb)-(Xa-T[0].offsetWidth-La):Math.floor(a.scrollPos.x/zb)+La;L&&T&&T.css("left",e+"px");M&&U&&U.css("top",f+"px");bd();Yc(!0,c);d&&a.callScrollPosChanged()}};var uc=function(a){return 0<a.x&&a.x<S.x||0<a.y&&a.y<S.y},Kb=function(b,c,d){vc||(a.updateFocus(),Pa=0,vc=!0,Zb=l(function(){var d=c,e=a.getScrollPos();d||(0===Pa&&(Pa=5),Pa+=5+Qb,wc+=.5,d=Pa+=Math.floor(wc));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&fb()},d?
d:100))},fb=function(){Zb&&(l.cancel(Zb),Zb=null);vc=!1;Pa=0};a.cancelScrollTimer=function(){fb()};a.scrollTo=function(b,c){if(b){var d=a.getRowCurrentIndex(b);if(a.isRowIndexInRange(d)){var e=0,e=d;switch(c){case "center":e=Math.floor(ja/2)-1;e=d>e?d-e:0;break;case "bottom":e=ja-2,a.options.showHeader&&e--,a.options.showFooter&&e--,e=d>e?d-e:0}a.setScrollPos({x:a.scrollPos.x,y:e*Y})}}};var bd=function(){var b=a.scrollPos.x;0>b&&(b=0);b>S.x&&(b=S.x);b*=-1;ha&&ha.css("left",b+P+"px");va&&va.css("left",
b+P+"px");ia&&ia.css("left",b+P+"px")},Yc=function(b,c){if(!(0==b&&0>=Y)){newIndex=0<Y?Math.floor(a.scrollPos.y/Y):0;a.scrollPos.y==S.y&&newIndex--;if(a.currentList.length>=I&&newIndex+I-1>a.currentList.length){newIndex=a.currentList.length-I+1;var d=a.getRowElems();d||(d=a.getRowElems("left"));d||(d=a.getRowElems("right"));d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>n[0].clientHeight-(E+O)&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!=H&&(H=newIndex,0!=b&&
a.updateView(c))}};n.bind("scroll",function(a){n[0].scrollTop=0;n[0].scrollLeft=0});n.bind("mousewheel",function(b){b.preventDefault();if(!ea&&M){document.activeElement&&document.activeElement.blur();a.removeDropDownList();a.closeEditor(d);a.closeFilterWindow();qb();var c=a.hoverRow;a.hoverRow=null;a.refresh(c);c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));b=Math.floor(n[0].clientHeight/
4);a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+b*c*-1},!0);uc(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}});var Db={x:0,y:0},Qa={x:0,y:0};n.bind("touchstart",function(b){b.preventDefault();(b=a.getTouchData(b))&&0<b.length&&(Db={x:b[0].pageX,y:b[0].pageY})});n.bind("touchend",function(b){(b=a.getTouchData(b))&&0<b.length&&(Qa={x:b[0].pageX,y:b[0].pageY});var c=Qa.x-Db.x,d=Qa.y-Db.y;(20<Math.abs(c)||20<Math.abs(d))&&
document.activeElement&&document.activeElement.blur();var e=!1,f=!1,g=Db,h=l(function(){var b=a.scrollPos;-20>c?(g.x-=10,g.x>Qa.x?b.x+=10:(b.x-=c,e=!0)):20<c?(g.x+=10,g.x<Qa.x?b.x-=10:(b.x-=c,e=!0)):e=!0;-20>d?(g.y-=10,g.y>Qa.y?b.y+=10:(b.y-=d,f=!0)):20<d?(g.y+=10,g.y<Qa.y?b.y-=10:(b.y-=d,f=!0)):f=!0;a.setScrollPos(b);e&&f&&l.cancel(h)},10);Db=Qa});G=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){var b;b="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";
b+=a[1]+a[4]+a[2]+a[0]+a[3];return b+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(G.tpar));this.tmp=300;this.twp=200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",n[0].scrollTop+"px"),this.$tw.css("left",n[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),
this.$tw.css("top",n[0].scrollTop+"px"),this.$tw.css("left",n[0].scrollLeft+"px"))};this.s1t=function(a){this.trlTime=e(function(){G.trActive||(G.trCount=0,G.trActive=!0,G.trId=l(function(){G.animTr()},1E3))},a)};this.s2t=function(){this.trId&&(l.cancel(this.trId),this.trId=null);this.trlTime&&(e.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};n.append(this.$tw);this.s1t(this.twp);angular.isDefined(h.options)?a.updateOptions(h.options):(0==h.allowAnimation&&(a.options.allowAnimation=
h.allowAnimation),0==h.allowCellFocus&&(a.options.allowCellFocus=h.allowCellFocus),1==h.allowColumnReorder&&(a.options.allowColumnReorder=h.allowColumnReorder),angular.isDefined(h.controlStyle)&&a.updateControlStyle(h.controlStyle),1==h.allowDrag&&(a.options.allowDrag=h.allowDrag),0==h.allowDrop&&(a.options.allowDrop=h.allowDrop),1==h.allowFilter&&(a.options.allowFilter=h.allowFilter),0==h.allowFocus&&(a.options.allowFocus=h.allowFocus),0==h.autoExpand&&(a.options.autoExpand=h.autoExpand),angular.isDefined(h.animationSpeed)&&
200!==h.animationSpeed&&(a.options.animationSpeed=h.animationSpeed),angular.isDefined(h.editorSettings)&&a.updateEditorSettings(h.editorSettings),angular.isDefined(h.expandingColumnIndex)&&(a.options.expandColIndex=h.expandingColumnIndex),angular.isDefined(h.fields)&&(a.updateDataFields(h.fields),a.updateData()),1==h.fillSpace&&(a.options.fillSpace=h.fillSpace),angular.isDefined(h.gridLines)&&(a.options.gridLines=h.gridLines),angular.isDefined(h.grouping)&&a.updateGrouping(h.grouping),1==h.hoverSelection&&
(a.options.hoverSelection=h.hoverSelection),angular.isDefined(h.indent)&&(a.options.indent=h.indent),angular.isDefined(h.labelEdit)&&(a.options.labelEdit=h.labelEdit),angular.isDefined(h.paging)&&a.updatePaging(h.paging),angular.isDefined(h.rowIcon)&&(a.options.rowIcon=h.rowIcon),1==h.rtl&&(a.options.rtl=h.rtl),angular.isDefined(h.selectedIndex)&&(a.options.selectedIndex=h.selectedIndex),angular.isDefined(h.selectedRow)&&(a.options.selectedRow=h.selectedRow),angular.isDefined(h.selectionMode)&&(a.options.selectionMode=
h.selectionMode),0==h.showFooter&&(a.options.showFooter=h.showFooter),0==h.showHeader&&(a.options.showHeader=h.showHeader),0==h.showIcons&&(a.options.showIcons=h.showIcons),angular.isDefined(h.sorting)&&(a.options.sorting=h.sorting));a.updateLayout()}}}]);