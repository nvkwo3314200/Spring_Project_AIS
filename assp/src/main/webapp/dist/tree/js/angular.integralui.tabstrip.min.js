/*
  filename: angular.integralui.tabstrip.min.js
  version : 1.0.7
  Copyright © 2014-2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUITabStripService",["$rootScope","IntegralUIPublicService",function(c,q){return{addTab:function(e,f){c.$broadcast(e+"-add-tab",f)},clearTabs:function(e){c.$broadcast(e+"-clear-tabs")},insertTabAt:function(e,f,n){c.$broadcast(e+"-insert-tab-at",f,n)},insertTabBefore:function(e,f,n){c.$broadcast(e+"-insert-tab-before",f,n)},insertTabAfter:function(e,f,n){c.$broadcast(e+"-insert-tab-after",f,n)},removeTab:function(e,f){c.$broadcast(e+"-remove-tab",f)},removeTabAt:function(e,f){c.$broadcast(e+"-remove-tab-at",f)},loadData:function(e,f,n){c.$broadcast(e+"-load-data",f,n)},findTabById:function(e,f){c.$broadcast(e+"-find-tab-by-id",f);var n=this.getTempData();this.clearTempData();return n?n:null},findTabByText:function(e,f){c.$broadcast(e+"-find-tab-by-text",f);var n=this.getTempData();this.clearTempData();return n?n:null},clearTempData:function(){tempData=null},getList:function(e,f){c.$broadcast(e+"-get-list",f);var n=this.getTempData();this.clearTempData();return n?n:[]},getTempData:function(){return tempData},setTempData:function(c){tempData=c},clearSelection:function(e){c.$broadcast(e+"-clear-selection")},selectedTab:function(e,f){if(f)c.$broadcast(e+"-set-selected-tab",f);else{c.$broadcast(e+"-get-selected-tab");var n=this.getTempData();this.clearTempData();return n?n:null}},refresh:function(e){c.$broadcast(e+"-refresh")},resumeLayout:function(e){c.$broadcast(e+"-resume-layout")},suspendLayout:function(e){c.$broadcast(e+"-suspend-layout")},updateLayout:function(e){c.$broadcast(e+"-update-layout")}}}]).controller("IntegralUITabStripController",["$scope","$element","IntegralUIInternalService","IntegralUIDataService","IntegralUITabStripService",function(c,q,e,f,n){var b=this;b.defaultStyle={general:"iui-tabstrip",navigation:{general:"iui-tabstrip-navigation",button:{disabled:"iui-tabstrip-navigation-button-disabled",normal:"iui-tabstrip-navigation-button",hovered:"iui-tabstrip-navigation-button-hovered",selected:"iui-tabstrip-navigation-button-selected"}},tab:{general:"iui-tab",header:{content:"iui-tab-header-content",disabled:"iui-tab-header-disabled",focused:"iui-tab-header-focused",normal:"iui-tab-header",hovered:"iui-tab-header-hovered",selected:"iui-tab-header-selected"},content:{disabled:"iui-tab-content-disabled",focused:"iui-tab-content-focused",normal:"iui-tab-content",hovered:"iui-tab-content-hovered",selected:"iui-tab-content-selected"}}};b.options={};this.updateOptions=function(a){a?(b.options={controlStyle:b.defaultStyle,enabled:e.isFieldAvailable(a.enabled,!0),hoverSelection:e.isFieldAvailable(a.hoverSelection,!1),hoverTab:null,rtl:e.isFieldAvailable(a.rtl,!1),selectedTab:e.isFieldAvailable(a.selectedTab,b.options.selectedTab?b.options.selectedTab:null),showCloseButton:e.isFieldAvailable(a.showCloseButton,!0),showIcons:e.isFieldAvailable(a.showIcons,!0),tabIcon:e.isFieldAvailable(a.tabIcon,""),tabstripPlacement:e.isFieldAvailable(a.tabstripPlacement,"top")},b.updateDataFields(a.dataFields),b.updateControlStyle(a.controlStyle)):(b.options={controlStyle:b.defaultStyle,enabled:!0,hoverSelection:!1,hoverTab:null,rtl:!1,selectedTab:null,showCloseButton:!0,showIcons:!0,tabIcon:"",tabstripPlacement:"top"},b.updateDataFields())};this.updateDataFields=function(a){b.options.dataFields=a?{content:a.content?a.content:"content",enabled:a.enabled?a.enabled:"enabled",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",name:a.name?a.name:"name",selected:a.selected?a.selected:"selected",style:a.style?a.style:"style",text:a.text?a.text:"text",value:a.value?a.value:"value",visible:a.visible?a.visible:"visible"}:{content:"content",enabled:"enabled",icon:"icon",id:"id",name:"name",selected:"selected",style:"style",text:"text",value:"value",visible:"visible"};b.dataObj&&b.dataObj.updateDataFields(b.options.dataFields)};b.updateOptions();c.$on(c.name+"-add-tab",function(a,c){b.dataObj.insertAt(c,-1,null,b.tabIsAdded)});c.$on(c.name+"-clear-tabs",function(a){b.dataObj.clear(null,b.listIsCleared)});c.$on(c.name+"-insert-tab-at",function(a,c,d){b.dataObj.insertAt(c,d,null,b.tabIsAdded)});c.$on(c.name+"-insert-tab-after",function(a,c,d){b.dataObj.insertByRef(c,d,!0,b.tabIsAdded)});c.$on(c.name+"-insert-tab-before",function(a,c,d){b.dataObj.insertByRef(c,d,!1,b.tabIsAdded)});c.$on(c.name+"-remove-tab",function(a,c){b.dataObj.removeAt(c,-1,null,b.tabIsRemoved)});c.$on(c.name+"-remove-tab-at",function(a,c){b.dataObj.removeAt(null,c,null,b.tabIsRemoved)});this.listIsCleared=function(){b.options.selectedTab=null;b.updateLayout()};this.tabIsAdded=function(){b.updateLayout()};this.tabIsRemoved=function(a,c,d){a&&(a.selected=!1,a==b.options.selectedTab&&(b.options.selectedTab=null));b.updateLayout()};this.addTabScope=function(a){a&&(b.tabScopeList.push(a),b.updateLayout&&b.updateLayout())};this.removeTabScope=function(a){a=b.tabScopeList.indexOf(a);0<=a&&b.tabScopeList.splice(a,1)};this.currentList=[];this.currentScopeList=[];this.getCurrentList=function(){return b.currentList};this.updateCurrentList=function(){b.currentList.length=0;var a=b.dataObj.getList();if(a)for(var c=0;c<a.length;c++){var d=a[c];b.isTabVisible(d)&&(d.type="tab",d[b.options.dataFields.id]||(d[b.options.dataFields.id]=e.getUniqueId()),b.currentList.push(d))}};this.updateCurrentScopeList=function(){for(var a=b.currentScopeList.length=0;a<b.currentList.length;a++){var c=b.getScopeByTab(b.currentList[a]);c&&b.currentScopeList.push(c)}};this.tabScopeList=c.tabScopeList=[];this.dataEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clear?c.events.clear():c.clear()},objAdded:function(a){return angular.isDefined(c.events)&&c.events.tabAdded?c.events.tabAdded({tab:a.e.obj}):c.tabAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.tabAdding?c.events.tabAdding({tab:a.e.obj}):c.tabAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.tabRemoved?c.events.tabRemoved({tab:a.e.obj}):c.tabRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.tabRemoving?c.events.tabRemoving({tab:a.e.obj}):c.tabRemoving(a)}};this.getDataFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",objects:a.tabs?a.tabs:"tabs",text:a.text?a.text:"text"}};b.dataObj=new f({objects:c.tabs,events:b.dataEvents,fields:b.getDataFields(b.options.dataFields)});c.$on(c.name+"-load-data",function(a,c,d){b.loadData(c,d)});this.loadData=function(a,d){b.allowEvents=!1;b.updateDataFields(d);var e=[];b.dataObj.clear(null,b.listIsCleared);a&&(e=a);if(angular.isDefined(c.tabs))for(var m=c.tabs.length=0;m<e.length;m++)c.tabs.push(e[m]);b.dataObj=new f({objects:c.tabs,events:b.dataEvents,fields:b.getDataFields(b.options.dataFields)});b.updateLayout();b.allowEvents=!0};this.allowEvents=!0;this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?c.events.afterSelect({tab:a}):c.afterSelect({e:{tab:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({tab:a}):c.selectionChanged({e:{tab:a}})};this.callEnabledChanged=function(a){angular.isDefined(c.events)&&c.events.enabledChanged?c.events.enabledChanged({enabled:a}):c.enabledChanged({e:{enabled:a}})};this.callTabClick=function(a,b){angular.isDefined(c.events)&&c.events.tabClick?c.events.tabClick({tab:a,mousePos:b}):c.tabClick({e:{tab:a,mousePos:b}})};this.callTabDblClick=function(a,b){angular.isDefined(c.events)&&c.events.tabDblClick?c.events.tabDblClick({tab:a,mousePos:b}):c.tabDblclick({e:{tab:a,mousePos:b}})};this.callTabHover=function(a){angular.isDefined(c.events)&&c.events.tabHover?c.events.tabHover({tab:a}):c.tabHover({e:{tab:a}})};this.callTabRightClick=function(a,b){angular.isDefined(c.events)&&c.events.tabRightClick?c.events.tabRightClick({tab:a,mousePos:b}):c.tabRightclick({e:{tab:a,mousePos:b}})};this.callStyleChanged=function(a){angular.isDefined(c.events)&&c.events.styleChanged?c.events.styleChanged({style:a}):c.styleChanged({e:{style:a}})};c.$on(c.name+"-find-tab-by-id",function(a,c){n.setTempData(b.findTabById(c))});c.$on(c.name+"-find-tab-by-text",function(a,c){n.setTempData(b.findTabByText(c))});this.findTabById=function(a){return b.dataObj.findObjectById(a)};this.findTabByText=function(a){return b.dataObj.findObjectByText(a)};this.findTabByName=function(a){var c=null,d=b.getList();if(d)for(var e=0;e<d.length;e++)if(d[e].name==a){c=d[e];break}return c};this.findScopeByName=function(a){for(var c=null,d=0;d<b.tabScopeList.length;d++)if(b.tabScopeList[d].name==a){c=b.tabScopeList[d];break}return c};c.$on(c.name+"-get-ctrl",function(a){e.setTempData(b)});c.$on(c.name+"-get-list",function(a,c){1==c?n.setTempData(b.getCurrentList()):n.setTempData(b.getList())});this.getTabByScope=function(a){return a&&(a=b.getTabScopeIndex(a),b.isIndexInRange(a))?b.currentList[a]:null};this.getTabCurrentIndex=function(a){return a&&b.currentList?b.currentList.indexOf(a):-1};this.getTabScopeIndex=function(a){return a&&b.currentScopeList?b.currentScopeList.indexOf(a):-1};this.getTabState=function(a){if(a){if(0==b.options.enabled||0==a[b.options.dataFields.enabled])return"disabled";if(a==b.options.selectedTab)return"selected";if(a==b.options.hoverTab)return"hovered"}return"normal"};this.getList=function(){return b.dataObj.getList()};this.getScopeByTab=function(a){return a?b.findScopeByName(a[b.options.dataFields.name]):null};this.isTabEnabled=function(a){return e.isEnabled(a[b.options.dataFields.enabled])};this.isTabVisible=function(a){return a&&0!=a[b.options.dataFields.visible]?!0:!1};this.isIndexInRange=function(a){return 0<=a&&a<b.currentList.length};this.setHoverTab=function(a){(a=b.getTabByScope(a))?(b.options.hoverTab=a,b.callTabHover(a)):b.options.hoverTab=null};b.allowUpdate=!0;this.suspendLayout=function(){b.allowUpdate=!1};this.resumeLayout=function(){b.allowUpdate=!0;b.updateLayout()};c.$on(c.name+"-refresh",function(a){b.refresh()});c.$on(c.name+"-resume-layout",function(a){b.resumeLayout()});c.$on(c.name+"-suspend-layout",function(a){b.suspendLayout()});c.$on(c.name+"-update-layout",function(a){b.updateLayout()});this.selectionCancelled=!1;c.$on(c.name+"-get-selected-tab",function(a){n.setTempData(b.tabSelection())});c.$on(c.name+"-set-selected-tab",function(a,c){b.tabSelection(c)});c.$on(c.name+"-clear-selection",function(a){b.options.selectedTab&&(b.options.selectedTab[b.options.dataFields.selected]=!1);b.options.selectedTab=null});this.tabSelection=function(a,d){if(a){if(b.isTabEnabled(a)){var l=b.tabSelection(),m=!0;l&&(m=!e.isEqual(l[b.options.dataFields.id],a[b.options.dataFields.id]));m&&(l=!0,l=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({tab:a}):c.beforeSelect({e:{tab:a}}),b.selectionCancelled=0==l,0!=l&&(b.options.selectedTab&&(b.options.selectedTab.selected=!1,b.updateTab(b.options.selectedTab)),b.options.selectedTab=a,a[b.options.dataFields.selected]=!0,b.callAfterSelect(a),b.updateLayout()))}}else return b.options.selectedTab};this.selectTab=function(a){(a=b.getTabByScope(a))&&b.tabSelection(a)};var d=function(a){if(a){var c=e.isFieldAvailable(a.general,"iui-tabstrip-navigation");a=a.button;a=e.isString(a)?a:a?{disabled:e.isFieldAvailable(a.disabled,"iui-tabstrip-navigation-button-disabled"),normal:e.isFieldAvailable(a.normal,"iui-tabstrip-navigation-button"),hovered:e.isFieldAvailable(a.hovered,"iui-tabstrip-navigation-button-hovered"),selected:e.isFieldAvailable(a.selected,"iui-tabstrip-navigation-button-selected")}:b.options.controlStyle.navigation.button;return{general:c,button:a}}return b.options.controlStyle.navigation},y=function(a){if(a){var c=e.isFieldAvailable(a.general,"iui-tab"),d;d=a.header;d=e.isString(d)?d:d?{content:e.isFieldAvailable(d.content,"iui-tab-header-content"),disabled:e.isFieldAvailable(d.disabled,"iui-tab-header-disabled"),focused:e.isFieldAvailable(d.focused,"iui-tab-header-focused"),normal:e.isFieldAvailable(d.normal,"iui-tab-header"),hovered:e.isFieldAvailable(d.hovered,"iui-tab-header-hovered"),selected:e.isFieldAvailable(d.selected,"iui-tab-header-selected")}:b.options.controlStyle.tab.header;a=a.content;a=e.isString(a)?a:a?{disabled:e.isFieldAvailable(a.disabled,"iui-tab-content-disabled"),focused:e.isFieldAvailable(a.focused,"iui-tab-content-focused"),normal:e.isFieldAvailable(a.normal,"iui-tab-content"),hovered:e.isFieldAvailable(a.hovered,"iui-tab-content-hovered"),selected:e.isFieldAvailable(a.selected,"iui-tab-content-selected")}:b.options.controlStyle.tab.content;return{general:c,header:d,content:a}}return b.options.controlStyle.tab};this.updateControlStyle=function(a){b.options.controlStyle=a?{general:e.isFieldAvailable(a.general,"iui-tabstrip"),navigation:d(a.navigation),tab:y(a.tab)}:{general:e.isFieldAvailable(b.defaultStyle.general,"iui-tabstrip"),navigation:d(b.defaultStyle.navigation),tab:y(b.defaultStyle.tab)}};this.getCurrentNavigationStyle=function(){return b.options.controlStyle.navigation};this.getCurrentNavButtonStyle=function(a,c){if(!a)return"";switch(c){case "disabled":return a&&a.disabled?a.disabled:b.options.controlStyle.navigation.button.disabled;case "hovered":return a&&a.hovered?a.hovered:b.options.controlStyle.navigation.button.hovered;case "selected":return a&&a.selected?a.selected:b.options.controlStyle.navigation.button.selected;default:return a&&a.normal?a.normal:b.options.controlStyle.navigation.button.normal}};this.getCurrentTabStyle=function(a){var c=b.options.controlStyle.tab;if(a)switch(a.style){case "initial":break;default:null!=a.style&&(c=a.style)}return c?c:b.options.controlStyle.tab};this.getCurrentTabHeaderStyle=function(a,c){if(!a||!a.header)return"";switch(c){case "content":return a.header.content?a.header.content:b.options.controlStyle.tab.header.content;case "disabled":return a.header.disabled?a.header.disabled:b.options.controlStyle.tab.header.disabled;case "focused":return a.header.focused?a.header.focused:b.options.controlStyle.tab.header.focused;case "hovered":return a.header.hovered?a.header.hovered:b.options.controlStyle.tab.header.hovered;case "selected":return a.header.selected?a.header.selected:b.options.controlStyle.tab.header.selected;default:return a.header.normal?a.header.normal:b.options.controlStyle.tab.header.normal}};this.getCurrentTabContentStyle=function(a,c){if(!a||!a.content)return"";switch(c){case "disabled":return a.content.disabled?a.content.disabled:b.options.controlStyle.tab.content.disabled;case "focused":return a.content.focused?a.content.focused:b.options.controlStyle.tab.content.focused;case "hovered":return a.content.hovered?a.content.hovered:b.options.controlStyle.tab.content.hovered;case "selected":return a.content.selected?a.content.selected:b.options.controlStyle.tab.content.selected;default:return a.content.normal?a.content.normal:b.options.controlStyle.tab.content.normal}};b.updateTab=function(a){(a=b.getScopeByTab(a))&&a.refresh()};c.$watch("controlStyle",function(a,c){a!==c&&(b.options.controlStyle=a,b.refresh(),b.callStyleChanged(a))});c.$watch("enabled",function(a,c){a!==c&&(b.options.enabled=a,b.refresh(),b.callEnabledChanged(a))});c.$watch("fields",function(a,c){a!==c&&(b.options.dataFields=a,b.UpdateData())});c.$watch("tabIcon",function(a,c){a!==c&&(b.options.tabIcon=a,b.updateLayout())});c.$watch("hoverSelection",function(a,c){a!==c&&(b.options.hoverSelection=a)});c.$watch("options",function(a,c){a!==c&&(b.updateOptions(a),b.updateLayout())},!0);c.$watch("rtl",function(a,c){a!==c&&(b.options.rtl=a,b.updateLayout())});c.$watch("selectedTab",function(a,c){a!==c&&(c&&(c.selected=!1),b.options.selectedTab=a,b.callAfterSelect(a))});c.$watch("showCloseButton",function(a,c){a!==c&&(b.options.showCloseButton=a,b.updateLayout())});c.$watch("showIcons",function(a,c){a!==c&&(b.options.showIcons=a,b.updateLayout())});c.$watch("tabstripPlacement",function(a,c){a!==c&&(b.options.tabstripPlacement=a,b.updateLayout())})}]).directive("iuiTabstrip",["$timeout","$interval","IntegralUIInternalService",function(c,q,e){return{restrict:"EA",controller:"IntegralUITabStripController",transclude:!0,replace:!0,template:'<div class="iui-tabstrip" data-element="tabstrip"><ul ng-transclude></ul><div class="iui-tab-content" ng-repeat="tab in tabScopeList" iui-content-transclude="tab" data-name="{{tab.name}}"></div></div>',scope:{controlStyle:"=",enabled:"=",fields:"=",hoverSelection:"=",name:"@",options:"=?",rtl:"=",selectedTab:"=",showCloseButton:"=",showIcons:"=",tabIcon:"=",tabs:"=",tabstripPlacement:"@",afterSelect:"&",beforeSelect:"&",buttonClicked:"&",buttonClicking:"&",clear:"&",enabledChanged:"&",events:"=?",tabAdded:"&",tabAdding:"&",tabClick:"&",tabDblclick:"&",tabHover:"&",tabRemoved:"&",tabRemoving:"&",tabRightclick:"&",selectionChanged:"&",styleChanged:"&"},link:function(f,n,b,d,y){var a=this,r=angular.element(n.children().eq(0)),l=angular.element("<div></div>"),m=angular.element("<div><span></span></div>"),k=angular.element("<div><span></span></div>"),p=angular.element("<div><span></span></div>");f.$on("$destroy",function(b){a.s2t();D()});var D=function(){m.unbind("click mousedown mouseup");k.unbind("click mousedown mouseup");p.unbind("mousedown mouseup")},F=function(){m.bind("click",function(a){a.stopPropagation()});m.bind("mousedown",function(a){E(!1);a.stopPropagation()});m.bind("mouseup",function(a){A&&q.cancel(A);a.stopPropagation()});k.bind("click",function(a){a.stopPropagation()});k.bind("mousedown",function(a){E(!0);a.stopPropagation()});k.bind("mouseup",function(a){A&&q.cancel(A);a.stopPropagation()});p.bind("mousedown",function(a){d.options.selectedTab&&d.dataObj.removeAt(d.options.selectedTab,-1,null,d.tabIsRemoved);a.stopPropagation()})},u=0,w=0,C=function(a){for(var b=null,c=n.children(),d=1;d<c.length;d++){var e=angular.element(c.eq(d));if(e&&e[0].attributes&&e[0].attributes["data-name"]&&e[0].attributes["data-name"].value==a){b=e;break}}return b};d.updateLayout=function(){if(d.allowUpdate){D();w=u=0;d.maxScrollPos=0;d.updateCurrentList();d.updateCurrentScopeList();!d.options.selectedTab&&0<d.currentList.length&&(d.options.selectedTab=d.currentList[0]);var a=c(function(){if(d.options.rtl){var b=r.children();if(b&&0<b.length){var f=0,h=0,v=null,x=null,g=null,t=e.getPadding(r[0]);r.css("top","auto");r.css("right","auto");r.css("bottom","auto");r.css("left","auto");switch(d.options.tabstripPlacement){case "right":r.css("bottom",0);r.css("right",0);break;case "left":r.css("bottom",0);r.css("left",0);break;case "bottom":r.css("right",0);r.css("bottom",0);break;default:r.css("top",0),r.css("right",0)}for(var q=0;q<b.length;q++)switch(g=angular.element(b.eq(q)),g[0].attributes&&g[0].attributes.name&&((v=d.findTabByName(g[0].attributes.name.value))&&0!=v[d.options.dataFields.visible]?g.css("display","inline-block"):g.css("display","none")),g.css("top","auto"),g.css("right","auto"),g.css("bottom","auto"),g.css("left","auto"),d.options.tabstripPlacement){case "left":g.css("bottom",h+"px");h+=g[0].offsetHeight;u<g[0].offsetWidth&&(u=g[0].offsetWidth);break;case "right":g.css("bottom",h+"px");g.css("right",0);h+=g[0].offsetHeight;u<g[0].offsetWidth&&(u=g[0].offsetWidth);break;default:g.css("right",f+"px"),f+=g[0].offsetWidth,w<g[0].offsetHeight&&(w=g[0].offsetHeight)}for(q=0;q<b.length;q++){g=angular.element(b.eq(q));v=e.getBorderWidth(g[0]);x=e.getPadding(g[0]);switch(d.options.tabstripPlacement){case "left":g.css("left",t.left+"px");g.css("width",u-(v.left+v.right)-(x.left+x.right)+"px");w=h;break;case "right":g.css("right",t.right+"px");g.css("width",u-(v.left+v.right)-(x.left+x.right)+"px");w=h;break;case "bottom":g.css("bottom",t.bottom+"px");g.css("height",w-(v.top+v.bottom)-(x.top+x.bottom)+"px");u=f;break;default:g.css("top",t.top+"px"),g.css("height",w-(v.top+v.bottom)-(x.top+x.bottom)+"px"),u=f}g.css("opacity",1)}}f=d.getCurrentNavigationStyle();l.removeAttr("class");l.addClass(d.options.controlStyle.navigation.general);n.append(l);b=e.getPadding(l[0]);l.empty();p.removeAttr("class");if(d.options.showCloseButton)switch(p.addClass(d.defaultStyle.navigation.button.normal),h=d.getCurrentNavButtonStyle(f),h!=d.options.controlStyle.navigation.button.normal&&p.addClass(h),p.addClass("iui-tabstrip-navigation-button-close"),l.append(p),p.css("top","auto"),p.css("right","auto"),p.css("bottom","auto"),p.css("left","auto"),d.options.tabstripPlacement){case "left":p.css("top",b.top+"px");p.css("right",b.right+"px");break;case "right":p.css("top",b.top+"px");p.css("left",b.left+"px");break;case "bottom":p.css("top",b.top+"px");p.css("left",b.left+"px");break;default:p.css("bottom",b.bottom+"px"),p.css("left",b.left+"px")}m.removeAttr("class");m.addClass(d.defaultStyle.navigation.button.normal);h=d.getCurrentNavButtonStyle(f);h!=d.options.controlStyle.navigation.button.normal&&m.addClass(h);"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?m.addClass("iui-tabstrip-navigation-button-up"):m.addClass("iui-tabstrip-navigation-button-left");l.append(m);m.css("top","auto");m.css("right","auto");m.css("bottom","auto");m.css("left","auto");switch(d.options.tabstripPlacement){case "left":m.css("top",b.top+p[0].offsetHeight+"px");m.css("right",b.right+"px");break;case "right":m.css("top",b.top+p[0].offsetHeight+"px");m.css("left",b.left+"px");break;case "bottom":m.css("top",b.top+"px");m.css("left",b.left+p[0].offsetWidth+"px");break;default:m.css("bottom",b.bottom+"px"),m.css("left",b.left+p[0].offsetWidth+"px")}k.removeAttr("class");k.addClass(d.defaultStyle.navigation.button.normal);h=d.getCurrentNavButtonStyle(f);h!=d.options.controlStyle.navigation.button.normal&&k.addClass(h);"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?k.addClass("iui-tabstrip-navigation-button-down"):k.addClass("iui-tabstrip-navigation-button-right");l.append(k);k.css("top","auto");k.css("right","auto");k.css("bottom","auto");k.css("left","auto");switch(d.options.tabstripPlacement){case "left":k.css("top",b.top+p[0].offsetHeight+m[0].offsetHeight+"px");k.css("right",b.right+"px");break;case "right":k.css("top",b.top+p[0].offsetHeight+m[0].offsetHeight+"px");k.css("left",b.left+"px");break;case "bottom":k.css("top",b.top+"px");k.css("left",b.left+p[0].offsetWidth+m[0].offsetWidth+"px");break;default:k.css("bottom",b.bottom+"px"),k.css("left",b.left+p[0].offsetWidth+m[0].offsetWidth+"px")}h=f=0;"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?(f=u-(b.left+b.right)-1,h+=m[0].offsetHeight,h+=k[0].offsetHeight,h+=p[0].offsetHeight):(f+=m[0].offsetWidth,f+=k[0].offsetWidth,f+=p[0].offsetWidth,h=w-(b.top+b.bottom)-1);l.css("top","auto");l.css("right","auto");l.css("bottom","auto");l.css("left","auto");switch(d.options.tabstripPlacement){case "left":l.css("top",0);l.css("left",0);break;case "right":l.css("top",0);l.css("right",0);break;case "bottom":l.css("bottom",0);l.css("left",0);break;default:l.css("top",0),l.css("left",0)}}else{if((b=r.children())&&0<b.length){h=f=0;g=x=v=null;t=e.getPadding(r[0]);r.css("top","auto");r.css("right","auto");r.css("bottom","auto");r.css("left","auto");switch(d.options.tabstripPlacement){case "right":r.css("top",0);r.css("right",0);break;case "left":r.css("top",0);r.css("left",0);break;case "bottom":r.css("left",0);r.css("bottom",0);break;default:r.css("top",0),r.css("left",0)}for(q=0;q<b.length;q++)switch(g=angular.element(b.eq(q)),g[0].attributes&&g[0].attributes.name&&((v=d.findTabByName(g[0].attributes.name.value))&&0!=v[d.options.dataFields.visible]?g.css("display","inline-block"):g.css("display","none")),g.css("top","auto"),g.css("right","auto"),g.css("bottom","auto"),g.css("left","auto"),d.options.tabstripPlacement){case "left":g.css("top",f+"px");f+=g[0].offsetHeight;u<g[0].offsetWidth&&(u=g[0].offsetWidth);break;case "right":g.css("top",f+"px");g.css("right",0);f+=g[0].offsetHeight;u<g[0].offsetWidth&&(u=g[0].offsetWidth);break;default:g.css("left",h+"px"),h+=g[0].offsetWidth,w<g[0].offsetHeight&&(w=g[0].offsetHeight)}for(q=0;q<b.length;q++){g=angular.element(b.eq(q));v=e.getBorderWidth(g[0]);x=e.getPadding(g[0]);switch(d.options.tabstripPlacement){case "left":g.css("left",t.left+"px");g.css("width",u-(v.left+v.right)-(x.left+x.right)+"px");w=f;break;case "right":g.css("right",t.right+"px");g.css("width",u-(v.left+v.right)-(x.left+x.right)+"px");w=f;break;case "bottom":g.css("bottom",t.bottom+"px");g.css("height",w-(v.top+v.bottom)-(x.top+x.bottom)+"px");u=h;break;default:g.css("top",t.top+"px"),g.css("height",w-(v.top+v.bottom)-(x.top+x.bottom)+"px"),u=h}g.css("opacity",1)}}f=d.getCurrentNavigationStyle();l.removeAttr("class");l.addClass(d.options.controlStyle.navigation.general);n.append(l);b=e.getPadding(l[0]);l.empty();m.removeAttr("class");m.addClass(d.defaultStyle.navigation.button.normal);h=d.getCurrentNavButtonStyle(f);h!=d.options.controlStyle.navigation.button.normal&&m.addClass(h);"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?m.addClass("iui-tabstrip-navigation-button-up"):m.addClass("iui-tabstrip-navigation-button-left");l.append(m);m.css("top","auto");m.css("right","auto");m.css("bottom","auto");m.css("left","auto");switch(d.options.tabstripPlacement){case "left":m.css("top",b.top+"px");m.css("right",b.right+"px");break;case "right":m.css("top",b.top+"px");m.css("left",b.left+"px");break;case "bottom":m.css("top",b.top+"px");m.css("left",b.left+"px");break;default:m.css("bottom",b.bottom+"px"),m.css("left",b.left+"px")}k.removeAttr("class");k.addClass(d.defaultStyle.navigation.button.normal);h=d.getCurrentNavButtonStyle(f);h!=d.options.controlStyle.navigation.button.normal&&k.addClass(h);"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?k.addClass("iui-tabstrip-navigation-button-down"):k.addClass("iui-tabstrip-navigation-button-right");l.append(k);k.css("top","auto");k.css("right","auto");k.css("bottom","auto");k.css("left","auto");switch(d.options.tabstripPlacement){case "left":k.css("top",b.top+m[0].offsetHeight+"px");k.css("right",b.right+"px");break;case "right":k.css("top",b.top+m[0].offsetHeight+"px");k.css("left",b.left+"px");break;case "bottom":k.css("top",b.top+"px");k.css("left",b.left+m[0].offsetWidth+"px");break;default:k.css("bottom",b.bottom+"px"),k.css("left",b.left+m[0].offsetWidth+"px")}p.removeAttr("class");if(d.options.showCloseButton)switch(p.addClass(d.defaultStyle.navigation.button.normal),h=d.getCurrentNavButtonStyle(f),h!=d.options.controlStyle.navigation.button.normal&&p.addClass(h),p.addClass("iui-tabstrip-navigation-button-close"),l.append(p),p.css("top","auto"),p.css("right","auto"),p.css("bottom","auto"),p.css("left","auto"),d.options.tabstripPlacement){case "left":p.css("top",b.top+m[0].offsetHeight+k[0].offsetHeight+"px");p.css("right",b.right+"px");break;case "right":p.css("top",b.top+m[0].offsetHeight+k[0].offsetHeight+"px");p.css("left",b.left+"px");break;case "bottom":p.css("top",b.top+"px");p.css("left",b.left+m[0].offsetWidth+k[0].offsetWidth+"px");break;default:p.css("bottom",b.bottom+"px"),p.css("left",b.left+m[0].offsetWidth+k[0].offsetWidth+"px")}h=f=0;"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?(f=u-(b.left+b.right)-1,h+=m[0].offsetHeight,h+=k[0].offsetHeight,h+=p[0].offsetHeight):(f+=m[0].offsetWidth,f+=k[0].offsetWidth,f+=p[0].offsetWidth,h=w-(b.top+b.bottom)-1);l.css("top","auto");l.css("right","auto");l.css("bottom","auto");l.css("left","auto");switch(d.options.tabstripPlacement){case "left":l.css("bottom",0);l.css("left",0);break;case "right":l.css("bottom",0);l.css("right",0);break;case "bottom":l.css("bottom",0);l.css("right",0);break;default:l.css("top",0),l.css("right",0)}}l.css("width",f+"px");l.css("height",h+"px");b=d.getTabCurrentIndex(d.options.selectedTab);n.children();h=null;for(f=0;f<d.currentScopeList.length;f++)if(h=d.currentScopeList[f],h.refresh(),h=C(h.name)){g=e.getBorderWidth(h[0]);t=e.getPadding(h[0]);h.css("top","auto");h.css("right","auto");h.css("bottom","auto");h.css("left","auto");switch(d.options.tabstripPlacement){case "left":h.css("left",u-1+"px");h.css("width",n[0].clientWidth-u-(t.left+t.right)-1+"px");h.css("height",n[0].clientHeight-(g.top+g.bottom)-(t.top+t.bottom)+"px");break;case "right":h.css("right",u-1+"px");h.css("width",n[0].clientWidth-u-(t.left+t.right)-1+"px");h.css("height",n[0].clientHeight-(g.top+g.bottom)-(t.top+t.bottom)+"px");break;case "bottom":h.css("width",n[0].clientWidth-(g.left+g.right)-(t.left+t.right)+"px");h.css("height",n[0].clientHeight-w-(t.top+t.bottom)-1+"px");break;default:h.css("top",w-1+"px"),h.css("width",n[0].clientWidth-(g.left+g.right)-(t.left+t.right)+"px"),h.css("height",n[0].clientHeight-w-(t.top+t.bottom)-1+"px")}f==b?h.css("display","block"):h.css("display","none")}for(f=0;f<d.tabScopeList.length;f++)h=d.tabScopeList[f],0>d.getTabScopeIndex(h)&&(h=C(h.name))&&h.css("display","none");d.maxScrollPos=0;"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?w>n[0].clientHeight?(d.maxScrollPos=w-(n[0].clientHeight-l[0].offsetHeight),d.options.rtl&&d.maxScrollPos++):(l.remove(),d.scrollPos=0):u>n[0].clientWidth?(d.maxScrollPos=u-(n[0].clientWidth-l[0].offsetWidth),d.options.rtl&&d.maxScrollPos++):(l.remove(),d.scrollPos=0);d.scrollTabs();d.refresh();F();c.cancel(a)},1)}};var z=0,A=null,B=!1;d.scrollPos=0;d.maxScrollPos=0;var E=function(a){A&&q.cancel(A);z=0;A=q(function(){var b=a;d.options.rtl&&(b=!b);0==z&&(z=1);z+=5;B=!1;b?d.scrollPos+z<d.maxScrollPos?d.scrollPos+=z:(B=!0,d.scrollPos=d.maxScrollPos):0<d.scrollPos-z?d.scrollPos-=z:(B=!0,d.scrollPos=0);d.scrollTabs();B&&q.cancel(A)},100)};d.scrollTabs=function(){var a=r.children();if(a&&0<a.length)for(var b=-d.scrollPos,c=-d.scrollPos,e=-d.scrollPos,f=-d.scrollPos,l=null,g=0;g<a.length;g++)l=angular.element(a.eq(g)),d.options.rtl?"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?(l.css("bottom",e+"px"),e+=l[0].offsetHeight):(l.css("right",c+"px"),c+=l[0].offsetWidth):"left"==d.options.tabstripPlacement||"right"==d.options.tabstripPlacement?(l.css("top",b+"px"),b+=l[0].offsetHeight):(l.css("left",f+"px"),f+=l[0].offsetWidth)};d.refresh=function(){for(var a=null,b=null,c=0;c<d.currentScopeList.length;c++)if(a=d.currentScopeList[c],a.refresh(),b=C(a.name)){var e=d.getTabByScope(a);if(e){var a=d.getTabState(e),f=d.getCurrentTabStyle(e),e=d.defaultStyle.tab.content.normal,a=d.getCurrentTabContentStyle(f,a);a!=d.options.controlStyle.tab.content.normal&&(e+=" "+a);b.removeAttr("class");b.addClass(e)}}(a=d.getScopeByTab(d.options.selectedTab))&&a.select()};a=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){var b;b="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";b+=a[1]+a[4]+a[2]+a[0]+a[3];return b+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(a.tpar));this.tmp=300;this.twp=200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",n[0].scrollTop+"px"),this.$tw.css("left",n[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",n[0].scrollTop+"px"),this.$tw.css("left",n[0].scrollLeft+"px"))};this.s1t=function(b){this.trlTime=c(function(){a.trActive||(a.trCount=0,a.trActive=!0,a.trId=q(function(){a.animTr()},1E3))},b)};this.s2t=function(){this.trId&&(q.cancel(this.trId),this.trId=null);this.trlTime&&(c.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};n.append(this.$tw);this.s1t(this.twp);angular.isDefined(f.options)?d.updateOptions(f.options):(angular.isDefined(f.controlStyle)&&d.updateControlStyle(f.controlStyle),0==f.enabled&&(d.options.enabled=f.enabled),angular.isDefined(f.fields)&&d.updateDataFields(f.fields),angular.isDefined(f.tabstripPlacement)&&(d.options.tabstripPlacement=f.tabstripPlacement),1==f.hoverSelection&&(d.options.hoverSelection=f.hoverSelection),angular.isDefined(f.tabIcon)&&(d.options.tabIcon=f.tabIcon),1==f.rtl&&(d.options.rtl=f.rtl),angular.isDefined(f.selectedTab)&&(d.options.selectedTab=f.selectedTab),0==f.showCloseButton&&(d.options.showCloseButton=f.showCloseButton),0==f.showIcons&&(d.options.showIcons=f.showIcons));c(function(){d.updateLayout()},1)}}}]).controller("IntegralUITabController",["$scope","$element","IntegralUIInternalService",function(c,q,e){var f=this;this.heading=c.heading;this.setHeading=function(c){this.heading=c};c.$on(c.name+"-get-ctrl",function(c){e.setTempData(f)})}]).directive("iuiTab",["$timeout","IntegralUIInternalService",function(c,q){return{require:"^iuiTabstrip",restrict:"EA",controller:"IntegralUITabController",transclude:!0,replace:!0,template:'<li class="iui-tab-header" data-element="tab-header"><div iui-tab-header-transclude="heading">{{heading}}</div></li>',scope:{expanded:"=",name:"@",heading:"@"},link:function(e,f,n,b,d){var y=angular.element(f.children().eq(0));e.$on("$destroy",function(a){y&&y.unbind("click dblclick mouseenter mouseleave mousedown mouseup touchstart");b.removeTabScope(e)});(function(){y.bind("click",function(a){var c=b.getTabByScope(e);c&&"disabled"!=b.getTabState(c)&&b.callTabClick(c,q.getMousePos(a));a.stopPropagation()});y.bind("dblclick",function(a){var c=b.getTabByScope(e);c&&"disabled"!=b.getTabState(c)&&b.callTabDblClick(c,q.getMousePos(a));a.stopPropagation()});y.bind("mouseenter",function(d){var f=b.getTabByScope(e);f&&"disabled"!=b.getTabState(f)&&(b.setHoverTab(e),e.refresh(),b.options.hoverSelection&&(a=c(function(){a&&b.selectTab(e)},500)));d.stopPropagation()});y.bind("mouseleave",function(d){var f=b.getTabByScope(e);f&&"disabled"!=b.getTabState(f)&&(b.setHoverTab(),a&&(c.cancel(a),a=null),e.refresh());d.stopPropagation()});y.bind("mousedown",function(a){var c=b.getTabByScope(e);if(c&&"disabled"!=b.getTabState(c))switch(a.which){case 1:b.selectTab(e);break;case 3:b.callTabRightClick(c,q.getMousePos(a))}a.stopPropagation()});y.bind("touchstart",function(a){a.preventDefault();var c=q.getTouchData(a);c&&0<c.length&&((c=b.getTabByScope(e))&&"disabled"!=b.getTabState(c)&&b.selectTab(e),a.stopPropagation())})})();e.open=function(){};e.close=function(){};var a=null;e.select=function(){e.refresh()};e.refresh=function(){var a=b.getTabByScope(e);if(a){var c=b.getTabState(a),d=b.getCurrentTabStyle(a),k=b.defaultStyle.tab.header.normal,c=b.getCurrentTabHeaderStyle(d,c);c!=b.options.controlStyle.tab.header.normal&&(k+=" "+c);f.removeAttr("class");f.addClass(k);k="iui-tab-header";switch(b.options.tabstripPlacement){case "left":k+="-left";break;case "right":k+="-right";break;case "bottom":k+="-bottom";break;default:k+="-top"}f.addClass(k);k="iui-tab-header-selected";if(a==b.options.selectedTab){switch(b.options.tabstripPlacement){case "left":k+="-left";break;case "right":k+="-right";break;case "bottom":k+="-bottom";break;default:k+="-top"}f.addClass(k)}}};e.$transcludeFn=d;b.addTabScope(e)}}}]).directive("iuiTabHeaderTransclude",function(){return{restrict:"A",require:"^iuiTab",link:function(c,q,e,f){c.$watch("headerElem",function(c){c&&(q.empty(),q.append(c))})}}}).directive("iuiContentTransclude",function(){return{restrict:"A",require:"^iuiTabstrip",link:function(c,q,e){var f=c.$eval(e.iuiContentTransclude);f.$transcludeFn(f.$parent,function(c){angular.forEach(c,function(b){b.tagName&&(b.hasAttribute("iui-tab-header")||"iui-tab-header"===b.tagName.toLowerCase())?f.headerElem=b:q.append(b)})})}}});